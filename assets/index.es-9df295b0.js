import{aq as Ro,ar as te,a9 as Ao,as as qm,at as ff,au as pf,av as Hc,aw as Co,ax as Lm,ay as qr,az as Ei,aA as Mm,aB as zm,aC as G,aD as Um,aE as Pc,aF as Hm,aG as Bm,aH as km,aI as Xh,aJ as Km,aK as Vm,aL as Gm,aM as el,aN as Wm,aO as Jm,aP as Qm,aQ as Xn,aR as tl,aS as Ym,aT as Zm,aU as df,aV as jr,aW as Xm,aX as rl,aY as vn,aZ as At,a_ as Kt,a$ as bi,b0 as ar,b1 as e1,b2 as mn,b3 as gf,b4 as t1,b5 as r1,b6 as i1,b7 as yf,b8 as n1,b9 as vf,ba as mf,bb as _n,bc as Sc,bd as bo,be as bn,bf as s1,bg as Eo,bh as o1,bi as a1,bj as c1,bk as u1,bl as po,bm as h1,bn as l1,bo as uc,bp as il,bq as f1,br as p1,bs as d1,bt as nl,bu as g1,bv as y1,bw as v1,bx as m1,by as w1,bz as _1,bA as b1,bB as Jn,bC as wf,bD as hc,bE as E1,bF as I1,ad as x1}from"./index-3fabf754.js";import{e as yr,$ as Bc}from"./events-64b3597d.js";const P1=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,S1=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,O1=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function R1(a,t){if(a==="__proto__"||a==="constructor"&&t&&typeof t=="object"&&"prototype"in t){A1(a);return}return t}function A1(a){console.warn(`[destr] Dropping "${a}" key to prevent prototype pollution.`)}function go(a,t={}){if(typeof a!="string")return a;const r=a.trim();if(a[0]==='"'&&a.endsWith('"')&&!a.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!O1.test(a)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return a}try{if(P1.test(a)||S1.test(a)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(a,R1)}return JSON.parse(a)}catch(n){if(t.strict)throw n;return a}}function C1(a){return!a||typeof a.then!="function"?Promise.resolve(a):a}function jt(a,...t){try{return C1(a(...t))}catch(r){return Promise.reject(r)}}function T1(a){const t=typeof a;return a===null||t!=="object"&&t!=="function"}function $1(a){const t=Object.getPrototypeOf(a);return!t||t.isPrototypeOf(Object)}function Io(a){if(T1(a))return String(a);if($1(a)||Array.isArray(a))return JSON.stringify(a);if(typeof a.toJSON=="function")return Io(a.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function _f(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Oc="base64:";function N1(a){if(typeof a=="string")return a;_f();const t=Buffer.from(a).toString("base64");return Oc+t}function D1(a){return typeof a!="string"||!a.startsWith(Oc)?a:(_f(),Buffer.from(a.slice(Oc.length),"base64"))}function or(a){return a?a.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function F1(...a){return or(a.join(":"))}function yo(a){return a=or(a),a?a+":":""}const j1="memory",q1=()=>{const a=new Map;return{name:j1,options:{},hasItem(t){return a.has(t)},getItem(t){return a.get(t)??null},getItemRaw(t){return a.get(t)??null},setItem(t,r){a.set(t,r)},setItemRaw(t,r){a.set(t,r)},removeItem(t){a.delete(t)},getKeys(){return Array.from(a.keys())},clear(){a.clear()},dispose(){a.clear()}}};function L1(a={}){const t={mounts:{"":a.driver||q1()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=p=>{for(const b of t.mountpoints)if(p.startsWith(b))return{base:b,relativeKey:p.slice(b.length),driver:t.mounts[b]};return{base:"",relativeKey:p,driver:t.mounts[""]}},n=(p,b)=>t.mountpoints.filter(x=>x.startsWith(p)||b&&p.startsWith(x)).map(x=>({relativeBase:p.length>x.length?p.slice(x.length):void 0,mountpoint:x,driver:t.mounts[x]})),o=(p,b)=>{if(t.watching){b=or(b);for(const x of t.watchListeners)x(p,b)}},c=async()=>{if(!t.watching){t.watching=!0;for(const p in t.mounts)t.unwatch[p]=await sl(t.mounts[p],o,p)}},f=async()=>{if(t.watching){for(const p in t.unwatch)await t.unwatch[p]();t.unwatch={},t.watching=!1}},g=(p,b,x)=>{const A=new Map,D=C=>{let J=A.get(C.base);return J||(J={driver:C.driver,base:C.base,items:[]},A.set(C.base,J)),J};for(const C of p){const J=typeof C=="string",re=or(J?C:C.key),oe=J?void 0:C.value,ce=J||!C.options?b:{...b,...C.options},ae=r(re);D(ae).items.push({key:re,value:oe,relativeKey:ae.relativeKey,options:ce})}return Promise.all([...A.values()].map(C=>x(C))).then(C=>C.flat())},m={hasItem(p,b={}){p=or(p);const{relativeKey:x,driver:A}=r(p);return jt(A.hasItem,x,b)},getItem(p,b={}){p=or(p);const{relativeKey:x,driver:A}=r(p);return jt(A.getItem,x,b).then(D=>go(D))},getItems(p,b){return g(p,b,x=>x.driver.getItems?jt(x.driver.getItems,x.items.map(A=>({key:A.relativeKey,options:A.options})),b).then(A=>A.map(D=>({key:F1(x.base,D.key),value:go(D.value)}))):Promise.all(x.items.map(A=>jt(x.driver.getItem,A.relativeKey,A.options).then(D=>({key:A.key,value:go(D)})))))},getItemRaw(p,b={}){p=or(p);const{relativeKey:x,driver:A}=r(p);return A.getItemRaw?jt(A.getItemRaw,x,b):jt(A.getItem,x,b).then(D=>D1(D))},async setItem(p,b,x={}){if(b===void 0)return m.removeItem(p);p=or(p);const{relativeKey:A,driver:D}=r(p);D.setItem&&(await jt(D.setItem,A,Io(b),x),D.watch||o("update",p))},async setItems(p,b){await g(p,b,async x=>{if(x.driver.setItems)return jt(x.driver.setItems,x.items.map(A=>({key:A.relativeKey,value:Io(A.value),options:A.options})),b);x.driver.setItem&&await Promise.all(x.items.map(A=>jt(x.driver.setItem,A.relativeKey,Io(A.value),A.options)))})},async setItemRaw(p,b,x={}){if(b===void 0)return m.removeItem(p,x);p=or(p);const{relativeKey:A,driver:D}=r(p);if(D.setItemRaw)await jt(D.setItemRaw,A,b,x);else if(D.setItem)await jt(D.setItem,A,N1(b),x);else return;D.watch||o("update",p)},async removeItem(p,b={}){typeof b=="boolean"&&(b={removeMeta:b}),p=or(p);const{relativeKey:x,driver:A}=r(p);A.removeItem&&(await jt(A.removeItem,x,b),(b.removeMeta||b.removeMata)&&await jt(A.removeItem,x+"$",b),A.watch||o("remove",p))},async getMeta(p,b={}){typeof b=="boolean"&&(b={nativeOnly:b}),p=or(p);const{relativeKey:x,driver:A}=r(p),D=Object.create(null);if(A.getMeta&&Object.assign(D,await jt(A.getMeta,x,b)),!b.nativeOnly){const C=await jt(A.getItem,x+"$",b).then(J=>go(J));C&&typeof C=="object"&&(typeof C.atime=="string"&&(C.atime=new Date(C.atime)),typeof C.mtime=="string"&&(C.mtime=new Date(C.mtime)),Object.assign(D,C))}return D},setMeta(p,b,x={}){return this.setItem(p+"$",b,x)},removeMeta(p,b={}){return this.removeItem(p+"$",b)},async getKeys(p,b={}){p=yo(p);const x=n(p,!0);let A=[];const D=[];for(const C of x){const re=(await jt(C.driver.getKeys,C.relativeBase,b)).map(oe=>C.mountpoint+or(oe)).filter(oe=>!A.some(ce=>oe.startsWith(ce)));D.push(...re),A=[C.mountpoint,...A.filter(oe=>!oe.startsWith(C.mountpoint))]}return p?D.filter(C=>C.startsWith(p)&&!C.endsWith("$")):D.filter(C=>!C.endsWith("$"))},async clear(p,b={}){p=yo(p),await Promise.all(n(p,!1).map(async x=>{if(x.driver.clear)return jt(x.driver.clear,x.relativeBase,b);if(x.driver.removeItem){const A=await x.driver.getKeys(x.relativeBase||"",b);return Promise.all(A.map(D=>x.driver.removeItem(D,b)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(p=>ol(p)))},async watch(p){return await c(),t.watchListeners.push(p),async()=>{t.watchListeners=t.watchListeners.filter(b=>b!==p),t.watchListeners.length===0&&await f()}},async unwatch(){t.watchListeners=[],await f()},mount(p,b){if(p=yo(p),p&&t.mounts[p])throw new Error(`already mounted at ${p}`);return p&&(t.mountpoints.push(p),t.mountpoints.sort((x,A)=>A.length-x.length)),t.mounts[p]=b,t.watching&&Promise.resolve(sl(b,o,p)).then(x=>{t.unwatch[p]=x}).catch(console.error),m},async unmount(p,b=!0){p=yo(p),!(!p||!t.mounts[p])&&(t.watching&&p in t.unwatch&&(t.unwatch[p](),delete t.unwatch[p]),b&&await ol(t.mounts[p]),t.mountpoints=t.mountpoints.filter(x=>x!==p),delete t.mounts[p])},getMount(p=""){p=or(p)+":";const b=r(p);return{driver:b.driver,base:b.base}},getMounts(p="",b={}){return p=or(p),n(p,b.parents).map(A=>({driver:A.driver,base:A.mountpoint}))}};return m}function sl(a,t,r){return a.watch?a.watch((n,o)=>t(n,r+o)):()=>{}}async function ol(a){typeof a.dispose=="function"&&await jt(a.dispose)}function Ki(a){return new Promise((t,r)=>{a.oncomplete=a.onsuccess=()=>t(a.result),a.onabort=a.onerror=()=>r(a.error)})}function bf(a,t){const r=indexedDB.open(a);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=Ki(r);return(o,c)=>n.then(f=>c(f.transaction(t,o).objectStore(t)))}let lc;function ns(){return lc||(lc=bf("keyval-store","keyval")),lc}function al(a,t=ns()){return t("readonly",r=>Ki(r.get(a)))}function M1(a,t,r=ns()){return r("readwrite",n=>(n.put(t,a),Ki(n.transaction)))}function z1(a,t=ns()){return t("readwrite",r=>(r.delete(a),Ki(r.transaction)))}function U1(a=ns()){return a("readwrite",t=>(t.clear(),Ki(t.transaction)))}function H1(a,t){return a.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Ki(a.transaction)}function B1(a=ns()){return a("readonly",t=>{if(t.getAllKeys)return Ki(t.getAllKeys());const r=[];return H1(t,n=>r.push(n.key)).then(()=>r)})}const k1=a=>JSON.stringify(a,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),K1=a=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=a.replace(t,'$1"$2n"$3');return JSON.parse(r,(n,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function ss(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return K1(a)}catch{return a}}function ki(a){return typeof a=="string"?a:k1(a)||""}const V1="idb-keyval";var G1=(a={})=>{const t=a.base&&a.base.length>0?`${a.base}:`:"",r=o=>t+o;let n;return a.dbName&&a.storeName&&(n=bf(a.dbName,a.storeName)),{name:V1,options:a,async hasItem(o){return!(typeof await al(r(o),n)>"u")},async getItem(o){return await al(r(o),n)??null},setItem(o,c){return M1(r(o),c,n)},removeItem(o){return z1(r(o),n)},getKeys(){return B1(n)},clear(){return U1(n)}}};const W1="WALLET_CONNECT_V2_INDEXED_DB",J1="keyvaluestorage";let Q1=class{constructor(){this.indexedDb=L1({driver:G1({dbName:W1,storeName:J1})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,ki(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var fc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},xo={exports:{}};(function(){let a;function t(){}a=t,a.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},a.prototype.setItem=function(r,n){this[r]=String(n)},a.prototype.removeItem=function(r){delete this[r]},a.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},a.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof fc<"u"&&fc.localStorage?xo.exports=fc.localStorage:typeof window<"u"&&window.localStorage?xo.exports=window.localStorage:xo.exports=new t})();function Y1(a){var t;return[a[0],ss((t=a[1])!=null?t:"")]}class Z1{constructor(){this.localStorage=xo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(Y1)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return ss(r)}async setItem(t,r){this.localStorage.setItem(t,ki(r))}async removeItem(t){this.localStorage.removeItem(t)}}const X1="wc_storage_version",cl=1,ew=async(a,t,r)=>{const n=X1,o=await t.getItem(n);if(o&&o>=cl){r(t);return}const c=await a.getKeys();if(!c.length){r(t);return}const f=[];for(;c.length;){const g=c.shift();if(!g)continue;const m=g.toLowerCase();if(m.includes("wc@")||m.includes("walletconnect")||m.includes("wc_")||m.includes("wallet_connect")){const p=await a.getItem(g);await t.setItem(g,p),f.push(g)}}await t.setItem(n,cl),r(t),tw(a,f)},tw=async(a,t)=>{t.length&&t.forEach(async r=>{await a.removeItem(r)})};let rw=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new Z1;this.storage=t;try{const r=new Q1;ew(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var En={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Rc=function(a,t){return Rc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])},Rc(a,t)};function iw(a,t){Rc(a,t);function r(){this.constructor=a}a.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Ac=function(){return Ac=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},Ac.apply(this,arguments)};function nw(a,t){var r={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(r[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(a);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(a,n[o])&&(r[n[o]]=a[n[o]]);return r}function sw(a,t,r,n){var o=arguments.length,c=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,t,r,n);else for(var g=a.length-1;g>=0;g--)(f=a[g])&&(c=(o<3?f(c):o>3?f(t,r,c):f(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c}function ow(a,t){return function(r,n){t(r,n,a)}}function aw(a,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,t)}function cw(a,t,r,n){function o(c){return c instanceof r?c:new r(function(f){f(c)})}return new(r||(r=Promise))(function(c,f){function g(b){try{p(n.next(b))}catch(x){f(x)}}function m(b){try{p(n.throw(b))}catch(x){f(x)}}function p(b){b.done?c(b.value):o(b.value).then(g,m)}p((n=n.apply(a,t||[])).next())})}function uw(a,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,o,c,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(p){return function(b){return m([p,b])}}function m(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,o=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){r.label=p[1];break}if(p[0]===6&&r.label<c[1]){r.label=c[1],c=p;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(p);break}c[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(a,r)}catch(b){p=[6,b],o=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function hw(a,t,r,n){n===void 0&&(n=r),a[n]=t[r]}function lw(a,t){for(var r in a)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=a[r])}function Cc(a){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&a[t],n=0;if(r)return r.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ef(a,t){var r=typeof Symbol=="function"&&a[Symbol.iterator];if(!r)return a;var n=r.call(a),o,c=[],f;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)c.push(o.value)}catch(g){f={error:g}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return c}function fw(){for(var a=[],t=0;t<arguments.length;t++)a=a.concat(Ef(arguments[t]));return a}function pw(){for(var a=0,t=0,r=arguments.length;t<r;t++)a+=arguments[t].length;for(var n=Array(a),o=0,t=0;t<r;t++)for(var c=arguments[t],f=0,g=c.length;f<g;f++,o++)n[o]=c[f];return n}function es(a){return this instanceof es?(this.v=a,this):new es(a)}function dw(a,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(a,t||[]),o,c=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(A){n[A]&&(o[A]=function(D){return new Promise(function(C,J){c.push([A,D,C,J])>1||g(A,D)})})}function g(A,D){try{m(n[A](D))}catch(C){x(c[0][3],C)}}function m(A){A.value instanceof es?Promise.resolve(A.value.v).then(p,b):x(c[0][2],A)}function p(A){g("next",A)}function b(A){g("throw",A)}function x(A,D){A(D),c.shift(),c.length&&g(c[0][0],c[0][1])}}function gw(a){var t,r;return t={},n("next"),n("throw",function(o){throw o}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(o,c){t[o]=a[o]?function(f){return(r=!r)?{value:es(a[o](f)),done:o==="return"}:c?c(f):f}:c}}function yw(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=a[Symbol.asyncIterator],r;return t?t.call(a):(a=typeof Cc=="function"?Cc(a):a[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(c){r[c]=a[c]&&function(f){return new Promise(function(g,m){f=a[c](f),o(g,m,f.done,f.value)})}}function o(c,f,g,m){Promise.resolve(m).then(function(p){c({value:p,done:g})},f)}}function vw(a,t){return Object.defineProperty?Object.defineProperty(a,"raw",{value:t}):a.raw=t,a}function mw(a){if(a&&a.__esModule)return a;var t={};if(a!=null)for(var r in a)Object.hasOwnProperty.call(a,r)&&(t[r]=a[r]);return t.default=a,t}function ww(a){return a&&a.__esModule?a:{default:a}}function _w(a,t){if(!t.has(a))throw new TypeError("attempted to get private field on non-instance");return t.get(a)}function bw(a,t,r){if(!t.has(a))throw new TypeError("attempted to set private field on non-instance");return t.set(a,r),r}const Ew=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Ac},__asyncDelegator:gw,__asyncGenerator:dw,__asyncValues:yw,__await:es,__awaiter:cw,__classPrivateFieldGet:_w,__classPrivateFieldSet:bw,__createBinding:hw,__decorate:sw,__exportStar:lw,__extends:iw,__generator:uw,__importDefault:ww,__importStar:mw,__makeTemplateObject:vw,__metadata:aw,__param:ow,__read:Ef,__rest:nw,__spread:fw,__spreadArrays:pw,__values:Cc},Symbol.toStringTag,{value:"Module"})),To=Ro(Ew);var Hn={},pc={},Bn={};class Vi{}const Iw=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Vi},Symbol.toStringTag,{value:"Module"})),xw=Ro(Iw);var ul;function Pw(){if(ul)return Bn;ul=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.IHeartBeat=void 0;const a=xw;class t extends a.IEvents{constructor(n){super()}}return Bn.IHeartBeat=t,Bn}var hl;function If(){return hl||(hl=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),To.__exportStar(Pw(),a)}(pc)),pc}var dc={},Hi={},ll;function Sw(){if(ll)return Hi;ll=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.HEARTBEAT_EVENTS=Hi.HEARTBEAT_INTERVAL=void 0;const a=te;return Hi.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,Hi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Hi}var fl;function xf(){return fl||(fl=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),To.__exportStar(Sw(),a)}(dc)),dc}var pl;function Ow(){if(pl)return Hn;pl=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.HeartBeat=void 0;const a=To,t=yr,r=te,n=If(),o=xf();class c extends n.IHeartBeat{constructor(g){super(g),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||o.HEARTBEAT_INTERVAL}static init(g){return a.__awaiter(this,void 0,void 0,function*(){const m=new c(g);return yield m.init(),m})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,m){this.events.on(g,m)}once(g,m){this.events.once(g,m)}off(g,m){this.events.off(g,m)}removeListener(g,m){this.events.removeListener(g,m)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Hn.HeartBeat=c,Hn}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=To;t.__exportStar(Ow(),a),t.__exportStar(If(),a),t.__exportStar(xf(),a)})(En);function Rw(a){try{return JSON.stringify(a)}catch{return'"[Circular]"'}}var Aw=Cw;function Cw(a,t,r){var n=r&&r.stringify||Rw,o=1;if(typeof a=="object"&&a!==null){var c=t.length+o;if(c===1)return a;var f=new Array(c);f[0]=n(a);for(var g=1;g<c;g++)f[g]=n(t[g]);return f.join(" ")}if(typeof a!="string")return a;var m=t.length;if(m===0)return a;for(var p="",b=1-o,x=-1,A=a&&a.length||0,D=0;D<A;){if(a.charCodeAt(D)===37&&D+1<A){switch(x=x>-1?x:0,a.charCodeAt(D+1)){case 100:case 102:if(b>=m||t[b]==null)break;x<D&&(p+=a.slice(x,D)),p+=Number(t[b]),x=D+2,D++;break;case 105:if(b>=m||t[b]==null)break;x<D&&(p+=a.slice(x,D)),p+=Math.floor(Number(t[b])),x=D+2,D++;break;case 79:case 111:case 106:if(b>=m||t[b]===void 0)break;x<D&&(p+=a.slice(x,D));var C=typeof t[b];if(C==="string"){p+="'"+t[b]+"'",x=D+2,D++;break}if(C==="function"){p+=t[b].name||"<anonymous>",x=D+2,D++;break}p+=n(t[b]),x=D+2,D++;break;case 115:if(b>=m)break;x<D&&(p+=a.slice(x,D)),p+=String(t[b]),x=D+2,D++;break;case 37:x<D&&(p+=a.slice(x,D)),p+="%",x=D+2,D++,b--;break}++b}++D}return x===-1?a:(x<A&&(p+=a.slice(x)),p)}const dl=Aw;var Tw=Kr;const ts=Uw().console||{},$w={mapHttpRequest:vo,mapHttpResponse:vo,wrapRequestSerializer:gc,wrapResponseSerializer:gc,wrapErrorSerializer:gc,req:vo,res:vo,err:qw};function Nw(a,t){return Array.isArray(a)?a.filter(function(n){return n!=="!stdSerializers.err"}):a===!0?Object.keys(t):!1}function Kr(a){a=a||{},a.browser=a.browser||{};const t=a.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const r=a.browser.write||ts;a.browser.write&&(a.browser.asObject=!0);const n=a.serializers||{},o=Nw(a.browser.serialize,n);let c=a.browser.serialize;Array.isArray(a.browser.serialize)&&a.browser.serialize.indexOf("!stdSerializers.err")>-1&&(c=!1);const f=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),a.enabled===!1&&(a.level="silent");const g=a.level||"info",m=Object.create(r);m.log||(m.log=rs),Object.defineProperty(m,"levelVal",{get:b}),Object.defineProperty(m,"level",{get:x,set:A});const p={transmit:t,serialize:o,asObject:a.browser.asObject,levels:f,timestamp:Lw(a)};m.levels=Kr.levels,m.level=g,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=rs,m.serializers=n,m._serialize=o,m._stdErrSerialize=c,m.child=D,t&&(m._logEvent=Tc());function b(){return this.level==="silent"?1/0:this.levels.values[this.level]}function x(){return this._level}function A(C){if(C!=="silent"&&!this.levels.values[C])throw Error("unknown level "+C);this._level=C,gn(p,m,"error","log"),gn(p,m,"fatal","error"),gn(p,m,"warn","error"),gn(p,m,"info","log"),gn(p,m,"debug","log"),gn(p,m,"trace","log")}function D(C,J){if(!C)throw new Error("missing bindings for child Pino");J=J||{},o&&C.serializers&&(J.serializers=C.serializers);const re=J.serializers;if(o&&re){var oe=Object.assign({},n,re),ce=a.browser.serialize===!0?Object.keys(oe):o;delete C.serializers,$o([C],ce,oe,this._stdErrSerialize)}function ae(ee){this._childLevel=(ee._childLevel|0)+1,this.error=yn(ee,C,"error"),this.fatal=yn(ee,C,"fatal"),this.warn=yn(ee,C,"warn"),this.info=yn(ee,C,"info"),this.debug=yn(ee,C,"debug"),this.trace=yn(ee,C,"trace"),oe&&(this.serializers=oe,this._serialize=ce),t&&(this._logEvent=Tc([].concat(ee._logEvent.bindings,C)))}return ae.prototype=this,new ae(this)}return m}Kr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Kr.stdSerializers=$w;Kr.stdTimeFunctions=Object.assign({},{nullTime:Pf,epochTime:Sf,unixTime:Mw,isoTime:zw});function gn(a,t,r,n){const o=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?rs:o[r]?o[r]:ts[r]||ts[n]||rs,Dw(a,t,r)}function Dw(a,t,r){!a.transmit&&t[r]===rs||(t[r]=function(n){return function(){const c=a.timestamp(),f=new Array(arguments.length),g=Object.getPrototypeOf&&Object.getPrototypeOf(this)===ts?ts:this;for(var m=0;m<f.length;m++)f[m]=arguments[m];if(a.serialize&&!a.asObject&&$o(f,this._serialize,this.serializers,this._stdErrSerialize),a.asObject?n.call(g,Fw(this,r,f,c)):n.apply(g,f),a.transmit){const p=a.transmit.level||t.level,b=Kr.levels.values[p],x=Kr.levels.values[r];if(x<b)return;jw(this,{ts:c,methodLevel:r,methodValue:x,transmitLevel:p,transmitValue:Kr.levels.values[a.transmit.level||t.level],send:a.transmit.send,val:t.levelVal},f)}}}(t[r]))}function Fw(a,t,r,n){a._serialize&&$o(r,a._serialize,a.serializers,a._stdErrSerialize);const o=r.slice();let c=o[0];const f={};n&&(f.time=n),f.level=Kr.levels.values[t];let g=(a._childLevel|0)+1;if(g<1&&(g=1),c!==null&&typeof c=="object"){for(;g--&&typeof o[0]=="object";)Object.assign(f,o.shift());c=o.length?dl(o.shift(),o):void 0}else typeof c=="string"&&(c=dl(o.shift(),o));return c!==void 0&&(f.msg=c),f}function $o(a,t,r,n){for(const o in a)if(n&&a[o]instanceof Error)a[o]=Kr.stdSerializers.err(a[o]);else if(typeof a[o]=="object"&&!Array.isArray(a[o]))for(const c in a[o])t&&t.indexOf(c)>-1&&c in r&&(a[o][c]=r[c](a[o][c]))}function yn(a,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var o=1;o<n.length;o++)n[o]=arguments[o-1];return a[r].apply(this,n)}}function jw(a,t,r){const n=t.send,o=t.ts,c=t.methodLevel,f=t.methodValue,g=t.val,m=a._logEvent.bindings;$o(r,a._serialize||Object.keys(a.serializers),a.serializers,a._stdErrSerialize===void 0?!0:a._stdErrSerialize),a._logEvent.ts=o,a._logEvent.messages=r.filter(function(p){return m.indexOf(p)===-1}),a._logEvent.level.label=c,a._logEvent.level.value=f,n(c,a._logEvent,g),a._logEvent=Tc(m)}function Tc(a){return{ts:0,messages:[],bindings:a||[],level:{label:"",value:0}}}function qw(a){const t={type:a.constructor.name,msg:a.message,stack:a.stack};for(const r in a)t[r]===void 0&&(t[r]=a[r]);return t}function Lw(a){return typeof a.timestamp=="function"?a.timestamp:a.timestamp===!1?Pf:Sf}function vo(){return{}}function gc(a){return a}function rs(){}function Pf(){return!1}function Sf(){return Date.now()}function Mw(){return Math.round(Date.now()/1e3)}function zw(){return new Date(Date.now()).toISOString()}function Uw(){function a(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return a(self)||a(window)||a(this)||{}}}const No=Ao(Tw),Hw={level:"info"},os="custom_context";var Bw=Object.defineProperty,kw=Object.defineProperties,Kw=Object.getOwnPropertyDescriptors,gl=Object.getOwnPropertySymbols,Vw=Object.prototype.hasOwnProperty,Gw=Object.prototype.propertyIsEnumerable,yl=(a,t,r)=>t in a?Bw(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Ww=(a,t)=>{for(var r in t||(t={}))Vw.call(t,r)&&yl(a,r,t[r]);if(gl)for(var r of gl(t))Gw.call(t,r)&&yl(a,r,t[r]);return a},Jw=(a,t)=>kw(a,Kw(t));function Do(a){return Jw(Ww({},a),{level:(a==null?void 0:a.level)||Hw.level})}function Qw(a,t=os){return a[t]||""}function Yw(a,t,r=os){return a[r]=t,a}function cr(a,t=os){let r="";return typeof a.bindings>"u"?r=Qw(a,t):r=a.bindings().context||"",r}function Zw(a,t,r=os){const n=cr(a,r);return n.trim()?`${n}/${t}`:t}function ur(a,t,r=os){const n=Zw(a,t,r),o=a.child({context:n});return Yw(o,n,r)}let Xw=class extends Vi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}},e_=class extends Vi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},t_=class{constructor(t,r){this.logger=t,this.core=r}},r_=class extends Vi{constructor(t,r){super(),this.relayer=t,this.logger=r}},i_=class extends Vi{constructor(t){super()}},n_=class{constructor(t,r,n,o){this.core=t,this.logger=r,this.name=n}},s_=class extends Vi{constructor(t,r){super(),this.relayer=t,this.logger=r}},o_=class extends Vi{constructor(t,r){super(),this.core=t,this.logger=r}},a_=class{constructor(t,r){this.projectId=t,this.logger=r}},c_=class{constructor(t,r){this.projectId=t,this.logger=r}},u_=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},h_=class{constructor(t){this.client=t}};var kc={},Of={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var t=qm,r=ff;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var n=function(){function g(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},g.prototype.update=function(m,p){if(p===void 0&&(p=m.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var b=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=m[b++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(b=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,m,b,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=m[b++],p--;return this},g.prototype.finish=function(m){if(!this._finished){var p=this._bytesHashed,b=this._bufferLength,x=p/536870912|0,A=p<<3,D=p%128<112?128:256;this._buffer[b]=128;for(var C=b+1;C<D-8;C++)this._buffer[C]=0;t.writeUint32BE(x,this._buffer,D-8),t.writeUint32BE(A,this._buffer,D-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,D),this._finished=!0}for(var C=0;C<this.digestLength/8;C++)t.writeUint32BE(this._stateHi[C],m,C*8),t.writeUint32BE(this._stateLo[C],m,C*8+4);return this},g.prototype.digest=function(){var m=new Uint8Array(this.digestLength);return this.finish(m),m},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(m){return this._stateHi.set(m.stateHi),this._stateLo.set(m.stateLo),this._bufferLength=m.bufferLength,m.buffer&&this._buffer.set(m.buffer),this._bytesHashed=m.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(m){r.wipe(m.stateHi),r.wipe(m.stateLo),m.buffer&&r.wipe(m.buffer),m.bufferLength=0,m.bytesHashed=0},g}();a.SHA512=n;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(g,m,p,b,x,A,D){for(var C=p[0],J=p[1],re=p[2],oe=p[3],ce=p[4],ae=p[5],ee=p[6],he=p[7],pe=b[0],Y=b[1],ve=b[2],wt=b[3],nt=b[4],Be=b[5],qt=b[6],Lt=b[7],_,O,Q,le,H,U,B,k;D>=128;){for(var Xe=0;Xe<16;Xe++){var st=8*Xe+A;g[Xe]=t.readUint32BE(x,st),m[Xe]=t.readUint32BE(x,st+4)}for(var Xe=0;Xe<80;Xe++){var Oi=C,Ee=J,Rr=re,F=oe,N=ce,T=ae,h=ee,I=he,Z=pe,ue=Y,me=ve,Oe=wt,Ae=nt,Ie=Be,_t=qt,dt=Lt;if(_=he,O=Lt,H=O&65535,U=O>>>16,B=_&65535,k=_>>>16,_=(ce>>>14|nt<<32-14)^(ce>>>18|nt<<32-18)^(nt>>>41-32|ce<<32-(41-32)),O=(nt>>>14|ce<<32-14)^(nt>>>18|ce<<32-18)^(ce>>>41-32|nt<<32-(41-32)),H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,_=ce&ae^~ce&ee,O=nt&Be^~nt&qt,H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,_=o[Xe*2],O=o[Xe*2+1],H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,_=g[Xe%16],O=m[Xe%16],H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,U+=H>>>16,B+=U>>>16,k+=B>>>16,Q=B&65535|k<<16,le=H&65535|U<<16,_=Q,O=le,H=O&65535,U=O>>>16,B=_&65535,k=_>>>16,_=(C>>>28|pe<<32-28)^(pe>>>34-32|C<<32-(34-32))^(pe>>>39-32|C<<32-(39-32)),O=(pe>>>28|C<<32-28)^(C>>>34-32|pe<<32-(34-32))^(C>>>39-32|pe<<32-(39-32)),H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,_=C&J^C&re^J&re,O=pe&Y^pe&ve^Y&ve,H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,U+=H>>>16,B+=U>>>16,k+=B>>>16,I=B&65535|k<<16,dt=H&65535|U<<16,_=F,O=Oe,H=O&65535,U=O>>>16,B=_&65535,k=_>>>16,_=Q,O=le,H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,U+=H>>>16,B+=U>>>16,k+=B>>>16,F=B&65535|k<<16,Oe=H&65535|U<<16,J=Oi,re=Ee,oe=Rr,ce=F,ae=N,ee=T,he=h,C=I,Y=Z,ve=ue,wt=me,nt=Oe,Be=Ae,qt=Ie,Lt=_t,pe=dt,Xe%16===15)for(var st=0;st<16;st++)_=g[st],O=m[st],H=O&65535,U=O>>>16,B=_&65535,k=_>>>16,_=g[(st+9)%16],O=m[(st+9)%16],H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,Q=g[(st+1)%16],le=m[(st+1)%16],_=(Q>>>1|le<<32-1)^(Q>>>8|le<<32-8)^Q>>>7,O=(le>>>1|Q<<32-1)^(le>>>8|Q<<32-8)^(le>>>7|Q<<32-7),H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,Q=g[(st+14)%16],le=m[(st+14)%16],_=(Q>>>19|le<<32-19)^(le>>>61-32|Q<<32-(61-32))^Q>>>6,O=(le>>>19|Q<<32-19)^(Q>>>61-32|le<<32-(61-32))^(le>>>6|Q<<32-6),H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,U+=H>>>16,B+=U>>>16,k+=B>>>16,g[st]=B&65535|k<<16,m[st]=H&65535|U<<16}_=C,O=pe,H=O&65535,U=O>>>16,B=_&65535,k=_>>>16,_=p[0],O=b[0],H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,U+=H>>>16,B+=U>>>16,k+=B>>>16,p[0]=C=B&65535|k<<16,b[0]=pe=H&65535|U<<16,_=J,O=Y,H=O&65535,U=O>>>16,B=_&65535,k=_>>>16,_=p[1],O=b[1],H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,U+=H>>>16,B+=U>>>16,k+=B>>>16,p[1]=J=B&65535|k<<16,b[1]=Y=H&65535|U<<16,_=re,O=ve,H=O&65535,U=O>>>16,B=_&65535,k=_>>>16,_=p[2],O=b[2],H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,U+=H>>>16,B+=U>>>16,k+=B>>>16,p[2]=re=B&65535|k<<16,b[2]=ve=H&65535|U<<16,_=oe,O=wt,H=O&65535,U=O>>>16,B=_&65535,k=_>>>16,_=p[3],O=b[3],H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,U+=H>>>16,B+=U>>>16,k+=B>>>16,p[3]=oe=B&65535|k<<16,b[3]=wt=H&65535|U<<16,_=ce,O=nt,H=O&65535,U=O>>>16,B=_&65535,k=_>>>16,_=p[4],O=b[4],H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,U+=H>>>16,B+=U>>>16,k+=B>>>16,p[4]=ce=B&65535|k<<16,b[4]=nt=H&65535|U<<16,_=ae,O=Be,H=O&65535,U=O>>>16,B=_&65535,k=_>>>16,_=p[5],O=b[5],H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,U+=H>>>16,B+=U>>>16,k+=B>>>16,p[5]=ae=B&65535|k<<16,b[5]=Be=H&65535|U<<16,_=ee,O=qt,H=O&65535,U=O>>>16,B=_&65535,k=_>>>16,_=p[6],O=b[6],H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,U+=H>>>16,B+=U>>>16,k+=B>>>16,p[6]=ee=B&65535|k<<16,b[6]=qt=H&65535|U<<16,_=he,O=Lt,H=O&65535,U=O>>>16,B=_&65535,k=_>>>16,_=p[7],O=b[7],H+=O&65535,U+=O>>>16,B+=_&65535,k+=_>>>16,U+=H>>>16,B+=U>>>16,k+=B>>>16,p[7]=he=B&65535|k<<16,b[7]=Lt=H&65535|U<<16,A+=128,D-=128}return A}function f(g){var m=new n;m.update(g);var p=m.digest();return m.clean(),p}a.hash=f})(Of);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const t=pf,r=Of,n=ff;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function o(F){const N=new Float64Array(16);if(F)for(let T=0;T<F.length;T++)N[T]=F[T];return N}const c=new Uint8Array(32);c[0]=9;const f=o(),g=o([1]),m=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),x=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),A=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function D(F,N){for(let T=0;T<16;T++)F[T]=N[T]|0}function C(F){let N=1;for(let T=0;T<16;T++){let h=F[T]+N+65535;N=Math.floor(h/65536),F[T]=h-N*65536}F[0]+=N-1+37*(N-1)}function J(F,N,T){const h=~(T-1);for(let I=0;I<16;I++){const Z=h&(F[I]^N[I]);F[I]^=Z,N[I]^=Z}}function re(F,N){const T=o(),h=o();for(let I=0;I<16;I++)h[I]=N[I];C(h),C(h),C(h);for(let I=0;I<2;I++){T[0]=h[0]-65517;for(let ue=1;ue<15;ue++)T[ue]=h[ue]-65535-(T[ue-1]>>16&1),T[ue-1]&=65535;T[15]=h[15]-32767-(T[14]>>16&1);const Z=T[15]>>16&1;T[14]&=65535,J(h,T,1-Z)}for(let I=0;I<16;I++)F[2*I]=h[I]&255,F[2*I+1]=h[I]>>8}function oe(F,N){let T=0;for(let h=0;h<32;h++)T|=F[h]^N[h];return(1&T-1>>>8)-1}function ce(F,N){const T=new Uint8Array(32),h=new Uint8Array(32);return re(T,F),re(h,N),oe(T,h)}function ae(F){const N=new Uint8Array(32);return re(N,F),N[0]&1}function ee(F,N){for(let T=0;T<16;T++)F[T]=N[2*T]+(N[2*T+1]<<8);F[15]&=32767}function he(F,N,T){for(let h=0;h<16;h++)F[h]=N[h]+T[h]}function pe(F,N,T){for(let h=0;h<16;h++)F[h]=N[h]-T[h]}function Y(F,N,T){let h,I,Z=0,ue=0,me=0,Oe=0,Ae=0,Ie=0,_t=0,dt=0,et=0,Te=0,ke=0,Ke=0,tt=0,Fe=0,Ve=0,Re=0,qe=0,ot=0,Ne=0,bt=0,Ct=0,Mt=0,zt=0,Nt=0,Gt=0,Xt=0,Lr=0,Wt=0,Vr=0,hi=0,Ri=0,at=T[0],Je=T[1],ct=T[2],ut=T[3],rt=T[4],Qe=T[5],Et=T[6],It=T[7],ht=T[8],xt=T[9],lt=T[10],gt=T[11],ft=T[12],He=T[13],Pt=T[14],St=T[15];h=N[0],Z+=h*at,ue+=h*Je,me+=h*ct,Oe+=h*ut,Ae+=h*rt,Ie+=h*Qe,_t+=h*Et,dt+=h*It,et+=h*ht,Te+=h*xt,ke+=h*lt,Ke+=h*gt,tt+=h*ft,Fe+=h*He,Ve+=h*Pt,Re+=h*St,h=N[1],ue+=h*at,me+=h*Je,Oe+=h*ct,Ae+=h*ut,Ie+=h*rt,_t+=h*Qe,dt+=h*Et,et+=h*It,Te+=h*ht,ke+=h*xt,Ke+=h*lt,tt+=h*gt,Fe+=h*ft,Ve+=h*He,Re+=h*Pt,qe+=h*St,h=N[2],me+=h*at,Oe+=h*Je,Ae+=h*ct,Ie+=h*ut,_t+=h*rt,dt+=h*Qe,et+=h*Et,Te+=h*It,ke+=h*ht,Ke+=h*xt,tt+=h*lt,Fe+=h*gt,Ve+=h*ft,Re+=h*He,qe+=h*Pt,ot+=h*St,h=N[3],Oe+=h*at,Ae+=h*Je,Ie+=h*ct,_t+=h*ut,dt+=h*rt,et+=h*Qe,Te+=h*Et,ke+=h*It,Ke+=h*ht,tt+=h*xt,Fe+=h*lt,Ve+=h*gt,Re+=h*ft,qe+=h*He,ot+=h*Pt,Ne+=h*St,h=N[4],Ae+=h*at,Ie+=h*Je,_t+=h*ct,dt+=h*ut,et+=h*rt,Te+=h*Qe,ke+=h*Et,Ke+=h*It,tt+=h*ht,Fe+=h*xt,Ve+=h*lt,Re+=h*gt,qe+=h*ft,ot+=h*He,Ne+=h*Pt,bt+=h*St,h=N[5],Ie+=h*at,_t+=h*Je,dt+=h*ct,et+=h*ut,Te+=h*rt,ke+=h*Qe,Ke+=h*Et,tt+=h*It,Fe+=h*ht,Ve+=h*xt,Re+=h*lt,qe+=h*gt,ot+=h*ft,Ne+=h*He,bt+=h*Pt,Ct+=h*St,h=N[6],_t+=h*at,dt+=h*Je,et+=h*ct,Te+=h*ut,ke+=h*rt,Ke+=h*Qe,tt+=h*Et,Fe+=h*It,Ve+=h*ht,Re+=h*xt,qe+=h*lt,ot+=h*gt,Ne+=h*ft,bt+=h*He,Ct+=h*Pt,Mt+=h*St,h=N[7],dt+=h*at,et+=h*Je,Te+=h*ct,ke+=h*ut,Ke+=h*rt,tt+=h*Qe,Fe+=h*Et,Ve+=h*It,Re+=h*ht,qe+=h*xt,ot+=h*lt,Ne+=h*gt,bt+=h*ft,Ct+=h*He,Mt+=h*Pt,zt+=h*St,h=N[8],et+=h*at,Te+=h*Je,ke+=h*ct,Ke+=h*ut,tt+=h*rt,Fe+=h*Qe,Ve+=h*Et,Re+=h*It,qe+=h*ht,ot+=h*xt,Ne+=h*lt,bt+=h*gt,Ct+=h*ft,Mt+=h*He,zt+=h*Pt,Nt+=h*St,h=N[9],Te+=h*at,ke+=h*Je,Ke+=h*ct,tt+=h*ut,Fe+=h*rt,Ve+=h*Qe,Re+=h*Et,qe+=h*It,ot+=h*ht,Ne+=h*xt,bt+=h*lt,Ct+=h*gt,Mt+=h*ft,zt+=h*He,Nt+=h*Pt,Gt+=h*St,h=N[10],ke+=h*at,Ke+=h*Je,tt+=h*ct,Fe+=h*ut,Ve+=h*rt,Re+=h*Qe,qe+=h*Et,ot+=h*It,Ne+=h*ht,bt+=h*xt,Ct+=h*lt,Mt+=h*gt,zt+=h*ft,Nt+=h*He,Gt+=h*Pt,Xt+=h*St,h=N[11],Ke+=h*at,tt+=h*Je,Fe+=h*ct,Ve+=h*ut,Re+=h*rt,qe+=h*Qe,ot+=h*Et,Ne+=h*It,bt+=h*ht,Ct+=h*xt,Mt+=h*lt,zt+=h*gt,Nt+=h*ft,Gt+=h*He,Xt+=h*Pt,Lr+=h*St,h=N[12],tt+=h*at,Fe+=h*Je,Ve+=h*ct,Re+=h*ut,qe+=h*rt,ot+=h*Qe,Ne+=h*Et,bt+=h*It,Ct+=h*ht,Mt+=h*xt,zt+=h*lt,Nt+=h*gt,Gt+=h*ft,Xt+=h*He,Lr+=h*Pt,Wt+=h*St,h=N[13],Fe+=h*at,Ve+=h*Je,Re+=h*ct,qe+=h*ut,ot+=h*rt,Ne+=h*Qe,bt+=h*Et,Ct+=h*It,Mt+=h*ht,zt+=h*xt,Nt+=h*lt,Gt+=h*gt,Xt+=h*ft,Lr+=h*He,Wt+=h*Pt,Vr+=h*St,h=N[14],Ve+=h*at,Re+=h*Je,qe+=h*ct,ot+=h*ut,Ne+=h*rt,bt+=h*Qe,Ct+=h*Et,Mt+=h*It,zt+=h*ht,Nt+=h*xt,Gt+=h*lt,Xt+=h*gt,Lr+=h*ft,Wt+=h*He,Vr+=h*Pt,hi+=h*St,h=N[15],Re+=h*at,qe+=h*Je,ot+=h*ct,Ne+=h*ut,bt+=h*rt,Ct+=h*Qe,Mt+=h*Et,zt+=h*It,Nt+=h*ht,Gt+=h*xt,Xt+=h*lt,Lr+=h*gt,Wt+=h*ft,Vr+=h*He,hi+=h*Pt,Ri+=h*St,Z+=38*qe,ue+=38*ot,me+=38*Ne,Oe+=38*bt,Ae+=38*Ct,Ie+=38*Mt,_t+=38*zt,dt+=38*Nt,et+=38*Gt,Te+=38*Xt,ke+=38*Lr,Ke+=38*Wt,tt+=38*Vr,Fe+=38*hi,Ve+=38*Ri,I=1,h=Z+I+65535,I=Math.floor(h/65536),Z=h-I*65536,h=ue+I+65535,I=Math.floor(h/65536),ue=h-I*65536,h=me+I+65535,I=Math.floor(h/65536),me=h-I*65536,h=Oe+I+65535,I=Math.floor(h/65536),Oe=h-I*65536,h=Ae+I+65535,I=Math.floor(h/65536),Ae=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=_t+I+65535,I=Math.floor(h/65536),_t=h-I*65536,h=dt+I+65535,I=Math.floor(h/65536),dt=h-I*65536,h=et+I+65535,I=Math.floor(h/65536),et=h-I*65536,h=Te+I+65535,I=Math.floor(h/65536),Te=h-I*65536,h=ke+I+65535,I=Math.floor(h/65536),ke=h-I*65536,h=Ke+I+65535,I=Math.floor(h/65536),Ke=h-I*65536,h=tt+I+65535,I=Math.floor(h/65536),tt=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=Ve+I+65535,I=Math.floor(h/65536),Ve=h-I*65536,h=Re+I+65535,I=Math.floor(h/65536),Re=h-I*65536,Z+=I-1+37*(I-1),I=1,h=Z+I+65535,I=Math.floor(h/65536),Z=h-I*65536,h=ue+I+65535,I=Math.floor(h/65536),ue=h-I*65536,h=me+I+65535,I=Math.floor(h/65536),me=h-I*65536,h=Oe+I+65535,I=Math.floor(h/65536),Oe=h-I*65536,h=Ae+I+65535,I=Math.floor(h/65536),Ae=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=_t+I+65535,I=Math.floor(h/65536),_t=h-I*65536,h=dt+I+65535,I=Math.floor(h/65536),dt=h-I*65536,h=et+I+65535,I=Math.floor(h/65536),et=h-I*65536,h=Te+I+65535,I=Math.floor(h/65536),Te=h-I*65536,h=ke+I+65535,I=Math.floor(h/65536),ke=h-I*65536,h=Ke+I+65535,I=Math.floor(h/65536),Ke=h-I*65536,h=tt+I+65535,I=Math.floor(h/65536),tt=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=Ve+I+65535,I=Math.floor(h/65536),Ve=h-I*65536,h=Re+I+65535,I=Math.floor(h/65536),Re=h-I*65536,Z+=I-1+37*(I-1),F[0]=Z,F[1]=ue,F[2]=me,F[3]=Oe,F[4]=Ae,F[5]=Ie,F[6]=_t,F[7]=dt,F[8]=et,F[9]=Te,F[10]=ke,F[11]=Ke,F[12]=tt,F[13]=Fe,F[14]=Ve,F[15]=Re}function ve(F,N){Y(F,N,N)}function wt(F,N){const T=o();let h;for(h=0;h<16;h++)T[h]=N[h];for(h=253;h>=0;h--)ve(T,T),h!==2&&h!==4&&Y(T,T,N);for(h=0;h<16;h++)F[h]=T[h]}function nt(F,N){const T=o();let h;for(h=0;h<16;h++)T[h]=N[h];for(h=250;h>=0;h--)ve(T,T),h!==1&&Y(T,T,N);for(h=0;h<16;h++)F[h]=T[h]}function Be(F,N){const T=o(),h=o(),I=o(),Z=o(),ue=o(),me=o(),Oe=o(),Ae=o(),Ie=o();pe(T,F[1],F[0]),pe(Ie,N[1],N[0]),Y(T,T,Ie),he(h,F[0],F[1]),he(Ie,N[0],N[1]),Y(h,h,Ie),Y(I,F[3],N[3]),Y(I,I,p),Y(Z,F[2],N[2]),he(Z,Z,Z),pe(ue,h,T),pe(me,Z,I),he(Oe,Z,I),he(Ae,h,T),Y(F[0],ue,me),Y(F[1],Ae,Oe),Y(F[2],Oe,me),Y(F[3],ue,Ae)}function qt(F,N,T){for(let h=0;h<4;h++)J(F[h],N[h],T)}function Lt(F,N){const T=o(),h=o(),I=o();wt(I,N[2]),Y(T,N[0],I),Y(h,N[1],I),re(F,h),F[31]^=ae(T)<<7}function _(F,N,T){D(F[0],f),D(F[1],g),D(F[2],g),D(F[3],f);for(let h=255;h>=0;--h){const I=T[h/8|0]>>(h&7)&1;qt(F,N,I),Be(N,F),Be(F,F),qt(F,N,I)}}function O(F,N){const T=[o(),o(),o(),o()];D(T[0],b),D(T[1],x),D(T[2],g),Y(T[3],b,x),_(F,T,N)}function Q(F){if(F.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const N=(0,r.hash)(F);N[0]&=248,N[31]&=127,N[31]|=64;const T=new Uint8Array(32),h=[o(),o(),o(),o()];O(h,N),Lt(T,h);const I=new Uint8Array(64);return I.set(F),I.set(T,32),{publicKey:T,secretKey:I}}a.generateKeyPairFromSeed=Q;function le(F){const N=(0,t.randomBytes)(32,F),T=Q(N);return(0,n.wipe)(N),T}a.generateKeyPair=le;function H(F){if(F.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(F.subarray(32))}a.extractPublicKeyFromSecretKey=H;const U=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function B(F,N){let T,h,I,Z;for(h=63;h>=32;--h){for(T=0,I=h-32,Z=h-12;I<Z;++I)N[I]+=T-16*N[h]*U[I-(h-32)],T=Math.floor((N[I]+128)/256),N[I]-=T*256;N[I]+=T,N[h]=0}for(T=0,I=0;I<32;I++)N[I]+=T-(N[31]>>4)*U[I],T=N[I]>>8,N[I]&=255;for(I=0;I<32;I++)N[I]-=T*U[I];for(h=0;h<32;h++)N[h+1]+=N[h]>>8,F[h]=N[h]&255}function k(F){const N=new Float64Array(64);for(let T=0;T<64;T++)N[T]=F[T];for(let T=0;T<64;T++)F[T]=0;B(F,N)}function Xe(F,N){const T=new Float64Array(64),h=[o(),o(),o(),o()],I=(0,r.hash)(F.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const Z=new Uint8Array(64);Z.set(I.subarray(32),32);const ue=new r.SHA512;ue.update(Z.subarray(32)),ue.update(N);const me=ue.digest();ue.clean(),k(me),O(h,me),Lt(Z,h),ue.reset(),ue.update(Z.subarray(0,32)),ue.update(F.subarray(32)),ue.update(N);const Oe=ue.digest();k(Oe);for(let Ae=0;Ae<32;Ae++)T[Ae]=me[Ae];for(let Ae=0;Ae<32;Ae++)for(let Ie=0;Ie<32;Ie++)T[Ae+Ie]+=Oe[Ae]*I[Ie];return B(Z.subarray(32),T),Z}a.sign=Xe;function st(F,N){const T=o(),h=o(),I=o(),Z=o(),ue=o(),me=o(),Oe=o();return D(F[2],g),ee(F[1],N),ve(I,F[1]),Y(Z,I,m),pe(I,I,F[2]),he(Z,F[2],Z),ve(ue,Z),ve(me,ue),Y(Oe,me,ue),Y(T,Oe,I),Y(T,T,Z),nt(T,T),Y(T,T,I),Y(T,T,Z),Y(T,T,Z),Y(F[0],T,Z),ve(h,F[0]),Y(h,h,Z),ce(h,I)&&Y(F[0],F[0],A),ve(h,F[0]),Y(h,h,Z),ce(h,I)?-1:(ae(F[0])===N[31]>>7&&pe(F[0],f,F[0]),Y(F[3],F[0],F[1]),0)}function Oi(F,N,T){const h=new Uint8Array(32),I=[o(),o(),o(),o()],Z=[o(),o(),o(),o()];if(T.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(st(Z,F))return!1;const ue=new r.SHA512;ue.update(T.subarray(0,32)),ue.update(F),ue.update(N);const me=ue.digest();return k(me),_(I,Z,me),O(Z,T.subarray(32)),Be(I,Z),Lt(h,I),!oe(T,h)}a.verify=Oi;function Ee(F){let N=[o(),o(),o(),o()];if(st(N,F))throw new Error("Ed25519: invalid public key");let T=o(),h=o(),I=N[1];he(T,g,I),pe(h,g,I),wt(h,h),Y(T,T,h);let Z=new Uint8Array(32);return re(Z,T),Z}a.convertPublicKeyToX25519=Ee;function Rr(F){const N=(0,r.hash)(F.subarray(0,32));N[0]&=248,N[31]&=127,N[31]|=64;const T=new Uint8Array(N.subarray(0,32));return(0,n.wipe)(N),T}a.convertSecretKeyToX25519=Rr})(kc);const l_="EdDSA",f_="JWT",Rf=".",Af="base64url",p_="utf8",d_="utf8",g_=":",y_="did",v_="key",vl="base58btc",m_="z",w_="K36",__=32;function Po(a){return Co(Hc(ki(a),p_),Af)}function Cf(a){const t=Hc(w_,vl),r=m_+Co(Lm([t,a]),vl);return[y_,v_,r].join(g_)}function b_(a){return Co(a,Af)}function E_(a){return Hc([Po(a.header),Po(a.payload)].join(Rf),d_)}function I_(a){return[Po(a.header),Po(a.payload),b_(a.signature)].join(Rf)}function ml(a=pf.randomBytes(__)){return kc.generateKeyPairFromSeed(a)}async function x_(a,t,r,n,o=te.fromMiliseconds(Date.now())){const c={alg:l_,typ:f_},f=Cf(n.publicKey),g=o+r,m={iss:f,sub:a,aud:t,iat:o,exp:g},p=E_({header:c,payload:m}),b=kc.sign(n.secretKey,p);return I_({header:c,payload:m,signature:b})}const P_="PARSE_ERROR",S_="INVALID_REQUEST",O_="METHOD_NOT_FOUND",R_="INVALID_PARAMS",Tf="INTERNAL_ERROR",Kc="SERVER_ERROR",A_=[-32700,-32600,-32601,-32602,-32603],Zn={[P_]:{code:-32700,message:"Parse error"},[S_]:{code:-32600,message:"Invalid Request"},[O_]:{code:-32601,message:"Method not found"},[R_]:{code:-32602,message:"Invalid params"},[Tf]:{code:-32603,message:"Internal error"},[Kc]:{code:-32e3,message:"Server error"}},$f=Kc;function C_(a){return A_.includes(a)}function wl(a){return Object.keys(Zn).includes(a)?Zn[a]:Zn[$f]}function T_(a){const t=Object.values(Zn).find(r=>r.code===a);return t||Zn[$f]}function Nf(a,t,r){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):a}var Df={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var $c=function(a,t){return $c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])},$c(a,t)};function $_(a,t){$c(a,t);function r(){this.constructor=a}a.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Nc=function(){return Nc=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(t[c]=r[c])}return t},Nc.apply(this,arguments)};function N_(a,t){var r={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&t.indexOf(n)<0&&(r[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(a);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(a,n[o])&&(r[n[o]]=a[n[o]]);return r}function D_(a,t,r,n){var o=arguments.length,c=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,t,r,n);else for(var g=a.length-1;g>=0;g--)(f=a[g])&&(c=(o<3?f(c):o>3?f(t,r,c):f(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c}function F_(a,t){return function(r,n){t(r,n,a)}}function j_(a,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,t)}function q_(a,t,r,n){function o(c){return c instanceof r?c:new r(function(f){f(c)})}return new(r||(r=Promise))(function(c,f){function g(b){try{p(n.next(b))}catch(x){f(x)}}function m(b){try{p(n.throw(b))}catch(x){f(x)}}function p(b){b.done?c(b.value):o(b.value).then(g,m)}p((n=n.apply(a,t||[])).next())})}function L_(a,t){var r={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,o,c,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(p){return function(b){return m([p,b])}}function m(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,o=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(c=r.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){r.label=p[1];break}if(p[0]===6&&r.label<c[1]){r.label=c[1],c=p;break}if(c&&r.label<c[2]){r.label=c[2],r.ops.push(p);break}c[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(a,r)}catch(b){p=[6,b],o=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function M_(a,t,r,n){n===void 0&&(n=r),a[n]=t[r]}function z_(a,t){for(var r in a)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=a[r])}function Dc(a){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&a[t],n=0;if(r)return r.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ff(a,t){var r=typeof Symbol=="function"&&a[Symbol.iterator];if(!r)return a;var n=r.call(a),o,c=[],f;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)c.push(o.value)}catch(g){f={error:g}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return c}function U_(){for(var a=[],t=0;t<arguments.length;t++)a=a.concat(Ff(arguments[t]));return a}function H_(){for(var a=0,t=0,r=arguments.length;t<r;t++)a+=arguments[t].length;for(var n=Array(a),o=0,t=0;t<r;t++)for(var c=arguments[t],f=0,g=c.length;f<g;f++,o++)n[o]=c[f];return n}function is(a){return this instanceof is?(this.v=a,this):new is(a)}function B_(a,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(a,t||[]),o,c=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(A){n[A]&&(o[A]=function(D){return new Promise(function(C,J){c.push([A,D,C,J])>1||g(A,D)})})}function g(A,D){try{m(n[A](D))}catch(C){x(c[0][3],C)}}function m(A){A.value instanceof is?Promise.resolve(A.value.v).then(p,b):x(c[0][2],A)}function p(A){g("next",A)}function b(A){g("throw",A)}function x(A,D){A(D),c.shift(),c.length&&g(c[0][0],c[0][1])}}function k_(a){var t,r;return t={},n("next"),n("throw",function(o){throw o}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(o,c){t[o]=a[o]?function(f){return(r=!r)?{value:is(a[o](f)),done:o==="return"}:c?c(f):f}:c}}function K_(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=a[Symbol.asyncIterator],r;return t?t.call(a):(a=typeof Dc=="function"?Dc(a):a[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(c){r[c]=a[c]&&function(f){return new Promise(function(g,m){f=a[c](f),o(g,m,f.done,f.value)})}}function o(c,f,g,m){Promise.resolve(m).then(function(p){c({value:p,done:g})},f)}}function V_(a,t){return Object.defineProperty?Object.defineProperty(a,"raw",{value:t}):a.raw=t,a}function G_(a){if(a&&a.__esModule)return a;var t={};if(a!=null)for(var r in a)Object.hasOwnProperty.call(a,r)&&(t[r]=a[r]);return t.default=a,t}function W_(a){return a&&a.__esModule?a:{default:a}}function J_(a,t){if(!t.has(a))throw new TypeError("attempted to get private field on non-instance");return t.get(a)}function Q_(a,t,r){if(!t.has(a))throw new TypeError("attempted to set private field on non-instance");return t.set(a,r),r}const Y_=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Nc},__asyncDelegator:k_,__asyncGenerator:B_,__asyncValues:K_,__await:is,__awaiter:q_,__classPrivateFieldGet:J_,__classPrivateFieldSet:Q_,__createBinding:M_,__decorate:D_,__exportStar:z_,__extends:$_,__generator:L_,__importDefault:W_,__importStar:G_,__makeTemplateObject:V_,__metadata:j_,__param:F_,__read:Ff,__rest:N_,__spread:U_,__spreadArrays:H_,__values:Dc},Symbol.toStringTag,{value:"Module"})),Z_=Ro(Y_);var ni={},_l;function X_(){if(_l)return ni;_l=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowserCryptoAvailable=ni.getSubtleCrypto=ni.getBrowerCrypto=void 0;function a(){return(qr===null||qr===void 0?void 0:qr.crypto)||(qr===null||qr===void 0?void 0:qr.msCrypto)||{}}ni.getBrowerCrypto=a;function t(){const n=a();return n.subtle||n.webkitSubtle}ni.getSubtleCrypto=t;function r(){return!!a()&&!!t()}return ni.isBrowserCryptoAvailable=r,ni}var si={},bl;function eb(){if(bl)return si;bl=1,Object.defineProperty(si,"__esModule",{value:!0}),si.isBrowser=si.isNode=si.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}si.isReactNative=a;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}si.isNode=t;function r(){return!a()&&!t()}return si.isBrowser=r,si}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const t=Z_;t.__exportStar(X_(),a),t.__exportStar(eb(),a)})(Df);function Vc(a=3){const t=Date.now()*Math.pow(10,a),r=Math.floor(Math.random()*Math.pow(10,a));return t+r}function Gc(a=6){return BigInt(Vc(a))}function Bi(a,t,r){return{id:r||Vc(),jsonrpc:"2.0",method:a,params:t}}function Fo(a,t){return{id:a,jsonrpc:"2.0",result:t}}function jo(a,t,r){return{id:a,jsonrpc:"2.0",error:tb(t,r)}}function tb(a,t){return typeof a>"u"?wl(Tf):(typeof a=="string"&&(a=Object.assign(Object.assign({},wl(Kc)),{message:a})),typeof t<"u"&&(a.data=t),C_(a.code)&&(a=T_(a.code)),a)}class rb{}class ib extends rb{constructor(){super()}}class jf extends ib{constructor(t){super()}}const nb="^https?:",sb="^wss?:";function ob(a){const t=a.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function qf(a,t){const r=ob(a);return typeof r>"u"?!1:new RegExp(t).test(r)}function El(a){return qf(a,nb)}function Il(a){return qf(a,sb)}function ab(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function Lf(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function Wc(a){return Lf(a)&&"method"in a}function as(a){return Lf(a)&&(ci(a)||Or(a))}function ci(a){return"result"in a}function Or(a){return"error"in a}let cb=class extends jf{constructor(t){super(t),this.events=new yr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Bi(t.method,t.params||[],t.id||Gc().toString()),r)}async requestStrict(t,r){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${t.id}`,c=>{Or(c)?o(c.error):n(c.result)});try{await this.connection.send(t,r)}catch(c){o(c)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),as(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const ub=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),hb=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",xl=a=>a.split("?")[0],Pl=10,lb=ub();let fb=class{constructor(t){if(this.url=t,this.events=new yr.EventEmitter,this.registering=!1,!Il(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ki(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!Il(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const o=new URLSearchParams(t).get("origin"),c=Df.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!ab(t)},f=new lb(t,[],c);hb()?f.onerror=g=>{const m=g;n(this.emitError(m.error))}:f.on("error",g=>{n(this.emitError(g))}),f.onopen=()=>{this.onOpen(f),r(f)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ss(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),o=n.message||n.toString(),c=jo(t,o);this.events.emit("payload",c)}parseError(t,r=this.url){return Nf(t,xl(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Pl&&this.events.setMaxListeners(Pl)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${xl(this.url)}`));return this.events.emit("register_error",r),r}};var So={exports:{}};So.exports;(function(a,t){var r=200,n="__lodash_hash_undefined__",o=1,c=2,f=9007199254740991,g="[object Arguments]",m="[object Array]",p="[object AsyncFunction]",b="[object Boolean]",x="[object Date]",A="[object Error]",D="[object Function]",C="[object GeneratorFunction]",J="[object Map]",re="[object Number]",oe="[object Null]",ce="[object Object]",ae="[object Promise]",ee="[object Proxy]",he="[object RegExp]",pe="[object Set]",Y="[object String]",ve="[object Symbol]",wt="[object Undefined]",nt="[object WeakMap]",Be="[object ArrayBuffer]",qt="[object DataView]",Lt="[object Float32Array]",_="[object Float64Array]",O="[object Int8Array]",Q="[object Int16Array]",le="[object Int32Array]",H="[object Uint8Array]",U="[object Uint8ClampedArray]",B="[object Uint16Array]",k="[object Uint32Array]",Xe=/[\\^$.*+?()[\]{}|]/g,st=/^\[object .+?Constructor\]$/,Oi=/^(?:0|[1-9]\d*)$/,Ee={};Ee[Lt]=Ee[_]=Ee[O]=Ee[Q]=Ee[le]=Ee[H]=Ee[U]=Ee[B]=Ee[k]=!0,Ee[g]=Ee[m]=Ee[Be]=Ee[b]=Ee[qt]=Ee[x]=Ee[A]=Ee[D]=Ee[J]=Ee[re]=Ee[ce]=Ee[he]=Ee[pe]=Ee[Y]=Ee[nt]=!1;var Rr=typeof qr=="object"&&qr&&qr.Object===Object&&qr,F=typeof self=="object"&&self&&self.Object===Object&&self,N=Rr||F||Function("return this")(),T=t&&!t.nodeType&&t,h=T&&!0&&a&&!a.nodeType&&a,I=h&&h.exports===T,Z=I&&Rr.process,ue=function(){try{return Z&&Z.binding&&Z.binding("util")}catch{}}(),me=ue&&ue.isTypedArray;function Oe(v,P){for(var M=-1,V=v==null?0:v.length,Me=0,de=[];++M<V;){var Ge=v[M];P(Ge,M,v)&&(de[Me++]=Ge)}return de}function Ae(v,P){for(var M=-1,V=P.length,Me=v.length;++M<V;)v[Me+M]=P[M];return v}function Ie(v,P){for(var M=-1,V=v==null?0:v.length;++M<V;)if(P(v[M],M,v))return!0;return!1}function _t(v,P){for(var M=-1,V=Array(v);++M<v;)V[M]=P(M);return V}function dt(v){return function(P){return v(P)}}function et(v,P){return v.has(P)}function Te(v,P){return v==null?void 0:v[P]}function ke(v){var P=-1,M=Array(v.size);return v.forEach(function(V,Me){M[++P]=[Me,V]}),M}function Ke(v,P){return function(M){return v(P(M))}}function tt(v){var P=-1,M=Array(v.size);return v.forEach(function(V){M[++P]=V}),M}var Fe=Array.prototype,Ve=Function.prototype,Re=Object.prototype,qe=N["__core-js_shared__"],ot=Ve.toString,Ne=Re.hasOwnProperty,bt=function(){var v=/[^.]+$/.exec(qe&&qe.keys&&qe.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Ct=Re.toString,Mt=RegExp("^"+ot.call(Ne).replace(Xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),zt=I?N.Buffer:void 0,Nt=N.Symbol,Gt=N.Uint8Array,Xt=Re.propertyIsEnumerable,Lr=Fe.splice,Wt=Nt?Nt.toStringTag:void 0,Vr=Object.getOwnPropertySymbols,hi=zt?zt.isBuffer:void 0,Ri=Ke(Object.keys,Object),at=hr(N,"DataView"),Je=hr(N,"Map"),ct=hr(N,"Promise"),ut=hr(N,"Set"),rt=hr(N,"WeakMap"),Qe=hr(Object,"create"),Et=Wr(at),It=Wr(Je),ht=Wr(ct),xt=Wr(ut),lt=Wr(rt),gt=Nt?Nt.prototype:void 0,ft=gt?gt.valueOf:void 0;function He(v){var P=-1,M=v==null?0:v.length;for(this.clear();++P<M;){var V=v[P];this.set(V[0],V[1])}}function Pt(){this.__data__=Qe?Qe(null):{},this.size=0}function St(v){var P=this.has(v)&&delete this.__data__[v];return this.size-=P?1:0,P}function Mo(v){var P=this.__data__;if(Qe){var M=P[v];return M===n?void 0:M}return Ne.call(P,v)?P[v]:void 0}function zo(v){var P=this.__data__;return Qe?P[v]!==void 0:Ne.call(P,v)}function Uo(v,P){var M=this.__data__;return this.size+=this.has(v)?0:1,M[v]=Qe&&P===void 0?n:P,this}He.prototype.clear=Pt,He.prototype.delete=St,He.prototype.get=Mo,He.prototype.has=zo,He.prototype.set=Uo;function vr(v){var P=-1,M=v==null?0:v.length;for(this.clear();++P<M;){var V=v[P];this.set(V[0],V[1])}}function Ho(){this.__data__=[],this.size=0}function Bo(v){var P=this.__data__,M=Ai(P,v);if(M<0)return!1;var V=P.length-1;return M==V?P.pop():Lr.call(P,M,1),--this.size,!0}function ko(v){var P=this.__data__,M=Ai(P,v);return M<0?void 0:P[M][1]}function Ko(v){return Ai(this.__data__,v)>-1}function Vo(v,P){var M=this.__data__,V=Ai(M,v);return V<0?(++this.size,M.push([v,P])):M[V][1]=P,this}vr.prototype.clear=Ho,vr.prototype.delete=Bo,vr.prototype.get=ko,vr.prototype.has=Ko,vr.prototype.set=Vo;function Gr(v){var P=-1,M=v==null?0:v.length;for(this.clear();++P<M;){var V=v[P];this.set(V[0],V[1])}}function Wi(){this.size=0,this.__data__={hash:new He,map:new(Je||vr),string:new He}}function Go(v){var P=li(this,v).delete(v);return this.size-=P?1:0,P}function Ji(v){return li(this,v).get(v)}function Wo(v){return li(this,v).has(v)}function Jo(v,P){var M=li(this,v),V=M.size;return M.set(v,P),this.size+=M.size==V?0:1,this}Gr.prototype.clear=Wi,Gr.prototype.delete=Go,Gr.prototype.get=Ji,Gr.prototype.has=Wo,Gr.prototype.set=Jo;function Qi(v){var P=-1,M=v==null?0:v.length;for(this.__data__=new Gr;++P<M;)this.add(v[P])}function us(v){return this.__data__.set(v,n),this}function hs(v){return this.__data__.has(v)}Qi.prototype.add=Qi.prototype.push=us,Qi.prototype.has=hs;function Ar(v){var P=this.__data__=new vr(v);this.size=P.size}function Qo(){this.__data__=new vr,this.size=0}function Yo(v){var P=this.__data__,M=P.delete(v);return this.size=P.size,M}function Zo(v){return this.__data__.get(v)}function Xo(v){return this.__data__.has(v)}function ls(v,P){var M=this.__data__;if(M instanceof vr){var V=M.__data__;if(!Je||V.length<r-1)return V.push([v,P]),this.size=++M.size,this;M=this.__data__=new Gr(V)}return M.set(v,P),this.size=M.size,this}Ar.prototype.clear=Qo,Ar.prototype.delete=Yo,Ar.prototype.get=Zo,Ar.prototype.has=Xo,Ar.prototype.set=ls;function fs(v,P){var M=Xi(v),V=!M&&xs(v),Me=!M&&!V&&Pn(v),de=!M&&!V&&!Me&&Os(v),Ge=M||V||Me||de,Ot=Ge?_t(v.length,String):[],Pe=Ot.length;for(var ze in v)(P||Ne.call(v,ze))&&!(Ge&&(ze=="length"||Me&&(ze=="offset"||ze=="parent")||de&&(ze=="buffer"||ze=="byteLength"||ze=="byteOffset")||ws(ze,Pe)))&&Ot.push(ze);return Ot}function Ai(v,P){for(var M=v.length;M--;)if(Is(v[M][0],P))return M;return-1}function In(v,P,M){var V=P(v);return Xi(v)?V:Ae(V,M(v))}function Ci(v){return v==null?v===void 0?wt:oe:Wt&&Wt in Object(v)?vs(v):ra(v)}function xn(v){return $i(v)&&Ci(v)==g}function Ti(v,P,M,V,Me){return v===P?!0:v==null||P==null||!$i(v)&&!$i(P)?v!==v&&P!==P:ps(v,P,M,V,Ti,Me)}function ps(v,P,M,V,Me,de){var Ge=Xi(v),Ot=Xi(P),Pe=Ge?m:Mr(v),ze=Ot?m:Mr(P);Pe=Pe==g?ce:Pe,ze=ze==g?ce:ze;var yt=Pe==ce,er=ze==ce,Rt=Pe==ze;if(Rt&&Pn(v)){if(!Pn(P))return!1;Ge=!0,yt=!1}if(Rt&&!yt)return de||(de=new Ar),Ge||Os(v)?Yi(v,P,M,V,Me,de):ta(v,P,Pe,M,V,Me,de);if(!(M&o)){var We=yt&&Ne.call(v,"__wrapped__"),Jt=er&&Ne.call(P,"__wrapped__");if(We||Jt){var Cr=We?v.value():v,mr=Jt?P.value():P;return de||(de=new Ar),Me(Cr,mr,M,V,de)}}return Rt?(de||(de=new Ar),ys(v,P,M,V,Me,de)):!1}function ea(v){if(!Ss(v)||bs(v))return!1;var P=en(v)?Mt:st;return P.test(Wr(v))}function ds(v){return $i(v)&&Ps(v.length)&&!!Ee[Ci(v)]}function gs(v){if(!Es(v))return Ri(v);var P=[];for(var M in Object(v))Ne.call(v,M)&&M!="constructor"&&P.push(M);return P}function Yi(v,P,M,V,Me,de){var Ge=M&o,Ot=v.length,Pe=P.length;if(Ot!=Pe&&!(Ge&&Pe>Ot))return!1;var ze=de.get(v);if(ze&&de.get(P))return ze==P;var yt=-1,er=!0,Rt=M&c?new Qi:void 0;for(de.set(v,P),de.set(P,v);++yt<Ot;){var We=v[yt],Jt=P[yt];if(V)var Cr=Ge?V(Jt,We,yt,P,v,de):V(We,Jt,yt,v,P,de);if(Cr!==void 0){if(Cr)continue;er=!1;break}if(Rt){if(!Ie(P,function(mr,zr){if(!et(Rt,zr)&&(We===mr||Me(We,mr,M,V,de)))return Rt.push(zr)})){er=!1;break}}else if(!(We===Jt||Me(We,Jt,M,V,de))){er=!1;break}}return de.delete(v),de.delete(P),er}function ta(v,P,M,V,Me,de,Ge){switch(M){case qt:if(v.byteLength!=P.byteLength||v.byteOffset!=P.byteOffset)return!1;v=v.buffer,P=P.buffer;case Be:return!(v.byteLength!=P.byteLength||!de(new Gt(v),new Gt(P)));case b:case x:case re:return Is(+v,+P);case A:return v.name==P.name&&v.message==P.message;case he:case Y:return v==P+"";case J:var Ot=ke;case pe:var Pe=V&o;if(Ot||(Ot=tt),v.size!=P.size&&!Pe)return!1;var ze=Ge.get(v);if(ze)return ze==P;V|=c,Ge.set(v,P);var yt=Yi(Ot(v),Ot(P),V,Me,de,Ge);return Ge.delete(v),yt;case ve:if(ft)return ft.call(v)==ft.call(P)}return!1}function ys(v,P,M,V,Me,de){var Ge=M&o,Ot=Zi(v),Pe=Ot.length,ze=Zi(P),yt=ze.length;if(Pe!=yt&&!Ge)return!1;for(var er=Pe;er--;){var Rt=Ot[er];if(!(Ge?Rt in P:Ne.call(P,Rt)))return!1}var We=de.get(v);if(We&&de.get(P))return We==P;var Jt=!0;de.set(v,P),de.set(P,v);for(var Cr=Ge;++er<Pe;){Rt=Ot[er];var mr=v[Rt],zr=P[Rt];if(V)var Sn=Ge?V(zr,mr,Rt,P,v,de):V(mr,zr,Rt,v,P,de);if(!(Sn===void 0?mr===zr||Me(mr,zr,M,V,de):Sn)){Jt=!1;break}Cr||(Cr=Rt=="constructor")}if(Jt&&!Cr){var Ni=v.constructor,Dt=P.constructor;Ni!=Dt&&"constructor"in v&&"constructor"in P&&!(typeof Ni=="function"&&Ni instanceof Ni&&typeof Dt=="function"&&Dt instanceof Dt)&&(Jt=!1)}return de.delete(v),de.delete(P),Jt}function Zi(v){return In(v,sa,ms)}function li(v,P){var M=v.__data__;return _s(P)?M[typeof P=="string"?"string":"hash"]:M.map}function hr(v,P){var M=Te(v,P);return ea(M)?M:void 0}function vs(v){var P=Ne.call(v,Wt),M=v[Wt];try{v[Wt]=void 0;var V=!0}catch{}var Me=Ct.call(v);return V&&(P?v[Wt]=M:delete v[Wt]),Me}var ms=Vr?function(v){return v==null?[]:(v=Object(v),Oe(Vr(v),function(P){return Xt.call(v,P)}))}:Le,Mr=Ci;(at&&Mr(new at(new ArrayBuffer(1)))!=qt||Je&&Mr(new Je)!=J||ct&&Mr(ct.resolve())!=ae||ut&&Mr(new ut)!=pe||rt&&Mr(new rt)!=nt)&&(Mr=function(v){var P=Ci(v),M=P==ce?v.constructor:void 0,V=M?Wr(M):"";if(V)switch(V){case Et:return qt;case It:return J;case ht:return ae;case xt:return pe;case lt:return nt}return P});function ws(v,P){return P=P??f,!!P&&(typeof v=="number"||Oi.test(v))&&v>-1&&v%1==0&&v<P}function _s(v){var P=typeof v;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?v!=="__proto__":v===null}function bs(v){return!!bt&&bt in v}function Es(v){var P=v&&v.constructor,M=typeof P=="function"&&P.prototype||Re;return v===M}function ra(v){return Ct.call(v)}function Wr(v){if(v!=null){try{return ot.call(v)}catch{}try{return v+""}catch{}}return""}function Is(v,P){return v===P||v!==v&&P!==P}var xs=xn(function(){return arguments}())?xn:function(v){return $i(v)&&Ne.call(v,"callee")&&!Xt.call(v,"callee")},Xi=Array.isArray;function ia(v){return v!=null&&Ps(v.length)&&!en(v)}var Pn=hi||je;function na(v,P){return Ti(v,P)}function en(v){if(!Ss(v))return!1;var P=Ci(v);return P==D||P==C||P==p||P==ee}function Ps(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=f}function Ss(v){var P=typeof v;return v!=null&&(P=="object"||P=="function")}function $i(v){return v!=null&&typeof v=="object"}var Os=me?dt(me):ds;function sa(v){return ia(v)?fs(v):gs(v)}function Le(){return[]}function je(){return!1}a.exports=na})(So,So.exports);var pb=So.exports;const db=Ao(pb);function gb(a,t){return t=t||{},new Promise(function(r,n){var o=new XMLHttpRequest,c=[],f=[],g={},m=function(){return{ok:(o.status/100|0)==2,statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:m,headers:{keys:function(){return c},entries:function(){return f},get:function(b){return g[b.toLowerCase()]},has:function(b){return b.toLowerCase()in g}}}};for(var p in o.open(t.method||"get",a,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(b,x,A){c.push(x=x.toLowerCase()),f.push([x,A]),g[x]=g[x]?g[x]+","+A:A}),r(m())},o.onerror=n,o.withCredentials=t.credentials=="include",t.headers)o.setRequestHeader(p,t.headers[p]);o.send(t.body||null)})}const yb=Object.freeze(Object.defineProperty({__proto__:null,default:gb},Symbol.toStringTag,{value:"Module"})),Sl=Ro(yb);var vb=self.fetch||(self.fetch=Sl.default||Sl);const mb=Ao(vb);function wb(a,t){if(a.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<a.length;o++){var c=a.charAt(o),f=c.charCodeAt(0);if(r[f]!==255)throw new TypeError(c+" is ambiguous");r[f]=o}var g=a.length,m=a.charAt(0),p=Math.log(g)/Math.log(256),b=Math.log(256)/Math.log(g);function x(C){if(C instanceof Uint8Array||(ArrayBuffer.isView(C)?C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength):Array.isArray(C)&&(C=Uint8Array.from(C))),!(C instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(C.length===0)return"";for(var J=0,re=0,oe=0,ce=C.length;oe!==ce&&C[oe]===0;)oe++,J++;for(var ae=(ce-oe)*b+1>>>0,ee=new Uint8Array(ae);oe!==ce;){for(var he=C[oe],pe=0,Y=ae-1;(he!==0||pe<re)&&Y!==-1;Y--,pe++)he+=256*ee[Y]>>>0,ee[Y]=he%g>>>0,he=he/g>>>0;if(he!==0)throw new Error("Non-zero carry");re=pe,oe++}for(var ve=ae-re;ve!==ae&&ee[ve]===0;)ve++;for(var wt=m.repeat(J);ve<ae;++ve)wt+=a.charAt(ee[ve]);return wt}function A(C){if(typeof C!="string")throw new TypeError("Expected String");if(C.length===0)return new Uint8Array;var J=0;if(C[J]!==" "){for(var re=0,oe=0;C[J]===m;)re++,J++;for(var ce=(C.length-J)*p+1>>>0,ae=new Uint8Array(ce);C[J];){var ee=r[C.charCodeAt(J)];if(ee===255)return;for(var he=0,pe=ce-1;(ee!==0||he<oe)&&pe!==-1;pe--,he++)ee+=g*ae[pe]>>>0,ae[pe]=ee%256>>>0,ee=ee/256>>>0;if(ee!==0)throw new Error("Non-zero carry");oe=he,J++}if(C[J]!==" "){for(var Y=ce-oe;Y!==ce&&ae[Y]===0;)Y++;for(var ve=new Uint8Array(re+(ce-Y)),wt=re;Y!==ce;)ve[wt++]=ae[Y++];return ve}}}function D(C){var J=A(C);if(J)return J;throw new Error(`Non-${t} character`)}return{encode:x,decodeUnsafe:A,decode:D}}var _b=wb,bb=_b;const Mf=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},Eb=a=>new TextEncoder().encode(a),Ib=a=>new TextDecoder().decode(a);class xb{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Pb{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return zf(this,t)}}class Sb{constructor(t){this.decoders=t}or(t){return zf(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const zf=(a,t)=>new Sb({...a.decoders||{[a.prefix]:a},...t.decoders||{[t.prefix]:t}});class Ob{constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new xb(t,r,n),this.decoder=new Pb(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const qo=({name:a,prefix:t,encode:r,decode:n})=>new Ob(a,t,r,n),cs=({prefix:a,name:t,alphabet:r})=>{const{encode:n,decode:o}=bb(r,t);return qo({prefix:a,name:t,encode:n,decode:c=>Mf(o(c))})},Rb=(a,t,r,n)=>{const o={};for(let b=0;b<t.length;++b)o[t[b]]=b;let c=a.length;for(;a[c-1]==="=";)--c;const f=new Uint8Array(c*r/8|0);let g=0,m=0,p=0;for(let b=0;b<c;++b){const x=o[a[b]];if(x===void 0)throw new SyntaxError(`Non-${n} character`);m=m<<r|x,g+=r,g>=8&&(g-=8,f[p++]=255&m>>g)}if(g>=r||255&m<<8-g)throw new SyntaxError("Unexpected end of data");return f},Ab=(a,t,r)=>{const n=t[t.length-1]==="=",o=(1<<r)-1;let c="",f=0,g=0;for(let m=0;m<a.length;++m)for(g=g<<8|a[m],f+=8;f>r;)f-=r,c+=t[o&g>>f];if(f&&(c+=t[o&g<<r-f]),n)for(;c.length*r&7;)c+="=";return c},Ht=({name:a,prefix:t,bitsPerChar:r,alphabet:n})=>qo({prefix:t,name:a,encode(o){return Ab(o,n,r)},decode(o){return Rb(o,n,r,a)}}),Cb=qo({prefix:"\0",name:"identity",encode:a=>Ib(a),decode:a=>Eb(a)});var Tb=Object.freeze({__proto__:null,identity:Cb});const $b=Ht({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Nb=Object.freeze({__proto__:null,base2:$b});const Db=Ht({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Fb=Object.freeze({__proto__:null,base8:Db});const jb=cs({prefix:"9",name:"base10",alphabet:"0123456789"});var qb=Object.freeze({__proto__:null,base10:jb});const Lb=Ht({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Mb=Ht({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var zb=Object.freeze({__proto__:null,base16:Lb,base16upper:Mb});const Ub=Ht({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Hb=Ht({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Bb=Ht({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),kb=Ht({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Kb=Ht({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Vb=Ht({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Gb=Ht({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Wb=Ht({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Jb=Ht({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Qb=Object.freeze({__proto__:null,base32:Ub,base32upper:Hb,base32pad:Bb,base32padupper:kb,base32hex:Kb,base32hexupper:Vb,base32hexpad:Gb,base32hexpadupper:Wb,base32z:Jb});const Yb=cs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Zb=cs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Xb=Object.freeze({__proto__:null,base36:Yb,base36upper:Zb});const eE=cs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),tE=cs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var rE=Object.freeze({__proto__:null,base58btc:eE,base58flickr:tE});const iE=Ht({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),nE=Ht({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),sE=Ht({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),oE=Ht({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var aE=Object.freeze({__proto__:null,base64:iE,base64pad:nE,base64url:sE,base64urlpad:oE});const Uf=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),cE=Uf.reduce((a,t,r)=>(a[r]=t,a),[]),uE=Uf.reduce((a,t,r)=>(a[t.codePointAt(0)]=r,a),[]);function hE(a){return a.reduce((t,r)=>(t+=cE[r],t),"")}function lE(a){const t=[];for(const r of a){const n=uE[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const fE=qo({prefix:"🚀",name:"base256emoji",encode:hE,decode:lE});var pE=Object.freeze({__proto__:null,base256emoji:fE}),dE=Hf,Ol=128,gE=127,yE=~gE,vE=Math.pow(2,31);function Hf(a,t,r){t=t||[],r=r||0;for(var n=r;a>=vE;)t[r++]=a&255|Ol,a/=128;for(;a&yE;)t[r++]=a&255|Ol,a>>>=7;return t[r]=a|0,Hf.bytes=r-n+1,t}var mE=Fc,wE=128,Rl=127;function Fc(a,n){var r=0,n=n||0,o=0,c=n,f,g=a.length;do{if(c>=g)throw Fc.bytes=0,new RangeError("Could not decode varint");f=a[c++],r+=o<28?(f&Rl)<<o:(f&Rl)*Math.pow(2,o),o+=7}while(f>=wE);return Fc.bytes=c-n,r}var _E=Math.pow(2,7),bE=Math.pow(2,14),EE=Math.pow(2,21),IE=Math.pow(2,28),xE=Math.pow(2,35),PE=Math.pow(2,42),SE=Math.pow(2,49),OE=Math.pow(2,56),RE=Math.pow(2,63),AE=function(a){return a<_E?1:a<bE?2:a<EE?3:a<IE?4:a<xE?5:a<PE?6:a<SE?7:a<OE?8:a<RE?9:10},CE={encode:dE,decode:mE,encodingLength:AE},Bf=CE;const Al=(a,t,r=0)=>(Bf.encode(a,t,r),t),Cl=a=>Bf.encodingLength(a),jc=(a,t)=>{const r=t.byteLength,n=Cl(a),o=n+Cl(r),c=new Uint8Array(o+r);return Al(a,c,0),Al(r,c,n),c.set(t,o),new TE(a,r,t,c)};class TE{constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}}const kf=({name:a,code:t,encode:r})=>new $E(a,t,r);class $E{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?jc(this.code,r):r.then(n=>jc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Kf=a=>async t=>new Uint8Array(await crypto.subtle.digest(a,t)),NE=kf({name:"sha2-256",code:18,encode:Kf("SHA-256")}),DE=kf({name:"sha2-512",code:19,encode:Kf("SHA-512")});var FE=Object.freeze({__proto__:null,sha256:NE,sha512:DE});const Vf=0,jE="identity",Gf=Mf,qE=a=>jc(Vf,Gf(a)),LE={code:Vf,name:jE,encode:Gf,digest:qE};var ME=Object.freeze({__proto__:null,identity:LE});new TextEncoder,new TextDecoder;const Tl={...Tb,...Nb,...Fb,...qb,...zb,...Qb,...Xb,...rE,...aE,...pE};({...FE,...ME});function Wf(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function zE(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Wf(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function Jf(a,t,r,n){return{name:a,prefix:t,encoder:{name:a,prefix:t,encode:r},decoder:{decode:n}}}const $l=Jf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),yc=Jf("ascii","a",a=>{let t="a";for(let r=0;r<a.length;r++)t+=String.fromCharCode(a[r]);return t},a=>{a=a.substring(1);const t=zE(a.length);for(let r=0;r<a.length;r++)t[r]=a.charCodeAt(r);return t}),UE={utf8:$l,"utf-8":$l,hex:Tl.base16,latin1:yc,ascii:yc,binary:yc,...Tl};function HE(a,t="utf8"){const r=UE[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Wf(globalThis.Buffer.from(a,"utf-8")):r.decoder.decode(`${r.prefix}${a}`)}const Qf="wc",BE=2,Jc="core",Ii=`${Qf}@2:${Jc}:`,kE={name:Jc,logger:"error"},KE={database:":memory:"},VE="crypto",Nl="client_ed25519_seed",GE=te.ONE_DAY,WE="keychain",JE="0.3",QE="messages",YE="0.3",ZE=te.SIX_HOURS,XE="publisher",Yf="irn",eI="error",Zf="wss://relay.walletconnect.com",Dl="wss://relay.walletconnect.org",tI="relayer",Vt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},rI="_subscription",oi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},iI=te.ONE_SECOND,nI="2.11.0",sI=1e4,oI="0.3",aI="WALLETCONNECT_CLIENT_ID",Fr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},cI="subscription",uI="0.3",hI=te.FIVE_SECONDS*1e3,lI="pairing",fI="0.3",kn={wc_pairingDelete:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:te.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:te.ONE_DAY,prompt:!1,tag:0},res:{ttl:te.ONE_DAY,prompt:!1,tag:0}}},Qn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},kr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},pI="history",dI="0.3",gI="expirer",Sr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},yI="0.3",vc="verify-api",wn="https://verify.walletconnect.com",qc="https://verify.walletconnect.org",vI=[wn,qc],mI="echo",wI="https://echo.walletconnect.com";class _I{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=WE,this.version=JE,this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:c}=G("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(c)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=ur(r,this.name)}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,vf(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?mf(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class bI{constructor(t,r,n){this.core=t,this.logger=r,this.name=VE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=ml(o);return Cf(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=Um();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),f=ml(c),g=Pc();return await x_(g,o,GE,f)},this.generateSharedKey=(o,c,f)=>{this.isInitialized();const g=this.getPrivateKey(o),m=Hm(g,c);return this.setSymKey(m,f)},this.setSymKey=async(o,c)=>{this.isInitialized();const f=c||Bm(o);return await this.keychain.set(f,o),f},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,f)=>{this.isInitialized();const g=km(f),m=ki(c);if(Xh(g)){const A=g.senderPublicKey,D=g.receiverPublicKey;o=await this.generateSharedKey(A,D)}const p=this.getSymKey(o),{type:b,senderPublicKey:x}=g;return Km({type:b,symKey:p,message:m,senderPublicKey:x})},this.decode=async(o,c,f)=>{this.isInitialized();const g=Vm(c,f);if(Xh(g)){const m=g.receiverPublicKey,p=g.senderPublicKey;o=await this.generateSharedKey(m,p)}try{const m=this.getSymKey(o),p=Gm({symKey:m,encoded:c});return ss(p)}catch(m){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(m)}},this.getPayloadType=o=>{const c=el(o);return Wm(c.type)},this.getPayloadSenderPublicKey=o=>{const c=el(o);return c.senderPublicKey?Co(c.senderPublicKey,Jm):void 0},this.core=t,this.logger=ur(r,this.name),this.keychain=n||new _I(this.core,this.logger)}get context(){return cr(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Nl)}catch{t=Pc(),await this.keychain.set(Nl,t)}return HE(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class EI extends t_{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=QE,this.version=YE,this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const c=_n(o);let f=this.messages.get(n);return typeof f>"u"&&(f={}),typeof f[c]<"u"||(f[c]=o,this.messages.set(n,f),await this.persist()),c},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const c=this.get(n),f=_n(o);return typeof c[f]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=ur(t,this.name),this.core=r}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,vf(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?mf(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class II extends r_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new yr.EventEmitter,this.name=XE,this.queue=new Map,this.publishTimeout=te.toMiliseconds(te.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,o,c)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:c}});try{const g=(c==null?void 0:c.ttl)||ZE,m=Sc(c),p=(c==null?void 0:c.prompt)||!1,b=(c==null?void 0:c.tag)||0,x=(c==null?void 0:c.id)||Gc().toString(),A={topic:n,message:o,opts:{ttl:g,relay:m,prompt:p,tag:b,id:x}},D=setTimeout(()=>this.queue.set(x,A),this.publishTimeout);try{await await Xn(this.rpcPublish(n,o,g,m,p,b,x),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(x),this.relayer.events.emit(Vt.publish,A)}catch(C){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=c==null?void 0:c.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(x),C;return}finally{clearTimeout(D)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:c}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=t,this.logger=ur(r,this.name),this.registerEventListeners()}get context(){return cr(this.logger)}rpcPublish(t,r,n,o,c,f,g){var m,p,b,x;const A={method:bo(o.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:c,tag:f},id:g};return Ei((m=A.params)==null?void 0:m.prompt)&&((p=A.params)==null||delete p.prompt),Ei((b=A.params)==null?void 0:b.tag)&&((x=A.params)==null||delete x.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:A}),this.relayer.request(A)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:o}=t;await this.publish(r,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(En.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Vt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Vt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class xI{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const o=n.filter(c=>c!==r);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var PI=Object.defineProperty,SI=Object.defineProperties,OI=Object.getOwnPropertyDescriptors,Fl=Object.getOwnPropertySymbols,RI=Object.prototype.hasOwnProperty,AI=Object.prototype.propertyIsEnumerable,jl=(a,t,r)=>t in a?PI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Kn=(a,t)=>{for(var r in t||(t={}))RI.call(t,r)&&jl(a,r,t[r]);if(Fl)for(var r of Fl(t))AI.call(t,r)&&jl(a,r,t[r]);return a},mc=(a,t)=>SI(a,OI(t));class CI extends s_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new xI,this.events=new yr.EventEmitter,this.name=cI,this.version=uI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ii,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const c=Sc(o),f={topic:n,relay:c};this.pending.set(n,f);const g=await this.rpcSubscribe(n,c);return this.onSubscribe(g,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),g}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((o,c)=>{const f=new te.Watch;f.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),o(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=hI&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=ur(r,this.name),this.clientId=""}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async o=>await this.unsubscribeById(t,o,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const o=Sc(n);await this.rpcUnsubscribe(t,r,o);const c=Kt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,r){const n={method:bo(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Xn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Vt.connection_stalled)}return _n(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,n={method:bo(r.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Xn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Vt.connection_stalled)}}rpcUnsubscribe(t,r,n){const o={method:bo(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,r){this.setSubscription(t,mc(Kn({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Kn({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Kn({},r)),this.topicMap.set(r.topic,t),this.events.emit(Fr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(Fr.deleted,mc(Kn({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Fr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Fr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);bn(r)&&this.onBatchSubscribe(r.map((n,o)=>mc(Kn({},t[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(En.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Vt.connect,async()=>{await this.onConnect()}),this.relayer.on(Vt.disconnect,()=>{this.onDisconnect()}),this.events.on(Fr.created,async t=>{const r=Fr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(Fr.deleted,async t=>{const r=Fr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var TI=Object.defineProperty,ql=Object.getOwnPropertySymbols,$I=Object.prototype.hasOwnProperty,NI=Object.prototype.propertyIsEnumerable,Ll=(a,t,r)=>t in a?TI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,DI=(a,t)=>{for(var r in t||(t={}))$I.call(t,r)&&Ll(a,r,t[r]);if(ql)for(var r of ql(t))NI.call(t,r)&&Ll(a,r,t[r]);return a};class FI extends i_{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new yr.EventEmitter,this.name=tI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Vt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Vt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(oi.payload,this.onPayloadHandler),this.provider.on(oi.connect,this.onConnectHandler),this.provider.on(oi.disconnect,this.onDisconnectHandler),this.provider.on(oi.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?ur(t.logger,this.name):No(Do({level:t.logger||eI})),this.messages=new EI(this.logger,t.core),this.subscriber=new CI(this,this.logger),this.publisher=new II(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Zf,this.projectId=t.projectId,this.bundleId=Qm(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Dl}...`),await this.restartTransport(Dl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},sI)}get context(){return cr(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"";if(o)return o;let c;const f=g=>{g.topic===t&&(this.subscriber.off(Fr.created,f),c())};return await Promise.all([new Promise(g=>{c=g,this.subscriber.on(Fr.created,f)}),new Promise(async g=>{o=await this.subscriber.subscribe(t,r),g()})]),o}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Xn(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Fr.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await Xn(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){n(o);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(oi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await tl())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new cb(new fb(Ym({sdkVersion:nI,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const o=this.messages.has(r,n);return o&&this.logger.debug(`Ignoring duplicate message: ${n}`),o}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Wc(t)){if(!t.method.endsWith(rI))return;const r=t.params,{topic:n,message:o,publishedAt:c}=r.data,f={topic:n,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(DI({type:"event",event:r.id},f)),this.events.emit(r.id,f),await this.acknowledgePayload(t),await this.onMessageEvent(f)}else as(t)&&this.events.emit(Vt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Vt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Fo(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(oi.payload,this.onPayloadHandler),this.provider.off(oi.connect,this.onConnectHandler),this.provider.off(oi.disconnect,this.onDisconnectHandler),this.provider.off(oi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Vt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await tl();Zm(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Vt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},te.toMiliseconds(iI)))}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var jI=Object.defineProperty,Ml=Object.getOwnPropertySymbols,qI=Object.prototype.hasOwnProperty,LI=Object.prototype.propertyIsEnumerable,zl=(a,t,r)=>t in a?jI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Ul=(a,t)=>{for(var r in t||(t={}))qI.call(t,r)&&zl(a,r,t[r]);if(Ml)for(var r of Ml(t))LI.call(t,r)&&zl(a,r,t[r]);return a};class Lo extends n_{constructor(t,r,n,o=Ii,c=void 0){super(t,r,n,o),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=oI,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!Ei(f)?this.map.set(this.getKey(f),f):Mm(f)?this.map.set(f.id,f):zm(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,g)=>{this.isInitialized(),this.map.has(f)?await this.update(f,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:g}),this.map.set(f,g),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(g=>Object.keys(f).every(m=>db(g[m],f[m]))):this.values),this.update=async(f,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:g});const m=Ul(Ul({},this.getData(f)),g);this.map.set(f,m),await this.persist()},this.delete=async(f,g)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:g}),this.map.delete(f),await this.persist())},this.logger=ur(r,this.name),this.storagePrefix=o,this.getKey=c}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class MI{constructor(t,r){this.core=t,this.logger=r,this.name=lI,this.version=fI,this.events=new Bc,this.initialized=!1,this.storagePrefix=Ii,this.ignoredPayloadTypes=[df],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Pc(),o=await this.core.crypto.setSymKey(n),c=jr(te.FIVE_MINUTES),f={protocol:Yf},g={topic:o,expiry:c,relay:f,active:!1},m=Xm({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:f});return await this.pairings.set(o,g),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:m}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:c,relay:f}=rl(n.uri);let g;if(this.pairings.keys.includes(o)&&(g=this.pairings.get(o),g.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const m=jr(te.FIVE_MINUTES),p={topic:o,relay:f,expiry:m,active:!1};return await this.pairings.set(o,p),this.core.expirer.set(o,m),n.activatePairing&&await this.activate({topic:o}),this.events.emit(Qn.create,p),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:f})),p},this.activate=async({topic:n})=>{this.isInitialized();const o=jr(te.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:f,resolve:g,reject:m}=vn();this.events.once(At("pairing_ping",c),({error:p})=>{p?m(p):g()}),await f()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",Kt("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,c)=>{const f=Bi(o,c),g=await this.core.crypto.encode(n,f),m=kn[o].req;return this.core.history.set(n,f),this.core.relayer.publish(n,g,m),f.id},this.sendResult=async(n,o,c)=>{const f=Fo(n,c),g=await this.core.crypto.encode(o,f),m=await this.core.history.get(o,n),p=kn[m.request.method].res;await this.core.relayer.publish(o,g,p),await this.core.history.resolve(f)},this.sendError=async(n,o,c)=>{const f=jo(n,c),g=await this.core.crypto.encode(o,f),m=await this.core.history.get(o,n),p=kn[m.request.method]?kn[m.request.method].res:kn.unregistered_method.res;await this.core.relayer.publish(o,g,p),await this.core.history.resolve(f)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Kt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>bi(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:c}=n;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:c}=n,f=(await this.core.history.get(o,c.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(n,o)=>{const{id:c}=o;try{this.isValidPing({topic:n}),await this.sendResult(c,n,!0),this.events.emit(Qn.ping,{id:c,topic:n})}catch(f){await this.sendError(c,n,f),this.logger.error(f)}},this.onPairingPingResponse=(n,o)=>{const{id:c}=o;setTimeout(()=>{ci(o)?this.events.emit(At("pairing_ping",c),{}):Or(o)&&this.events.emit(At("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Qn.delete,{id:c,topic:n})}catch(f){await this.sendError(c,n,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:c,method:f}=o;try{if(this.registeredMethods.includes(f))return;const g=Kt("WC_METHOD_UNSUPPORTED",f);await this.sendError(c,n,g),this.logger.error(g)}catch(g){await this.sendError(c,n,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Kt("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var o;if(!ar(n)){const{message:f}=G("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(f)}if(!e1(n.uri)){const{message:f}=G("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(f)}const c=rl(n.uri);if(!((o=c==null?void 0:c.relay)!=null&&o.protocol)){const{message:f}=G("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(f)}if(!(c!=null&&c.symKey)){const{message:f}=G("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(f)}},this.isValidPing=async n=>{if(!ar(n)){const{message:c}=G("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(c)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!ar(n)){const{message:c}=G("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(c)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!mn(n,!1)){const{message:o}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(bi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=G("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=t,this.logger=ur(r,this.name),this.pairings=new Lo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return cr(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Vt.message,async t=>{const{topic:r,message:n}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(r,n);try{Wc(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):as(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.core.history.delete(r,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Sr.expired,async t=>{const{topic:r}=gf(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Qn.expire,{topic:r}))})}}class zI extends e_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new yr.EventEmitter,this.name=pI,this.version=dI,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:c}),this.records.has(o.id))return;const f={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:c,expiry:jr(te.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(kr.created,f)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=Or(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(kr.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===n){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(kr.deleted,c)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=ur(r,this.name)}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:Bi(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(kr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(kr.created,t=>{const r=kr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(kr.updated,t=>{const r=kr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(kr.deleted,t=>{const r=kr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(En.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{te.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class UI extends o_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new yr.EventEmitter,this.name=gI,this.version=yI,this.cached=[],this.initialized=!1,this.storagePrefix=Ii,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const c=this.formatTarget(n),f={target:c,expiry:o};this.expirations.set(c,f),this.checkExpiry(c,f),this.events.emit(Sr.created,{target:c,expiration:f})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Sr.deleted,{target:o,expiration:c})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=ur(r,this.name)}get context(){return cr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return t1(t);if(typeof t=="number")return r1(t);const{message:r}=G("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Sr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;te.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Sr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(En.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Sr.created,t=>{const r=Sr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Sr.expired,t=>{const r=Sr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Sr.deleted,t=>{const r=Sr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class HI extends a_{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=vc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||i1()||!yf())return;const o=this.getVerifyUrl(n==null?void 0:n.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=qc;try{await this.createIframe()}catch(c){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(c),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(n==null?void 0:n.verifyUrl);let c;try{c=await this.fetchAttestation(n.attestationId,o)}catch(f){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${o}`),this.logger.info(f),c=await this.fetchAttestation(n.attestationId,qc)}return c},this.fetchAttestation=async(n,o)=>{this.logger.info(`resolving attestation: ${n} from url: ${o}`);const c=this.startAbortTimer(te.ONE_SECOND*2),f=await fetch(`${o}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(c),f.status===200?await f.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),n())};await Promise.race([new Promise(c=>{if(document.getElementById(vc))return c();window.addEventListener("message",o);const f=document.createElement("iframe");f.id=vc,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,n=c}),new Promise((c,f)=>setTimeout(()=>{window.removeEventListener("message",o),f("verify iframe load timeout")},te.toMiliseconds(te.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let o=n||wn;return vI.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${wn}`),o=wn),o},this.logger=ur(r,this.name),this.verifyUrl=wn,this.abortController=new AbortController,this.isDevEnv=n1()&&{}.IS_VITEST}get context(){return cr(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),te.toMiliseconds(t))}}class BI extends c_{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.context=mI,this.registerDeviceToken=async n=>{const{clientId:o,token:c,notificationType:f,enableEncrypted:g=!1}=n,m=`${wI}/${this.projectId}/clients`;await mb(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:o,type:f,token:c,always_raw:g})})},this.logger=ur(r,this.context)}}var kI=Object.defineProperty,Hl=Object.getOwnPropertySymbols,KI=Object.prototype.hasOwnProperty,VI=Object.prototype.propertyIsEnumerable,Bl=(a,t,r)=>t in a?kI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,kl=(a,t)=>{for(var r in t||(t={}))KI.call(t,r)&&Bl(a,r,t[r]);if(Hl)for(var r of Hl(t))VI.call(t,r)&&Bl(a,r,t[r]);return a};class Qc extends Xw{constructor(t){super(t),this.protocol=Qf,this.version=BE,this.name=Jc,this.events=new yr.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Zf,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:No(Do({level:(t==null?void 0:t.logger)||kE.logger}));this.logger=ur(r,this.name),this.heartbeat=new En.HeartBeat,this.crypto=new bI(this,this.logger,t==null?void 0:t.keychain),this.history=new zI(this,this.logger),this.expirer=new UI(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new rw(kl(kl({},KE),t==null?void 0:t.storageOptions)),this.relayer=new FI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new MI(this,this.logger),this.verify=new HI(this.projectId||"",this.logger),this.echoClient=new BI(this.projectId||"",this.logger)}static async init(t){const r=new Qc(t);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(aI,n),r}get context(){return cr(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const GI=Qc,Xf="wc",ep=2,tp="client",Yc=`${Xf}@${ep}:${tp}:`,wc={name:tp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Kl="WALLETCONNECT_DEEPLINK_CHOICE",WI="proposal",rp="Proposal expired",JI="session",mo=te.SEVEN_DAYS,QI="engine",Vn={wc_sessionPropose:{req:{ttl:te.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1104},res:{ttl:te.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1106},res:{ttl:te.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:te.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:te.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:te.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:te.ONE_DAY,prompt:!1,tag:1112},res:{ttl:te.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:te.THIRTY_SECONDS,prompt:!1,tag:1115}}},_c={min:te.FIVE_MINUTES,max:te.SEVEN_DAYS},ai={idle:"IDLE",active:"ACTIVE"},YI="request",ZI=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var XI=Object.defineProperty,ex=Object.defineProperties,tx=Object.getOwnPropertyDescriptors,Vl=Object.getOwnPropertySymbols,rx=Object.prototype.hasOwnProperty,ix=Object.prototype.propertyIsEnumerable,Gl=(a,t,r)=>t in a?XI(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,sr=(a,t)=>{for(var r in t||(t={}))rx.call(t,r)&&Gl(a,r,t[r]);if(Vl)for(var r of Vl(t))ix.call(t,r)&&Gl(a,r,t[r]);return a},Gn=(a,t)=>ex(a,tx(t));class nx extends h_{constructor(t){super(t),this.name=QI,this.events=new Bc,this.initialized=!1,this.ignoredPayloadTypes=[df],this.requestQueue={state:ai.idle,queue:[]},this.sessionRequestQueue={state:ai.idle,queue:[]},this.requestQueueDelay=te.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Vn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},te.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=Gn(sr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:f,sessionProperties:g,relays:m}=n;let p=o,b,x=!1;if(p&&(x=this.client.core.pairing.pairings.get(p).active),!p||!x){const{topic:ae,uri:ee}=await this.client.core.pairing.create();p=ae,b=ee}const A=await this.client.core.crypto.generateKeyPair(),D=sr({requiredNamespaces:c,optionalNamespaces:f,relays:m??[{protocol:Yf}],proposer:{publicKey:A,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:C,resolve:J,done:re}=vn(te.FIVE_MINUTES,rp);if(this.events.once(At("session_connect"),async({error:ae,session:ee})=>{if(ae)C(ae);else if(ee){ee.self.publicKey=A;const he=Gn(sr({},ee),{requiredNamespaces:ee.requiredNamespaces,optionalNamespaces:ee.optionalNamespaces});await this.client.session.set(ee.topic,he),await this.setExpiry(ee.topic,ee.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:ee.peer.metadata}),J(he)}}),!p){const{message:ae}=G("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(ae)}const oe=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:D}),ce=jr(te.FIVE_MINUTES);return await this.setProposal(oe,sr({id:oe,expiry:ce},D)),{uri:b,approval:re}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:o,namespaces:c,sessionProperties:f}=r,g=this.client.proposal.get(n);let{pairingTopic:m,proposer:p,requiredNamespaces:b,optionalNamespaces:x}=g;m=m||"",Eo(b)||(b=o1(c,"approve()"));const A=await this.client.core.crypto.generateKeyPair(),D=p.publicKey,C=await this.client.core.crypto.generateSharedKey(A,D);m&&n&&(await this.client.core.pairing.updateMetadata({topic:m,metadata:p.metadata}),await this.sendResult({id:n,topic:m,result:{relay:{protocol:o??"irn"},responderPublicKey:A}}),await this.client.proposal.delete(n,Kt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:m}));const J=sr({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:b,optionalNamespaces:x,pairingTopic:m,controller:{publicKey:A,metadata:this.client.metadata},expiry:jr(mo)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe(C),await this.sendRequest({topic:C,method:"wc_sessionSettle",params:J,throwOnFailedPublish:!0});const re=Gn(sr({},J),{topic:C,pairingTopic:m,acknowledged:!1,self:J.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:A});return await this.client.session.set(C,re),await this.setExpiry(C,jr(mo)),{topic:C,acknowledged:()=>new Promise(oe=>setTimeout(()=>oe(this.client.session.get(C)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:o}=r,{pairingTopic:c}=this.client.proposal.get(n);c&&(await this.sendError(n,c,o),await this.client.proposal.delete(n,Kt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:o}=r,c=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:f,resolve:g,reject:m}=vn();return this.events.once(At("session_update",c),({error:p})=>{p?m(p):g()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:f}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,o=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:c,resolve:f,reject:g}=vn();return this.events.once(At("session_extend",o),({error:m})=>{m?g(m):f()}),await this.setExpiry(n,jr(mo)),{acknowledged:c}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:o,topic:c,expiry:f}=r,g=Vc(),{done:m,resolve:p,reject:b}=vn(f,"Request expired. Please try again.");return this.events.once(At("session_request",g),({error:x,result:A})=>{x?b(x):p(A)}),await Promise.all([new Promise(async x=>{await this.sendRequest({clientRpcId:g,topic:c,method:"wc_sessionRequest",params:{request:o,chainId:n},expiry:f,throwOnFailedPublish:!0}).catch(A=>b(A)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:n,id:g}),x()}),new Promise(async x=>{const A=await a1(this.client.core.storage,Kl);c1({id:g,topic:c,wcDeepLink:A}),x()}),m()]).then(x=>x[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:o}=r,{id:c}=o;ci(o)?await this.sendResult({id:c,topic:n,result:o.result,throwOnFailedPublish:!0}):Or(o)&&await this.sendError(c,n,o.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const o=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:c,resolve:f,reject:g}=vn();this.events.once(At("session_ping",o),({error:m})=>{m?g(m):f()}),await c()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:o,chainId:c}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:Kt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>u1(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var f,g;return((f=c.peerMetadata)==null?void 0:f.url)&&((g=c.peerMetadata)==null?void 0:g.url)===r.peer.metadata.url&&c.topic&&c.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,Kt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(Kl).catch(c=>this.client.logger.warn(c)),this.getPendingSessionRequests().forEach(c=>{c.topic===r&&this.deletePendingSessionRequest(c.id,Kt("USER_DISCONNECTED"))})},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,Kt("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),o?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==r),o&&(this.sessionRequestQueue.state=ai.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=Vn.wc_sessionRequest.req.ttl,{id:o,topic:c,params:f,verifyContext:g}=r;await this.client.pendingRequest.set(o,{id:o,topic:c,params:f,verifyContext:g}),n&&this.client.core.expirer.set(o,jr(n))},this.sendRequest=async r=>{const{topic:n,method:o,params:c,expiry:f,relayRpcId:g,clientRpcId:m,throwOnFailedPublish:p}=r,b=Bi(o,c,m);if(yf()&&ZI.includes(o)){const D=_n(JSON.stringify(b));this.client.core.verify.register({attestationId:D})}const x=await this.client.core.crypto.encode(n,b),A=Vn[o].req;return f&&(A.ttl=f),g&&(A.id=g),this.client.core.history.set(n,b),p?(A.internal=Gn(sr({},A.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,x,A)):this.client.core.relayer.publish(n,x,A).catch(D=>this.client.logger.error(D)),b.id},this.sendResult=async r=>{const{id:n,topic:o,result:c,throwOnFailedPublish:f}=r,g=Fo(n,c),m=await this.client.core.crypto.encode(o,g),p=await this.client.core.history.get(o,n),b=Vn[p.request.method].res;f?(b.internal=Gn(sr({},b.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,m,b)):this.client.core.relayer.publish(o,m,b).catch(x=>this.client.logger.error(x)),await this.client.core.history.resolve(g)},this.sendError=async(r,n,o)=>{const c=jo(r,o),f=await this.client.core.crypto.encode(n,c),g=await this.client.core.history.get(n,r),m=Vn[g.request.method].res;this.client.core.relayer.publish(n,f,m),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(o=>{bi(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{bi(o.expiry)&&n.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ai.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ai.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=ai.idle},this.processRequest=r=>{const{topic:n,payload:o}=r,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:o}=r,c=(await this.client.core.history.get(n,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:o}=G("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,n)=>{const{params:o,id:c}=n;try{this.isValidConnect(sr({},n.params));const f=jr(te.FIVE_MINUTES),g=sr({id:c,pairingTopic:r,expiry:f},o);await this.setProposal(c,g);const m=_n(JSON.stringify(n)),p=await this.getVerifyContext(m,g.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:g,verifyContext:p})}catch(f){await this.sendError(c,r,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(r,n)=>{const{id:o}=n;if(ci(n)){const{result:c}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const f=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const m=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:m});const p=await this.client.core.crypto.generateSharedKey(g,m);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const b=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:b}),await this.client.core.pairing.activate({topic:r})}else Or(n)&&(await this.client.proposal.delete(o,Kt("USER_DISCONNECTED")),this.events.emit(At("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:o,params:c}=n;try{this.isValidSessionSettleRequest(c);const{relay:f,controller:g,expiry:m,namespaces:p,requiredNamespaces:b,optionalNamespaces:x,sessionProperties:A,pairingTopic:D}=n.params,C=sr({topic:r,relay:f,expiry:m,namespaces:p,acknowledged:!0,pairingTopic:D,requiredNamespaces:b,optionalNamespaces:x,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},A&&{sessionProperties:A});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit(At("session_connect"),{session:C}),this.cleanupDuplicatePairings(C)}catch(f){await this.sendError(o,r,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(r,n)=>{const{id:o}=n;ci(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(At("session_approve",o),{})):Or(n)&&(await this.client.session.delete(r,Kt("USER_DISCONNECTED")),this.events.emit(At("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:o,id:c}=n;try{const f=`${r}_session_update`,g=po.get(f);if(g&&this.isRequestOutOfSync(g,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(sr({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:r,result:!0}),this.client.events.emit("session_update",{id:c,topic:r,params:o}),po.set(f,c)}catch(f){await this.sendError(c,r,f),this.client.logger.error(f)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:o}=n;ci(n)?this.events.emit(At("session_update",o),{}):Or(n)&&this.events.emit(At("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:o}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,jr(mo)),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_extend",{id:o,topic:r})}catch(c){await this.sendError(o,r,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(r,n)=>{const{id:o}=n;ci(n)?this.events.emit(At("session_extend",o),{}):Or(n)&&this.events.emit(At("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:o}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_ping",{id:o,topic:r})}catch(c){await this.sendError(o,r,c),this.client.logger.error(c)}},this.onSessionPingResponse=(r,n)=>{const{id:o}=n;setTimeout(()=>{ci(n)?this.events.emit(At("session_ping",o),{}):Or(n)&&this.events.emit(At("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Vt.publish,async()=>{c(await this.deleteSession(r))})}),this.sendResult({id:o,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(r,n)=>{const{id:o,params:c}=n;try{this.isValidRequest(sr({topic:r},c));const f=_n(JSON.stringify(Bi("wc_sessionRequest",c,o))),g=this.client.session.get(r),m=await this.getVerifyContext(f,g.peer.metadata),p={id:o,topic:r,params:c,verifyContext:m};await this.setPendingSessionRequest(p),this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue()}catch(f){await this.sendError(o,r,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(r,n)=>{const{id:o}=n;ci(n)?this.events.emit(At("session_request",o),{result:n.result}):Or(n)&&this.events.emit(At("session_request",o),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:o,params:c}=n;try{const f=`${r}_session_event_${c.event.name}`,g=po.get(f);if(g&&this.isRequestOutOfSync(g,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(sr({topic:r},c)),this.client.events.emit("session_event",{id:o,topic:r,params:c}),po.set(f,o)}catch(f){await this.sendError(o,r,f),this.client.logger.error(f)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ai.idle,this.processSessionRequestQueue()},te.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ai.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ai.active,this.client.events.emit("session_request",r)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=r=>{if(r.active)return;const n=this.client.proposal.getAll().find(o=>o.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,Bi("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id))},this.isValidConnect=async r=>{if(!ar(r)){const{message:m}=G("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(m)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:f,relays:g}=r;if(Ei(n)||await this.isValidPairingTopic(n),!h1(g,!0)){const{message:m}=G("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(m)}!Ei(o)&&Eo(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!Ei(c)&&Eo(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),Ei(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(r,n)=>{const o=l1(r,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!ar(r))throw new Error(G("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:o,relayProtocol:c,sessionProperties:f}=r;await this.isValidProposalId(n);const g=this.client.proposal.get(n),m=uc(o,"approve()");if(m)throw new Error(m.message);const p=il(g.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!mn(c,!0)){const{message:b}=G("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(b)}Ei(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async r=>{if(!ar(r)){const{message:c}=G("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(c)}const{id:n,reason:o}=r;if(await this.isValidProposalId(n),!f1(o)){const{message:c}=G("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=r=>{if(!ar(r)){const{message:p}=G("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(p)}const{relay:n,controller:o,namespaces:c,expiry:f}=r;if(!p1(n)){const{message:p}=G("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const g=d1(o,"onSessionSettleRequest()");if(g)throw new Error(g.message);const m=uc(c,"onSessionSettleRequest()");if(m)throw new Error(m.message);if(bi(f)){const{message:p}=G("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async r=>{if(!ar(r)){const{message:m}=G("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(m)}const{topic:n,namespaces:o}=r;await this.isValidSessionTopic(n);const c=this.client.session.get(n),f=uc(o,"update()");if(f)throw new Error(f.message);const g=il(c.requiredNamespaces,o,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async r=>{if(!ar(r)){const{message:o}=G("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!ar(r)){const{message:m}=G("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(m)}const{topic:n,request:o,chainId:c,expiry:f}=r;await this.isValidSessionTopic(n);const{namespaces:g}=this.client.session.get(n);if(!nl(g,c)){const{message:m}=G("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(m)}if(!g1(o)){const{message:m}=G("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(m)}if(!y1(g,c,o.method)){const{message:m}=G("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(m)}if(f&&!v1(f,_c)){const{message:m}=G("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${_c.min} and ${_c.max}`);throw new Error(m)}},this.isValidRespond=async r=>{var n;if(!ar(r)){const{message:f}=G("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(f)}const{topic:o,response:c}=r;try{await this.isValidSessionTopic(o)}catch(f){throw(n=r==null?void 0:r.response)!=null&&n.id&&this.cleanupAfterResponse(r),f}if(!m1(c)){const{message:f}=G("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(c)}`);throw new Error(f)}},this.isValidPing=async r=>{if(!ar(r)){const{message:o}=G("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!ar(r)){const{message:g}=G("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(g)}const{topic:n,event:o,chainId:c}=r;await this.isValidSessionTopic(n);const{namespaces:f}=this.client.session.get(n);if(!nl(f,c)){const{message:g}=G("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(g)}if(!w1(o)){const{message:g}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(g)}if(!_1(f,c,o.name)){const{message:g}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(g)}},this.isValidDisconnect=async r=>{if(!ar(r)){const{message:o}=G("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const o={verified:{verifyUrl:n.verifyUrl||wn,validation:"UNKNOWN",origin:n.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(o=>{if(!mn(o,!1)){const{message:c}=G("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Vt.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(r,n);try{Wc(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):as(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.client.core.history.delete(r,o.id)):this.onRelayEventUnknownPayload({topic:r,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Sr.expired,async t=>{const{topic:r,id:n}=gf(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,G("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Qn.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!mn(t,!1)){const{message:r}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(bi(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=G("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!mn(t,!1)){const{message:r}=G("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=G("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(bi(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=G("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(mn(t,!1)){const{message:r}=G("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=G("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!b1(t)){const{message:r}=G("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=G("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(bi(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=G("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class sx extends Lo{constructor(t,r){super(t,r,WI,Yc),this.core=t,this.logger=r}}class ox extends Lo{constructor(t,r){super(t,r,JI,Yc),this.core=t,this.logger=r}}class ax extends Lo{constructor(t,r){super(t,r,YI,Yc,n=>n.id),this.core=t,this.logger=r}}let cx=class ip extends u_{constructor(t){super(t),this.protocol=Xf,this.version=ep,this.name=wc.name,this.events=new yr.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(t==null?void 0:t.name)||wc.name,this.metadata=(t==null?void 0:t.metadata)||s1();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:No(Do({level:(t==null?void 0:t.logger)||wc.logger}));this.core=(t==null?void 0:t.core)||new GI(t),this.logger=ur(r,this.name),this.session=new ox(this.core,this.logger),this.proposal=new sx(this.core,this.logger),this.pendingRequest=new ax(this.core,this.logger),this.engine=new nx(this)}static async init(t){const r=new ip(t);return await r.initialize(),r}get context(){return cr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var Lc={exports:{}};(function(a,t){var r=typeof self<"u"?self:qr,n=function(){function c(){this.fetch=!1,this.DOMException=r.DOMException}return c.prototype=r,new c}();(function(c){(function(f){var g={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function m(_){return _&&DataView.prototype.isPrototypeOf(_)}if(g.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=ArrayBuffer.isView||function(_){return _&&p.indexOf(Object.prototype.toString.call(_))>-1};function x(_){if(typeof _!="string"&&(_=String(_)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(_))throw new TypeError("Invalid character in header field name");return _.toLowerCase()}function A(_){return typeof _!="string"&&(_=String(_)),_}function D(_){var O={next:function(){var Q=_.shift();return{done:Q===void 0,value:Q}}};return g.iterable&&(O[Symbol.iterator]=function(){return O}),O}function C(_){this.map={},_ instanceof C?_.forEach(function(O,Q){this.append(Q,O)},this):Array.isArray(_)?_.forEach(function(O){this.append(O[0],O[1])},this):_&&Object.getOwnPropertyNames(_).forEach(function(O){this.append(O,_[O])},this)}C.prototype.append=function(_,O){_=x(_),O=A(O);var Q=this.map[_];this.map[_]=Q?Q+", "+O:O},C.prototype.delete=function(_){delete this.map[x(_)]},C.prototype.get=function(_){return _=x(_),this.has(_)?this.map[_]:null},C.prototype.has=function(_){return this.map.hasOwnProperty(x(_))},C.prototype.set=function(_,O){this.map[x(_)]=A(O)},C.prototype.forEach=function(_,O){for(var Q in this.map)this.map.hasOwnProperty(Q)&&_.call(O,this.map[Q],Q,this)},C.prototype.keys=function(){var _=[];return this.forEach(function(O,Q){_.push(Q)}),D(_)},C.prototype.values=function(){var _=[];return this.forEach(function(O){_.push(O)}),D(_)},C.prototype.entries=function(){var _=[];return this.forEach(function(O,Q){_.push([Q,O])}),D(_)},g.iterable&&(C.prototype[Symbol.iterator]=C.prototype.entries);function J(_){if(_.bodyUsed)return Promise.reject(new TypeError("Already read"));_.bodyUsed=!0}function re(_){return new Promise(function(O,Q){_.onload=function(){O(_.result)},_.onerror=function(){Q(_.error)}})}function oe(_){var O=new FileReader,Q=re(O);return O.readAsArrayBuffer(_),Q}function ce(_){var O=new FileReader,Q=re(O);return O.readAsText(_),Q}function ae(_){for(var O=new Uint8Array(_),Q=new Array(O.length),le=0;le<O.length;le++)Q[le]=String.fromCharCode(O[le]);return Q.join("")}function ee(_){if(_.slice)return _.slice(0);var O=new Uint8Array(_.byteLength);return O.set(new Uint8Array(_)),O.buffer}function he(){return this.bodyUsed=!1,this._initBody=function(_){this._bodyInit=_,_?typeof _=="string"?this._bodyText=_:g.blob&&Blob.prototype.isPrototypeOf(_)?this._bodyBlob=_:g.formData&&FormData.prototype.isPrototypeOf(_)?this._bodyFormData=_:g.searchParams&&URLSearchParams.prototype.isPrototypeOf(_)?this._bodyText=_.toString():g.arrayBuffer&&g.blob&&m(_)?(this._bodyArrayBuffer=ee(_.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):g.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(_)||b(_))?this._bodyArrayBuffer=ee(_):this._bodyText=_=Object.prototype.toString.call(_):this._bodyText="",this.headers.get("content-type")||(typeof _=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(_)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var _=J(this);if(_)return _;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?J(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(oe)}),this.text=function(){var _=J(this);if(_)return _;if(this._bodyBlob)return ce(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(ae(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(wt)}),this.json=function(){return this.text().then(JSON.parse)},this}var pe=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Y(_){var O=_.toUpperCase();return pe.indexOf(O)>-1?O:_}function ve(_,O){O=O||{};var Q=O.body;if(_ instanceof ve){if(_.bodyUsed)throw new TypeError("Already read");this.url=_.url,this.credentials=_.credentials,O.headers||(this.headers=new C(_.headers)),this.method=_.method,this.mode=_.mode,this.signal=_.signal,!Q&&_._bodyInit!=null&&(Q=_._bodyInit,_.bodyUsed=!0)}else this.url=String(_);if(this.credentials=O.credentials||this.credentials||"same-origin",(O.headers||!this.headers)&&(this.headers=new C(O.headers)),this.method=Y(O.method||this.method||"GET"),this.mode=O.mode||this.mode||null,this.signal=O.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Q)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Q)}ve.prototype.clone=function(){return new ve(this,{body:this._bodyInit})};function wt(_){var O=new FormData;return _.trim().split("&").forEach(function(Q){if(Q){var le=Q.split("="),H=le.shift().replace(/\+/g," "),U=le.join("=").replace(/\+/g," ");O.append(decodeURIComponent(H),decodeURIComponent(U))}}),O}function nt(_){var O=new C,Q=_.replace(/\r?\n[\t ]+/g," ");return Q.split(/\r?\n/).forEach(function(le){var H=le.split(":"),U=H.shift().trim();if(U){var B=H.join(":").trim();O.append(U,B)}}),O}he.call(ve.prototype);function Be(_,O){O||(O={}),this.type="default",this.status=O.status===void 0?200:O.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in O?O.statusText:"OK",this.headers=new C(O.headers),this.url=O.url||"",this._initBody(_)}he.call(Be.prototype),Be.prototype.clone=function(){return new Be(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new C(this.headers),url:this.url})},Be.error=function(){var _=new Be(null,{status:0,statusText:""});return _.type="error",_};var qt=[301,302,303,307,308];Be.redirect=function(_,O){if(qt.indexOf(O)===-1)throw new RangeError("Invalid status code");return new Be(null,{status:O,headers:{location:_}})},f.DOMException=c.DOMException;try{new f.DOMException}catch{f.DOMException=function(O,Q){this.message=O,this.name=Q;var le=Error(O);this.stack=le.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function Lt(_,O){return new Promise(function(Q,le){var H=new ve(_,O);if(H.signal&&H.signal.aborted)return le(new f.DOMException("Aborted","AbortError"));var U=new XMLHttpRequest;function B(){U.abort()}U.onload=function(){var k={status:U.status,statusText:U.statusText,headers:nt(U.getAllResponseHeaders()||"")};k.url="responseURL"in U?U.responseURL:k.headers.get("X-Request-URL");var Xe="response"in U?U.response:U.responseText;Q(new Be(Xe,k))},U.onerror=function(){le(new TypeError("Network request failed"))},U.ontimeout=function(){le(new TypeError("Network request failed"))},U.onabort=function(){le(new f.DOMException("Aborted","AbortError"))},U.open(H.method,H.url,!0),H.credentials==="include"?U.withCredentials=!0:H.credentials==="omit"&&(U.withCredentials=!1),"responseType"in U&&g.blob&&(U.responseType="blob"),H.headers.forEach(function(k,Xe){U.setRequestHeader(Xe,k)}),H.signal&&(H.signal.addEventListener("abort",B),U.onreadystatechange=function(){U.readyState===4&&H.signal.removeEventListener("abort",B)}),U.send(typeof H._bodyInit>"u"?null:H._bodyInit)})}return Lt.polyfill=!0,c.fetch||(c.fetch=Lt,c.Headers=C,c.Request=ve,c.Response=Be),f.Headers=C,f.Request=ve,f.Response=Be,f.fetch=Lt,Object.defineProperty(f,"__esModule",{value:!0}),f})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;t=o.fetch,t.default=o.fetch,t.fetch=o.fetch,t.Headers=o.Headers,t.Request=o.Request,t.Response=o.Response,a.exports=t})(Lc,Lc.exports);var ux=Lc.exports;const Wl=Ao(ux);var hx=Object.defineProperty,lx=Object.defineProperties,fx=Object.getOwnPropertyDescriptors,Jl=Object.getOwnPropertySymbols,px=Object.prototype.hasOwnProperty,dx=Object.prototype.propertyIsEnumerable,Ql=(a,t,r)=>t in a?hx(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Yl=(a,t)=>{for(var r in t||(t={}))px.call(t,r)&&Ql(a,r,t[r]);if(Jl)for(var r of Jl(t))dx.call(t,r)&&Ql(a,r,t[r]);return a},Zl=(a,t)=>lx(a,fx(t));const gx={Accept:"application/json","Content-Type":"application/json"},yx="POST",Xl={headers:gx,method:yx},ef=10;let Pi=class{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new yr.EventEmitter,this.isAvailable=!1,this.registering=!1,!El(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t){this.isAvailable||await this.register();try{const r=ki(t),n=await(await Wl(this.url,Zl(Yl({},Xl),{body:r}))).json();this.onPayload({data:n})}catch(r){this.onError(t.id,r)}}async register(t=this.url){if(!El(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=ki({id:1,jsonrpc:"2.0",method:"test",params:[]});await Wl(t,Zl(Yl({},Xl),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ss(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),o=n.message||n.toString(),c=jo(t,o);this.events.emit("payload",c)}parseError(t,r=this.url){return Nf(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>ef&&this.events.setMaxListeners(ef)}};class Si extends jf{constructor(t){super(t),this.events=new yr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Bi(t.method,t.params||[],t.id||Gc().toString()),r)}async requestStrict(t,r){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${t.id}`,c=>{Or(c)?o(c.error):n(c.result)});try{await this.connection.send(t,r)}catch(c){o(c)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),as(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const tf="error",vx="wss://relay.walletconnect.com",mx="wc",wx="universal_provider",rf=`${mx}@2:${wx}:`,_x="https://rpc.walletconnect.com/v1/",ui={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Wn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Mc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,t){(function(){var r,n="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",g="Invalid `variable` option passed into `_.template`",m="__lodash_hash_undefined__",p=500,b="__lodash_placeholder__",x=1,A=2,D=4,C=1,J=2,re=1,oe=2,ce=4,ae=8,ee=16,he=32,pe=64,Y=128,ve=256,wt=512,nt=30,Be="...",qt=800,Lt=16,_=1,O=2,Q=3,le=1/0,H=9007199254740991,U=17976931348623157e292,B=0/0,k=4294967295,Xe=k-1,st=k>>>1,Oi=[["ary",Y],["bind",re],["bindKey",oe],["curry",ae],["curryRight",ee],["flip",wt],["partial",he],["partialRight",pe],["rearg",ve]],Ee="[object Arguments]",Rr="[object Array]",F="[object AsyncFunction]",N="[object Boolean]",T="[object Date]",h="[object DOMException]",I="[object Error]",Z="[object Function]",ue="[object GeneratorFunction]",me="[object Map]",Oe="[object Number]",Ae="[object Null]",Ie="[object Object]",_t="[object Promise]",dt="[object Proxy]",et="[object RegExp]",Te="[object Set]",ke="[object String]",Ke="[object Symbol]",tt="[object Undefined]",Fe="[object WeakMap]",Ve="[object WeakSet]",Re="[object ArrayBuffer]",qe="[object DataView]",ot="[object Float32Array]",Ne="[object Float64Array]",bt="[object Int8Array]",Ct="[object Int16Array]",Mt="[object Int32Array]",zt="[object Uint8Array]",Nt="[object Uint8ClampedArray]",Gt="[object Uint16Array]",Xt="[object Uint32Array]",Lr=/\b__p \+= '';/g,Wt=/\b(__p \+=) '' \+/g,Vr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,hi=/&(?:amp|lt|gt|quot|#39);/g,Ri=/[&<>"']/g,at=RegExp(hi.source),Je=RegExp(Ri.source),ct=/<%-([\s\S]+?)%>/g,ut=/<%([\s\S]+?)%>/g,rt=/<%=([\s\S]+?)%>/g,Qe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Et=/^\w*$/,It=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ht=/[\\^$.*+?()[\]{}|]/g,xt=RegExp(ht.source),lt=/^\s+/,gt=/\s/,ft=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,He=/\{\n\/\* \[wrapped with (.+)\] \*/,Pt=/,? & /,St=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Mo=/[()=,{}\[\]\/\s]/,zo=/\\(\\)?/g,Uo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,vr=/\w*$/,Ho=/^[-+]0x[0-9a-f]+$/i,Bo=/^0b[01]+$/i,ko=/^\[object .+?Constructor\]$/,Ko=/^0o[0-7]+$/i,Vo=/^(?:0|[1-9]\d*)$/,Gr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wi=/($^)/,Go=/['\n\r\u2028\u2029\\]/g,Ji="\\ud800-\\udfff",Wo="\\u0300-\\u036f",Jo="\\ufe20-\\ufe2f",Qi="\\u20d0-\\u20ff",us=Wo+Jo+Qi,hs="\\u2700-\\u27bf",Ar="a-z\\xdf-\\xf6\\xf8-\\xff",Qo="\\xac\\xb1\\xd7\\xf7",Yo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Zo="\\u2000-\\u206f",Xo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ls="A-Z\\xc0-\\xd6\\xd8-\\xde",fs="\\ufe0e\\ufe0f",Ai=Qo+Yo+Zo+Xo,In="['’]",Ci="["+Ji+"]",xn="["+Ai+"]",Ti="["+us+"]",ps="\\d+",ea="["+hs+"]",ds="["+Ar+"]",gs="[^"+Ji+Ai+ps+hs+Ar+ls+"]",Yi="\\ud83c[\\udffb-\\udfff]",ta="(?:"+Ti+"|"+Yi+")",ys="[^"+Ji+"]",Zi="(?:\\ud83c[\\udde6-\\uddff]){2}",li="[\\ud800-\\udbff][\\udc00-\\udfff]",hr="["+ls+"]",vs="\\u200d",ms="(?:"+ds+"|"+gs+")",Mr="(?:"+hr+"|"+gs+")",ws="(?:"+In+"(?:d|ll|m|re|s|t|ve))?",_s="(?:"+In+"(?:D|LL|M|RE|S|T|VE))?",bs=ta+"?",Es="["+fs+"]?",ra="(?:"+vs+"(?:"+[ys,Zi,li].join("|")+")"+Es+bs+")*",Wr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Is="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",xs=Es+bs+ra,Xi="(?:"+[ea,Zi,li].join("|")+")"+xs,ia="(?:"+[ys+Ti+"?",Ti,Zi,li,Ci].join("|")+")",Pn=RegExp(In,"g"),na=RegExp(Ti,"g"),en=RegExp(Yi+"(?="+Yi+")|"+ia+xs,"g"),Ps=RegExp([hr+"?"+ds+"+"+ws+"(?="+[xn,hr,"$"].join("|")+")",Mr+"+"+_s+"(?="+[xn,hr+ms,"$"].join("|")+")",hr+"?"+ms+"+"+ws,hr+"+"+_s,Is,Wr,ps,Xi].join("|"),"g"),Ss=RegExp("["+vs+Ji+us+fs+"]"),$i=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Os=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],sa=-1,Le={};Le[ot]=Le[Ne]=Le[bt]=Le[Ct]=Le[Mt]=Le[zt]=Le[Nt]=Le[Gt]=Le[Xt]=!0,Le[Ee]=Le[Rr]=Le[Re]=Le[N]=Le[qe]=Le[T]=Le[I]=Le[Z]=Le[me]=Le[Oe]=Le[Ie]=Le[et]=Le[Te]=Le[ke]=Le[Fe]=!1;var je={};je[Ee]=je[Rr]=je[Re]=je[qe]=je[N]=je[T]=je[ot]=je[Ne]=je[bt]=je[Ct]=je[Mt]=je[me]=je[Oe]=je[Ie]=je[et]=je[Te]=je[ke]=je[Ke]=je[zt]=je[Nt]=je[Gt]=je[Xt]=!0,je[I]=je[Z]=je[Fe]=!1;var v={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},M={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},V={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Me=parseFloat,de=parseInt,Ge=typeof Wn=="object"&&Wn&&Wn.Object===Object&&Wn,Ot=typeof self=="object"&&self&&self.Object===Object&&self,Pe=Ge||Ot||Function("return this")(),ze=t&&!t.nodeType&&t,yt=ze&&!0&&a&&!a.nodeType&&a,er=yt&&yt.exports===ze,Rt=er&&Ge.process,We=function(){try{var S=yt&&yt.require&&yt.require("util").types;return S||Rt&&Rt.binding&&Rt.binding("util")}catch{}}(),Jt=We&&We.isArrayBuffer,Cr=We&&We.isDate,mr=We&&We.isMap,zr=We&&We.isRegExp,Sn=We&&We.isSet,Ni=We&&We.isTypedArray;function Dt(S,j,$){switch($.length){case 0:return S.call(j);case 1:return S.call(j,$[0]);case 2:return S.call(j,$[0],$[1]);case 3:return S.call(j,$[0],$[1],$[2])}return S.apply(j,$)}function op(S,j,$,W){for(var fe=-1,Ce=S==null?0:S.length;++fe<Ce;){var Tt=S[fe];j(W,Tt,$(Tt),S)}return W}function wr(S,j){for(var $=-1,W=S==null?0:S.length;++$<W&&j(S[$],$,S)!==!1;);return S}function ap(S,j){for(var $=S==null?0:S.length;$--&&j(S[$],$,S)!==!1;);return S}function eu(S,j){for(var $=-1,W=S==null?0:S.length;++$<W;)if(!j(S[$],$,S))return!1;return!0}function fi(S,j){for(var $=-1,W=S==null?0:S.length,fe=0,Ce=[];++$<W;){var Tt=S[$];j(Tt,$,S)&&(Ce[fe++]=Tt)}return Ce}function Rs(S,j){var $=S==null?0:S.length;return!!$&&tn(S,j,0)>-1}function oa(S,j,$){for(var W=-1,fe=S==null?0:S.length;++W<fe;)if($(j,S[W]))return!0;return!1}function Ye(S,j){for(var $=-1,W=S==null?0:S.length,fe=Array(W);++$<W;)fe[$]=j(S[$],$,S);return fe}function pi(S,j){for(var $=-1,W=j.length,fe=S.length;++$<W;)S[fe+$]=j[$];return S}function aa(S,j,$,W){var fe=-1,Ce=S==null?0:S.length;for(W&&Ce&&($=S[++fe]);++fe<Ce;)$=j($,S[fe],fe,S);return $}function cp(S,j,$,W){var fe=S==null?0:S.length;for(W&&fe&&($=S[--fe]);fe--;)$=j($,S[fe],fe,S);return $}function ca(S,j){for(var $=-1,W=S==null?0:S.length;++$<W;)if(j(S[$],$,S))return!0;return!1}var up=ua("length");function hp(S){return S.split("")}function lp(S){return S.match(St)||[]}function tu(S,j,$){var W;return $(S,function(fe,Ce,Tt){if(j(fe,Ce,Tt))return W=Ce,!1}),W}function As(S,j,$,W){for(var fe=S.length,Ce=$+(W?1:-1);W?Ce--:++Ce<fe;)if(j(S[Ce],Ce,S))return Ce;return-1}function tn(S,j,$){return j===j?Ip(S,j,$):As(S,ru,$)}function fp(S,j,$,W){for(var fe=$-1,Ce=S.length;++fe<Ce;)if(W(S[fe],j))return fe;return-1}function ru(S){return S!==S}function iu(S,j){var $=S==null?0:S.length;return $?la(S,j)/$:B}function ua(S){return function(j){return j==null?r:j[S]}}function ha(S){return function(j){return S==null?r:S[j]}}function nu(S,j,$,W,fe){return fe(S,function(Ce,Tt,Ue){$=W?(W=!1,Ce):j($,Ce,Tt,Ue)}),$}function pp(S,j){var $=S.length;for(S.sort(j);$--;)S[$]=S[$].value;return S}function la(S,j){for(var $,W=-1,fe=S.length;++W<fe;){var Ce=j(S[W]);Ce!==r&&($=$===r?Ce:$+Ce)}return $}function fa(S,j){for(var $=-1,W=Array(S);++$<S;)W[$]=j($);return W}function dp(S,j){return Ye(j,function($){return[$,S[$]]})}function su(S){return S&&S.slice(0,uu(S)+1).replace(lt,"")}function lr(S){return function(j){return S(j)}}function pa(S,j){return Ye(j,function($){return S[$]})}function On(S,j){return S.has(j)}function ou(S,j){for(var $=-1,W=S.length;++$<W&&tn(j,S[$],0)>-1;);return $}function au(S,j){for(var $=S.length;$--&&tn(j,S[$],0)>-1;);return $}function gp(S,j){for(var $=S.length,W=0;$--;)S[$]===j&&++W;return W}var yp=ha(v),vp=ha(P);function mp(S){return"\\"+V[S]}function wp(S,j){return S==null?r:S[j]}function rn(S){return Ss.test(S)}function _p(S){return $i.test(S)}function bp(S){for(var j,$=[];!(j=S.next()).done;)$.push(j.value);return $}function da(S){var j=-1,$=Array(S.size);return S.forEach(function(W,fe){$[++j]=[fe,W]}),$}function cu(S,j){return function($){return S(j($))}}function di(S,j){for(var $=-1,W=S.length,fe=0,Ce=[];++$<W;){var Tt=S[$];(Tt===j||Tt===b)&&(S[$]=b,Ce[fe++]=$)}return Ce}function Cs(S){var j=-1,$=Array(S.size);return S.forEach(function(W){$[++j]=W}),$}function Ep(S){var j=-1,$=Array(S.size);return S.forEach(function(W){$[++j]=[W,W]}),$}function Ip(S,j,$){for(var W=$-1,fe=S.length;++W<fe;)if(S[W]===j)return W;return-1}function xp(S,j,$){for(var W=$+1;W--;)if(S[W]===j)return W;return W}function nn(S){return rn(S)?Sp(S):up(S)}function Tr(S){return rn(S)?Op(S):hp(S)}function uu(S){for(var j=S.length;j--&&gt.test(S.charAt(j)););return j}var Pp=ha(M);function Sp(S){for(var j=en.lastIndex=0;en.test(S);)++j;return j}function Op(S){return S.match(en)||[]}function Rp(S){return S.match(Ps)||[]}var Ap=function S(j){j=j==null?Pe:sn.defaults(Pe.Object(),j,sn.pick(Pe,Os));var $=j.Array,W=j.Date,fe=j.Error,Ce=j.Function,Tt=j.Math,Ue=j.Object,ga=j.RegExp,Cp=j.String,_r=j.TypeError,Ts=$.prototype,Tp=Ce.prototype,on=Ue.prototype,$s=j["__core-js_shared__"],Ns=Tp.toString,De=on.hasOwnProperty,$p=0,hu=function(){var e=/[^.]+$/.exec($s&&$s.keys&&$s.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ds=on.toString,Np=Ns.call(Ue),Dp=Pe._,Fp=ga("^"+Ns.call(De).replace(ht,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fs=er?j.Buffer:r,gi=j.Symbol,js=j.Uint8Array,lu=Fs?Fs.allocUnsafe:r,qs=cu(Ue.getPrototypeOf,Ue),fu=Ue.create,pu=on.propertyIsEnumerable,Ls=Ts.splice,du=gi?gi.isConcatSpreadable:r,Rn=gi?gi.iterator:r,Di=gi?gi.toStringTag:r,Ms=function(){try{var e=Mi(Ue,"defineProperty");return e({},"",{}),e}catch{}}(),jp=j.clearTimeout!==Pe.clearTimeout&&j.clearTimeout,qp=W&&W.now!==Pe.Date.now&&W.now,Lp=j.setTimeout!==Pe.setTimeout&&j.setTimeout,zs=Tt.ceil,Us=Tt.floor,ya=Ue.getOwnPropertySymbols,Mp=Fs?Fs.isBuffer:r,gu=j.isFinite,zp=Ts.join,Up=cu(Ue.keys,Ue),$t=Tt.max,Bt=Tt.min,Hp=W.now,Bp=j.parseInt,yu=Tt.random,kp=Ts.reverse,va=Mi(j,"DataView"),An=Mi(j,"Map"),ma=Mi(j,"Promise"),an=Mi(j,"Set"),Cn=Mi(j,"WeakMap"),Tn=Mi(Ue,"create"),Hs=Cn&&new Cn,cn={},Kp=zi(va),Vp=zi(An),Gp=zi(ma),Wp=zi(an),Jp=zi(Cn),Bs=gi?gi.prototype:r,$n=Bs?Bs.valueOf:r,vu=Bs?Bs.toString:r;function d(e){if(pt(e)&&!ge(e)&&!(e instanceof xe)){if(e instanceof br)return e;if(De.call(e,"__wrapped__"))return mh(e)}return new br(e)}var un=function(){function e(){}return function(i){if(!it(i))return{};if(fu)return fu(i);e.prototype=i;var s=new e;return e.prototype=r,s}}();function ks(){}function br(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}d.templateSettings={escape:ct,evaluate:ut,interpolate:rt,variable:"",imports:{_:d}},d.prototype=ks.prototype,d.prototype.constructor=d,br.prototype=un(ks.prototype),br.prototype.constructor=br;function xe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=k,this.__views__=[]}function Qp(){var e=new xe(this.__wrapped__);return e.__actions__=tr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=tr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=tr(this.__views__),e}function Yp(){if(this.__filtered__){var e=new xe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Zp(){var e=this.__wrapped__.value(),i=this.__dir__,s=ge(e),u=i<0,l=s?e.length:0,y=hg(0,l,this.__views__),w=y.start,E=y.end,R=E-w,q=u?E:w-1,L=this.__iteratees__,z=L.length,K=0,X=Bt(R,this.__takeCount__);if(!s||!u&&l==R&&X==R)return Uu(e,this.__actions__);var ne=[];e:for(;R--&&K<X;){q+=i;for(var we=-1,se=e[q];++we<z;){var be=L[we],Se=be.iteratee,dr=be.type,Zt=Se(se);if(dr==O)se=Zt;else if(!Zt){if(dr==_)continue e;break e}}ne[K++]=se}return ne}xe.prototype=un(ks.prototype),xe.prototype.constructor=xe;function Fi(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var u=e[i];this.set(u[0],u[1])}}function Xp(){this.__data__=Tn?Tn(null):{},this.size=0}function ed(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function td(e){var i=this.__data__;if(Tn){var s=i[e];return s===m?r:s}return De.call(i,e)?i[e]:r}function rd(e){var i=this.__data__;return Tn?i[e]!==r:De.call(i,e)}function id(e,i){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Tn&&i===r?m:i,this}Fi.prototype.clear=Xp,Fi.prototype.delete=ed,Fi.prototype.get=td,Fi.prototype.has=rd,Fi.prototype.set=id;function Jr(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var u=e[i];this.set(u[0],u[1])}}function nd(){this.__data__=[],this.size=0}function sd(e){var i=this.__data__,s=Ks(i,e);if(s<0)return!1;var u=i.length-1;return s==u?i.pop():Ls.call(i,s,1),--this.size,!0}function od(e){var i=this.__data__,s=Ks(i,e);return s<0?r:i[s][1]}function ad(e){return Ks(this.__data__,e)>-1}function cd(e,i){var s=this.__data__,u=Ks(s,e);return u<0?(++this.size,s.push([e,i])):s[u][1]=i,this}Jr.prototype.clear=nd,Jr.prototype.delete=sd,Jr.prototype.get=od,Jr.prototype.has=ad,Jr.prototype.set=cd;function Qr(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var u=e[i];this.set(u[0],u[1])}}function ud(){this.size=0,this.__data__={hash:new Fi,map:new(An||Jr),string:new Fi}}function hd(e){var i=io(this,e).delete(e);return this.size-=i?1:0,i}function ld(e){return io(this,e).get(e)}function fd(e){return io(this,e).has(e)}function pd(e,i){var s=io(this,e),u=s.size;return s.set(e,i),this.size+=s.size==u?0:1,this}Qr.prototype.clear=ud,Qr.prototype.delete=hd,Qr.prototype.get=ld,Qr.prototype.has=fd,Qr.prototype.set=pd;function ji(e){var i=-1,s=e==null?0:e.length;for(this.__data__=new Qr;++i<s;)this.add(e[i])}function dd(e){return this.__data__.set(e,m),this}function gd(e){return this.__data__.has(e)}ji.prototype.add=ji.prototype.push=dd,ji.prototype.has=gd;function $r(e){var i=this.__data__=new Jr(e);this.size=i.size}function yd(){this.__data__=new Jr,this.size=0}function vd(e){var i=this.__data__,s=i.delete(e);return this.size=i.size,s}function md(e){return this.__data__.get(e)}function wd(e){return this.__data__.has(e)}function _d(e,i){var s=this.__data__;if(s instanceof Jr){var u=s.__data__;if(!An||u.length<o-1)return u.push([e,i]),this.size=++s.size,this;s=this.__data__=new Qr(u)}return s.set(e,i),this.size=s.size,this}$r.prototype.clear=yd,$r.prototype.delete=vd,$r.prototype.get=md,$r.prototype.has=wd,$r.prototype.set=_d;function mu(e,i){var s=ge(e),u=!s&&Ui(e),l=!s&&!u&&_i(e),y=!s&&!u&&!l&&pn(e),w=s||u||l||y,E=w?fa(e.length,Cp):[],R=E.length;for(var q in e)(i||De.call(e,q))&&!(w&&(q=="length"||l&&(q=="offset"||q=="parent")||y&&(q=="buffer"||q=="byteLength"||q=="byteOffset")||ei(q,R)))&&E.push(q);return E}function wu(e){var i=e.length;return i?e[Aa(0,i-1)]:r}function bd(e,i){return no(tr(e),qi(i,0,e.length))}function Ed(e){return no(tr(e))}function wa(e,i,s){(s!==r&&!Nr(e[i],s)||s===r&&!(i in e))&&Yr(e,i,s)}function Nn(e,i,s){var u=e[i];(!(De.call(e,i)&&Nr(u,s))||s===r&&!(i in e))&&Yr(e,i,s)}function Ks(e,i){for(var s=e.length;s--;)if(Nr(e[s][0],i))return s;return-1}function Id(e,i,s,u){return yi(e,function(l,y,w){i(u,l,s(l),w)}),u}function _u(e,i){return e&&Hr(i,Ft(i),e)}function xd(e,i){return e&&Hr(i,ir(i),e)}function Yr(e,i,s){i=="__proto__"&&Ms?Ms(e,i,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[i]=s}function _a(e,i){for(var s=-1,u=i.length,l=$(u),y=e==null;++s<u;)l[s]=y?r:ec(e,i[s]);return l}function qi(e,i,s){return e===e&&(s!==r&&(e=e<=s?e:s),i!==r&&(e=e>=i?e:i)),e}function Er(e,i,s,u,l,y){var w,E=i&x,R=i&A,q=i&D;if(s&&(w=l?s(e,u,l,y):s(e)),w!==r)return w;if(!it(e))return e;var L=ge(e);if(L){if(w=fg(e),!E)return tr(e,w)}else{var z=kt(e),K=z==Z||z==ue;if(_i(e))return ku(e,E);if(z==Ie||z==Ee||K&&!l){if(w=R||K?{}:uh(e),!E)return R?tg(e,xd(w,e)):eg(e,_u(w,e))}else{if(!je[z])return l?e:{};w=pg(e,z,E)}}y||(y=new $r);var X=y.get(e);if(X)return X;y.set(e,w),Lh(e)?e.forEach(function(se){w.add(Er(se,i,s,se,e,y))}):jh(e)&&e.forEach(function(se,be){w.set(be,Er(se,i,s,be,e,y))});var ne=q?R?za:Ma:R?ir:Ft,we=L?r:ne(e);return wr(we||e,function(se,be){we&&(be=se,se=e[be]),Nn(w,be,Er(se,i,s,be,e,y))}),w}function Pd(e){var i=Ft(e);return function(s){return bu(s,e,i)}}function bu(e,i,s){var u=s.length;if(e==null)return!u;for(e=Ue(e);u--;){var l=s[u],y=i[l],w=e[l];if(w===r&&!(l in e)||!y(w))return!1}return!0}function Eu(e,i,s){if(typeof e!="function")throw new _r(f);return zn(function(){e.apply(r,s)},i)}function Dn(e,i,s,u){var l=-1,y=Rs,w=!0,E=e.length,R=[],q=i.length;if(!E)return R;s&&(i=Ye(i,lr(s))),u?(y=oa,w=!1):i.length>=o&&(y=On,w=!1,i=new ji(i));e:for(;++l<E;){var L=e[l],z=s==null?L:s(L);if(L=u||L!==0?L:0,w&&z===z){for(var K=q;K--;)if(i[K]===z)continue e;R.push(L)}else y(i,z,u)||R.push(L)}return R}var yi=Ju(Ur),Iu=Ju(Ea,!0);function Sd(e,i){var s=!0;return yi(e,function(u,l,y){return s=!!i(u,l,y),s}),s}function Vs(e,i,s){for(var u=-1,l=e.length;++u<l;){var y=e[u],w=i(y);if(w!=null&&(E===r?w===w&&!pr(w):s(w,E)))var E=w,R=y}return R}function Od(e,i,s,u){var l=e.length;for(s=ye(s),s<0&&(s=-s>l?0:l+s),u=u===r||u>l?l:ye(u),u<0&&(u+=l),u=s>u?0:zh(u);s<u;)e[s++]=i;return e}function xu(e,i){var s=[];return yi(e,function(u,l,y){i(u,l,y)&&s.push(u)}),s}function Ut(e,i,s,u,l){var y=-1,w=e.length;for(s||(s=gg),l||(l=[]);++y<w;){var E=e[y];i>0&&s(E)?i>1?Ut(E,i-1,s,u,l):pi(l,E):u||(l[l.length]=E)}return l}var ba=Qu(),Pu=Qu(!0);function Ur(e,i){return e&&ba(e,i,Ft)}function Ea(e,i){return e&&Pu(e,i,Ft)}function Gs(e,i){return fi(i,function(s){return ti(e[s])})}function Li(e,i){i=mi(i,e);for(var s=0,u=i.length;e!=null&&s<u;)e=e[Br(i[s++])];return s&&s==u?e:r}function Su(e,i,s){var u=i(e);return ge(e)?u:pi(u,s(e))}function Qt(e){return e==null?e===r?tt:Ae:Di&&Di in Ue(e)?ug(e):Eg(e)}function Ia(e,i){return e>i}function Rd(e,i){return e!=null&&De.call(e,i)}function Ad(e,i){return e!=null&&i in Ue(e)}function Cd(e,i,s){return e>=Bt(i,s)&&e<$t(i,s)}function xa(e,i,s){for(var u=s?oa:Rs,l=e[0].length,y=e.length,w=y,E=$(y),R=1/0,q=[];w--;){var L=e[w];w&&i&&(L=Ye(L,lr(i))),R=Bt(L.length,R),E[w]=!s&&(i||l>=120&&L.length>=120)?new ji(w&&L):r}L=e[0];var z=-1,K=E[0];e:for(;++z<l&&q.length<R;){var X=L[z],ne=i?i(X):X;if(X=s||X!==0?X:0,!(K?On(K,ne):u(q,ne,s))){for(w=y;--w;){var we=E[w];if(!(we?On(we,ne):u(e[w],ne,s)))continue e}K&&K.push(ne),q.push(X)}}return q}function Td(e,i,s,u){return Ur(e,function(l,y,w){i(u,s(l),y,w)}),u}function Fn(e,i,s){i=mi(i,e),e=ph(e,i);var u=e==null?e:e[Br(xr(i))];return u==null?r:Dt(u,e,s)}function Ou(e){return pt(e)&&Qt(e)==Ee}function $d(e){return pt(e)&&Qt(e)==Re}function Nd(e){return pt(e)&&Qt(e)==T}function jn(e,i,s,u,l){return e===i?!0:e==null||i==null||!pt(e)&&!pt(i)?e!==e&&i!==i:Dd(e,i,s,u,jn,l)}function Dd(e,i,s,u,l,y){var w=ge(e),E=ge(i),R=w?Rr:kt(e),q=E?Rr:kt(i);R=R==Ee?Ie:R,q=q==Ee?Ie:q;var L=R==Ie,z=q==Ie,K=R==q;if(K&&_i(e)){if(!_i(i))return!1;w=!0,L=!1}if(K&&!L)return y||(y=new $r),w||pn(e)?oh(e,i,s,u,l,y):ag(e,i,R,s,u,l,y);if(!(s&C)){var X=L&&De.call(e,"__wrapped__"),ne=z&&De.call(i,"__wrapped__");if(X||ne){var we=X?e.value():e,se=ne?i.value():i;return y||(y=new $r),l(we,se,s,u,y)}}return K?(y||(y=new $r),cg(e,i,s,u,l,y)):!1}function Fd(e){return pt(e)&&kt(e)==me}function Pa(e,i,s,u){var l=s.length,y=l,w=!u;if(e==null)return!y;for(e=Ue(e);l--;){var E=s[l];if(w&&E[2]?E[1]!==e[E[0]]:!(E[0]in e))return!1}for(;++l<y;){E=s[l];var R=E[0],q=e[R],L=E[1];if(w&&E[2]){if(q===r&&!(R in e))return!1}else{var z=new $r;if(u)var K=u(q,L,R,e,i,z);if(!(K===r?jn(L,q,C|J,u,z):K))return!1}}return!0}function Ru(e){if(!it(e)||vg(e))return!1;var i=ti(e)?Fp:ko;return i.test(zi(e))}function jd(e){return pt(e)&&Qt(e)==et}function qd(e){return pt(e)&&kt(e)==Te}function Ld(e){return pt(e)&&ho(e.length)&&!!Le[Qt(e)]}function Au(e){return typeof e=="function"?e:e==null?nr:typeof e=="object"?ge(e)?$u(e[0],e[1]):Tu(e):Yh(e)}function Sa(e){if(!Mn(e))return Up(e);var i=[];for(var s in Ue(e))De.call(e,s)&&s!="constructor"&&i.push(s);return i}function Md(e){if(!it(e))return bg(e);var i=Mn(e),s=[];for(var u in e)u=="constructor"&&(i||!De.call(e,u))||s.push(u);return s}function Oa(e,i){return e<i}function Cu(e,i){var s=-1,u=rr(e)?$(e.length):[];return yi(e,function(l,y,w){u[++s]=i(l,y,w)}),u}function Tu(e){var i=Ha(e);return i.length==1&&i[0][2]?lh(i[0][0],i[0][1]):function(s){return s===e||Pa(s,e,i)}}function $u(e,i){return ka(e)&&hh(i)?lh(Br(e),i):function(s){var u=ec(s,e);return u===r&&u===i?tc(s,e):jn(i,u,C|J)}}function Ws(e,i,s,u,l){e!==i&&ba(i,function(y,w){if(l||(l=new $r),it(y))zd(e,i,w,s,Ws,u,l);else{var E=u?u(Va(e,w),y,w+"",e,i,l):r;E===r&&(E=y),wa(e,w,E)}},ir)}function zd(e,i,s,u,l,y,w){var E=Va(e,s),R=Va(i,s),q=w.get(R);if(q){wa(e,s,q);return}var L=y?y(E,R,s+"",e,i,w):r,z=L===r;if(z){var K=ge(R),X=!K&&_i(R),ne=!K&&!X&&pn(R);L=R,K||X||ne?ge(E)?L=E:vt(E)?L=tr(E):X?(z=!1,L=ku(R,!0)):ne?(z=!1,L=Ku(R,!0)):L=[]:Un(R)||Ui(R)?(L=E,Ui(E)?L=Uh(E):(!it(E)||ti(E))&&(L=uh(R))):z=!1}z&&(w.set(R,L),l(L,R,u,y,w),w.delete(R)),wa(e,s,L)}function Nu(e,i){var s=e.length;if(s)return i+=i<0?s:0,ei(i,s)?e[i]:r}function Du(e,i,s){i.length?i=Ye(i,function(y){return ge(y)?function(w){return Li(w,y.length===1?y[0]:y)}:y}):i=[nr];var u=-1;i=Ye(i,lr(ie()));var l=Cu(e,function(y,w,E){var R=Ye(i,function(q){return q(y)});return{criteria:R,index:++u,value:y}});return pp(l,function(y,w){return Xd(y,w,s)})}function Ud(e,i){return Fu(e,i,function(s,u){return tc(e,u)})}function Fu(e,i,s){for(var u=-1,l=i.length,y={};++u<l;){var w=i[u],E=Li(e,w);s(E,w)&&qn(y,mi(w,e),E)}return y}function Hd(e){return function(i){return Li(i,e)}}function Ra(e,i,s,u){var l=u?fp:tn,y=-1,w=i.length,E=e;for(e===i&&(i=tr(i)),s&&(E=Ye(e,lr(s)));++y<w;)for(var R=0,q=i[y],L=s?s(q):q;(R=l(E,L,R,u))>-1;)E!==e&&Ls.call(E,R,1),Ls.call(e,R,1);return e}function ju(e,i){for(var s=e?i.length:0,u=s-1;s--;){var l=i[s];if(s==u||l!==y){var y=l;ei(l)?Ls.call(e,l,1):$a(e,l)}}return e}function Aa(e,i){return e+Us(yu()*(i-e+1))}function Bd(e,i,s,u){for(var l=-1,y=$t(zs((i-e)/(s||1)),0),w=$(y);y--;)w[u?y:++l]=e,e+=s;return w}function Ca(e,i){var s="";if(!e||i<1||i>H)return s;do i%2&&(s+=e),i=Us(i/2),i&&(e+=e);while(i);return s}function _e(e,i){return Ga(fh(e,i,nr),e+"")}function kd(e){return wu(dn(e))}function Kd(e,i){var s=dn(e);return no(s,qi(i,0,s.length))}function qn(e,i,s,u){if(!it(e))return e;i=mi(i,e);for(var l=-1,y=i.length,w=y-1,E=e;E!=null&&++l<y;){var R=Br(i[l]),q=s;if(R==="__proto__"||R==="constructor"||R==="prototype")return e;if(l!=w){var L=E[R];q=u?u(L,R,E):r,q===r&&(q=it(L)?L:ei(i[l+1])?[]:{})}Nn(E,R,q),E=E[R]}return e}var qu=Hs?function(e,i){return Hs.set(e,i),e}:nr,Vd=Ms?function(e,i){return Ms(e,"toString",{configurable:!0,enumerable:!1,value:ic(i),writable:!0})}:nr;function Gd(e){return no(dn(e))}function Ir(e,i,s){var u=-1,l=e.length;i<0&&(i=-i>l?0:l+i),s=s>l?l:s,s<0&&(s+=l),l=i>s?0:s-i>>>0,i>>>=0;for(var y=$(l);++u<l;)y[u]=e[u+i];return y}function Wd(e,i){var s;return yi(e,function(u,l,y){return s=i(u,l,y),!s}),!!s}function Js(e,i,s){var u=0,l=e==null?u:e.length;if(typeof i=="number"&&i===i&&l<=st){for(;u<l;){var y=u+l>>>1,w=e[y];w!==null&&!pr(w)&&(s?w<=i:w<i)?u=y+1:l=y}return l}return Ta(e,i,nr,s)}function Ta(e,i,s,u){var l=0,y=e==null?0:e.length;if(y===0)return 0;i=s(i);for(var w=i!==i,E=i===null,R=pr(i),q=i===r;l<y;){var L=Us((l+y)/2),z=s(e[L]),K=z!==r,X=z===null,ne=z===z,we=pr(z);if(w)var se=u||ne;else q?se=ne&&(u||K):E?se=ne&&K&&(u||!X):R?se=ne&&K&&!X&&(u||!we):X||we?se=!1:se=u?z<=i:z<i;se?l=L+1:y=L}return Bt(y,Xe)}function Lu(e,i){for(var s=-1,u=e.length,l=0,y=[];++s<u;){var w=e[s],E=i?i(w):w;if(!s||!Nr(E,R)){var R=E;y[l++]=w===0?0:w}}return y}function Mu(e){return typeof e=="number"?e:pr(e)?B:+e}function fr(e){if(typeof e=="string")return e;if(ge(e))return Ye(e,fr)+"";if(pr(e))return vu?vu.call(e):"";var i=e+"";return i=="0"&&1/e==-le?"-0":i}function vi(e,i,s){var u=-1,l=Rs,y=e.length,w=!0,E=[],R=E;if(s)w=!1,l=oa;else if(y>=o){var q=i?null:sg(e);if(q)return Cs(q);w=!1,l=On,R=new ji}else R=i?[]:E;e:for(;++u<y;){var L=e[u],z=i?i(L):L;if(L=s||L!==0?L:0,w&&z===z){for(var K=R.length;K--;)if(R[K]===z)continue e;i&&R.push(z),E.push(L)}else l(R,z,s)||(R!==E&&R.push(z),E.push(L))}return E}function $a(e,i){return i=mi(i,e),e=ph(e,i),e==null||delete e[Br(xr(i))]}function zu(e,i,s,u){return qn(e,i,s(Li(e,i)),u)}function Qs(e,i,s,u){for(var l=e.length,y=u?l:-1;(u?y--:++y<l)&&i(e[y],y,e););return s?Ir(e,u?0:y,u?y+1:l):Ir(e,u?y+1:0,u?l:y)}function Uu(e,i){var s=e;return s instanceof xe&&(s=s.value()),aa(i,function(u,l){return l.func.apply(l.thisArg,pi([u],l.args))},s)}function Na(e,i,s){var u=e.length;if(u<2)return u?vi(e[0]):[];for(var l=-1,y=$(u);++l<u;)for(var w=e[l],E=-1;++E<u;)E!=l&&(y[l]=Dn(y[l]||w,e[E],i,s));return vi(Ut(y,1),i,s)}function Hu(e,i,s){for(var u=-1,l=e.length,y=i.length,w={};++u<l;){var E=u<y?i[u]:r;s(w,e[u],E)}return w}function Da(e){return vt(e)?e:[]}function Fa(e){return typeof e=="function"?e:nr}function mi(e,i){return ge(e)?e:ka(e,i)?[e]:vh($e(e))}var Jd=_e;function wi(e,i,s){var u=e.length;return s=s===r?u:s,!i&&s>=u?e:Ir(e,i,s)}var Bu=jp||function(e){return Pe.clearTimeout(e)};function ku(e,i){if(i)return e.slice();var s=e.length,u=lu?lu(s):new e.constructor(s);return e.copy(u),u}function ja(e){var i=new e.constructor(e.byteLength);return new js(i).set(new js(e)),i}function Qd(e,i){var s=i?ja(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function Yd(e){var i=new e.constructor(e.source,vr.exec(e));return i.lastIndex=e.lastIndex,i}function Zd(e){return $n?Ue($n.call(e)):{}}function Ku(e,i){var s=i?ja(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function Vu(e,i){if(e!==i){var s=e!==r,u=e===null,l=e===e,y=pr(e),w=i!==r,E=i===null,R=i===i,q=pr(i);if(!E&&!q&&!y&&e>i||y&&w&&R&&!E&&!q||u&&w&&R||!s&&R||!l)return 1;if(!u&&!y&&!q&&e<i||q&&s&&l&&!u&&!y||E&&s&&l||!w&&l||!R)return-1}return 0}function Xd(e,i,s){for(var u=-1,l=e.criteria,y=i.criteria,w=l.length,E=s.length;++u<w;){var R=Vu(l[u],y[u]);if(R){if(u>=E)return R;var q=s[u];return R*(q=="desc"?-1:1)}}return e.index-i.index}function Gu(e,i,s,u){for(var l=-1,y=e.length,w=s.length,E=-1,R=i.length,q=$t(y-w,0),L=$(R+q),z=!u;++E<R;)L[E]=i[E];for(;++l<w;)(z||l<y)&&(L[s[l]]=e[l]);for(;q--;)L[E++]=e[l++];return L}function Wu(e,i,s,u){for(var l=-1,y=e.length,w=-1,E=s.length,R=-1,q=i.length,L=$t(y-E,0),z=$(L+q),K=!u;++l<L;)z[l]=e[l];for(var X=l;++R<q;)z[X+R]=i[R];for(;++w<E;)(K||l<y)&&(z[X+s[w]]=e[l++]);return z}function tr(e,i){var s=-1,u=e.length;for(i||(i=$(u));++s<u;)i[s]=e[s];return i}function Hr(e,i,s,u){var l=!s;s||(s={});for(var y=-1,w=i.length;++y<w;){var E=i[y],R=u?u(s[E],e[E],E,s,e):r;R===r&&(R=e[E]),l?Yr(s,E,R):Nn(s,E,R)}return s}function eg(e,i){return Hr(e,Ba(e),i)}function tg(e,i){return Hr(e,ah(e),i)}function Ys(e,i){return function(s,u){var l=ge(s)?op:Id,y=i?i():{};return l(s,e,ie(u,2),y)}}function hn(e){return _e(function(i,s){var u=-1,l=s.length,y=l>1?s[l-1]:r,w=l>2?s[2]:r;for(y=e.length>3&&typeof y=="function"?(l--,y):r,w&&Yt(s[0],s[1],w)&&(y=l<3?r:y,l=1),i=Ue(i);++u<l;){var E=s[u];E&&e(i,E,u,y)}return i})}function Ju(e,i){return function(s,u){if(s==null)return s;if(!rr(s))return e(s,u);for(var l=s.length,y=i?l:-1,w=Ue(s);(i?y--:++y<l)&&u(w[y],y,w)!==!1;);return s}}function Qu(e){return function(i,s,u){for(var l=-1,y=Ue(i),w=u(i),E=w.length;E--;){var R=w[e?E:++l];if(s(y[R],R,y)===!1)break}return i}}function rg(e,i,s){var u=i&re,l=Ln(e);function y(){var w=this&&this!==Pe&&this instanceof y?l:e;return w.apply(u?s:this,arguments)}return y}function Yu(e){return function(i){i=$e(i);var s=rn(i)?Tr(i):r,u=s?s[0]:i.charAt(0),l=s?wi(s,1).join(""):i.slice(1);return u[e]()+l}}function ln(e){return function(i){return aa(Jh(Wh(i).replace(Pn,"")),e,"")}}function Ln(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var s=un(e.prototype),u=e.apply(s,i);return it(u)?u:s}}function ig(e,i,s){var u=Ln(e);function l(){for(var y=arguments.length,w=$(y),E=y,R=fn(l);E--;)w[E]=arguments[E];var q=y<3&&w[0]!==R&&w[y-1]!==R?[]:di(w,R);if(y-=q.length,y<s)return rh(e,i,Zs,l.placeholder,r,w,q,r,r,s-y);var L=this&&this!==Pe&&this instanceof l?u:e;return Dt(L,this,w)}return l}function Zu(e){return function(i,s,u){var l=Ue(i);if(!rr(i)){var y=ie(s,3);i=Ft(i),s=function(E){return y(l[E],E,l)}}var w=e(i,s,u);return w>-1?l[y?i[w]:w]:r}}function Xu(e){return Xr(function(i){var s=i.length,u=s,l=br.prototype.thru;for(e&&i.reverse();u--;){var y=i[u];if(typeof y!="function")throw new _r(f);if(l&&!w&&ro(y)=="wrapper")var w=new br([],!0)}for(u=w?u:s;++u<s;){y=i[u];var E=ro(y),R=E=="wrapper"?Ua(y):r;R&&Ka(R[0])&&R[1]==(Y|ae|he|ve)&&!R[4].length&&R[9]==1?w=w[ro(R[0])].apply(w,R[3]):w=y.length==1&&Ka(y)?w[E]():w.thru(y)}return function(){var q=arguments,L=q[0];if(w&&q.length==1&&ge(L))return w.plant(L).value();for(var z=0,K=s?i[z].apply(this,q):L;++z<s;)K=i[z].call(this,K);return K}})}function Zs(e,i,s,u,l,y,w,E,R,q){var L=i&Y,z=i&re,K=i&oe,X=i&(ae|ee),ne=i&wt,we=K?r:Ln(e);function se(){for(var be=arguments.length,Se=$(be),dr=be;dr--;)Se[dr]=arguments[dr];if(X)var Zt=fn(se),gr=gp(Se,Zt);if(u&&(Se=Gu(Se,u,l,X)),y&&(Se=Wu(Se,y,w,X)),be-=gr,X&&be<q){var mt=di(Se,Zt);return rh(e,i,Zs,se.placeholder,s,Se,mt,E,R,q-be)}var Dr=z?s:this,ii=K?Dr[e]:e;return be=Se.length,E?Se=Ig(Se,E):ne&&be>1&&Se.reverse(),L&&R<be&&(Se.length=R),this&&this!==Pe&&this instanceof se&&(ii=we||Ln(ii)),ii.apply(Dr,Se)}return se}function eh(e,i){return function(s,u){return Td(s,e,i(u),{})}}function Xs(e,i){return function(s,u){var l;if(s===r&&u===r)return i;if(s!==r&&(l=s),u!==r){if(l===r)return u;typeof s=="string"||typeof u=="string"?(s=fr(s),u=fr(u)):(s=Mu(s),u=Mu(u)),l=e(s,u)}return l}}function qa(e){return Xr(function(i){return i=Ye(i,lr(ie())),_e(function(s){var u=this;return e(i,function(l){return Dt(l,u,s)})})})}function eo(e,i){i=i===r?" ":fr(i);var s=i.length;if(s<2)return s?Ca(i,e):i;var u=Ca(i,zs(e/nn(i)));return rn(i)?wi(Tr(u),0,e).join(""):u.slice(0,e)}function ng(e,i,s,u){var l=i&re,y=Ln(e);function w(){for(var E=-1,R=arguments.length,q=-1,L=u.length,z=$(L+R),K=this&&this!==Pe&&this instanceof w?y:e;++q<L;)z[q]=u[q];for(;R--;)z[q++]=arguments[++E];return Dt(K,l?s:this,z)}return w}function th(e){return function(i,s,u){return u&&typeof u!="number"&&Yt(i,s,u)&&(s=u=r),i=ri(i),s===r?(s=i,i=0):s=ri(s),u=u===r?i<s?1:-1:ri(u),Bd(i,s,u,e)}}function to(e){return function(i,s){return typeof i=="string"&&typeof s=="string"||(i=Pr(i),s=Pr(s)),e(i,s)}}function rh(e,i,s,u,l,y,w,E,R,q){var L=i&ae,z=L?w:r,K=L?r:w,X=L?y:r,ne=L?r:y;i|=L?he:pe,i&=~(L?pe:he),i&ce||(i&=~(re|oe));var we=[e,i,l,X,z,ne,K,E,R,q],se=s.apply(r,we);return Ka(e)&&dh(se,we),se.placeholder=u,gh(se,e,i)}function La(e){var i=Tt[e];return function(s,u){if(s=Pr(s),u=u==null?0:Bt(ye(u),292),u&&gu(s)){var l=($e(s)+"e").split("e"),y=i(l[0]+"e"+(+l[1]+u));return l=($e(y)+"e").split("e"),+(l[0]+"e"+(+l[1]-u))}return i(s)}}var sg=an&&1/Cs(new an([,-0]))[1]==le?function(e){return new an(e)}:oc;function ih(e){return function(i){var s=kt(i);return s==me?da(i):s==Te?Ep(i):dp(i,e(i))}}function Zr(e,i,s,u,l,y,w,E){var R=i&oe;if(!R&&typeof e!="function")throw new _r(f);var q=u?u.length:0;if(q||(i&=~(he|pe),u=l=r),w=w===r?w:$t(ye(w),0),E=E===r?E:ye(E),q-=l?l.length:0,i&pe){var L=u,z=l;u=l=r}var K=R?r:Ua(e),X=[e,i,s,u,l,L,z,y,w,E];if(K&&_g(X,K),e=X[0],i=X[1],s=X[2],u=X[3],l=X[4],E=X[9]=X[9]===r?R?0:e.length:$t(X[9]-q,0),!E&&i&(ae|ee)&&(i&=~(ae|ee)),!i||i==re)var ne=rg(e,i,s);else i==ae||i==ee?ne=ig(e,i,E):(i==he||i==(re|he))&&!l.length?ne=ng(e,i,s,u):ne=Zs.apply(r,X);var we=K?qu:dh;return gh(we(ne,X),e,i)}function nh(e,i,s,u){return e===r||Nr(e,on[s])&&!De.call(u,s)?i:e}function sh(e,i,s,u,l,y){return it(e)&&it(i)&&(y.set(i,e),Ws(e,i,r,sh,y),y.delete(i)),e}function og(e){return Un(e)?r:e}function oh(e,i,s,u,l,y){var w=s&C,E=e.length,R=i.length;if(E!=R&&!(w&&R>E))return!1;var q=y.get(e),L=y.get(i);if(q&&L)return q==i&&L==e;var z=-1,K=!0,X=s&J?new ji:r;for(y.set(e,i),y.set(i,e);++z<E;){var ne=e[z],we=i[z];if(u)var se=w?u(we,ne,z,i,e,y):u(ne,we,z,e,i,y);if(se!==r){if(se)continue;K=!1;break}if(X){if(!ca(i,function(be,Se){if(!On(X,Se)&&(ne===be||l(ne,be,s,u,y)))return X.push(Se)})){K=!1;break}}else if(!(ne===we||l(ne,we,s,u,y))){K=!1;break}}return y.delete(e),y.delete(i),K}function ag(e,i,s,u,l,y,w){switch(s){case qe:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Re:return!(e.byteLength!=i.byteLength||!y(new js(e),new js(i)));case N:case T:case Oe:return Nr(+e,+i);case I:return e.name==i.name&&e.message==i.message;case et:case ke:return e==i+"";case me:var E=da;case Te:var R=u&C;if(E||(E=Cs),e.size!=i.size&&!R)return!1;var q=w.get(e);if(q)return q==i;u|=J,w.set(e,i);var L=oh(E(e),E(i),u,l,y,w);return w.delete(e),L;case Ke:if($n)return $n.call(e)==$n.call(i)}return!1}function cg(e,i,s,u,l,y){var w=s&C,E=Ma(e),R=E.length,q=Ma(i),L=q.length;if(R!=L&&!w)return!1;for(var z=R;z--;){var K=E[z];if(!(w?K in i:De.call(i,K)))return!1}var X=y.get(e),ne=y.get(i);if(X&&ne)return X==i&&ne==e;var we=!0;y.set(e,i),y.set(i,e);for(var se=w;++z<R;){K=E[z];var be=e[K],Se=i[K];if(u)var dr=w?u(Se,be,K,i,e,y):u(be,Se,K,e,i,y);if(!(dr===r?be===Se||l(be,Se,s,u,y):dr)){we=!1;break}se||(se=K=="constructor")}if(we&&!se){var Zt=e.constructor,gr=i.constructor;Zt!=gr&&"constructor"in e&&"constructor"in i&&!(typeof Zt=="function"&&Zt instanceof Zt&&typeof gr=="function"&&gr instanceof gr)&&(we=!1)}return y.delete(e),y.delete(i),we}function Xr(e){return Ga(fh(e,r,bh),e+"")}function Ma(e){return Su(e,Ft,Ba)}function za(e){return Su(e,ir,ah)}var Ua=Hs?function(e){return Hs.get(e)}:oc;function ro(e){for(var i=e.name+"",s=cn[i],u=De.call(cn,i)?s.length:0;u--;){var l=s[u],y=l.func;if(y==null||y==e)return l.name}return i}function fn(e){var i=De.call(d,"placeholder")?d:e;return i.placeholder}function ie(){var e=d.iteratee||nc;return e=e===nc?Au:e,arguments.length?e(arguments[0],arguments[1]):e}function io(e,i){var s=e.__data__;return yg(i)?s[typeof i=="string"?"string":"hash"]:s.map}function Ha(e){for(var i=Ft(e),s=i.length;s--;){var u=i[s],l=e[u];i[s]=[u,l,hh(l)]}return i}function Mi(e,i){var s=wp(e,i);return Ru(s)?s:r}function ug(e){var i=De.call(e,Di),s=e[Di];try{e[Di]=r;var u=!0}catch{}var l=Ds.call(e);return u&&(i?e[Di]=s:delete e[Di]),l}var Ba=ya?function(e){return e==null?[]:(e=Ue(e),fi(ya(e),function(i){return pu.call(e,i)}))}:ac,ah=ya?function(e){for(var i=[];e;)pi(i,Ba(e)),e=qs(e);return i}:ac,kt=Qt;(va&&kt(new va(new ArrayBuffer(1)))!=qe||An&&kt(new An)!=me||ma&&kt(ma.resolve())!=_t||an&&kt(new an)!=Te||Cn&&kt(new Cn)!=Fe)&&(kt=function(e){var i=Qt(e),s=i==Ie?e.constructor:r,u=s?zi(s):"";if(u)switch(u){case Kp:return qe;case Vp:return me;case Gp:return _t;case Wp:return Te;case Jp:return Fe}return i});function hg(e,i,s){for(var u=-1,l=s.length;++u<l;){var y=s[u],w=y.size;switch(y.type){case"drop":e+=w;break;case"dropRight":i-=w;break;case"take":i=Bt(i,e+w);break;case"takeRight":e=$t(e,i-w);break}}return{start:e,end:i}}function lg(e){var i=e.match(He);return i?i[1].split(Pt):[]}function ch(e,i,s){i=mi(i,e);for(var u=-1,l=i.length,y=!1;++u<l;){var w=Br(i[u]);if(!(y=e!=null&&s(e,w)))break;e=e[w]}return y||++u!=l?y:(l=e==null?0:e.length,!!l&&ho(l)&&ei(w,l)&&(ge(e)||Ui(e)))}function fg(e){var i=e.length,s=new e.constructor(i);return i&&typeof e[0]=="string"&&De.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function uh(e){return typeof e.constructor=="function"&&!Mn(e)?un(qs(e)):{}}function pg(e,i,s){var u=e.constructor;switch(i){case Re:return ja(e);case N:case T:return new u(+e);case qe:return Qd(e,s);case ot:case Ne:case bt:case Ct:case Mt:case zt:case Nt:case Gt:case Xt:return Ku(e,s);case me:return new u;case Oe:case ke:return new u(e);case et:return Yd(e);case Te:return new u;case Ke:return Zd(e)}}function dg(e,i){var s=i.length;if(!s)return e;var u=s-1;return i[u]=(s>1?"& ":"")+i[u],i=i.join(s>2?", ":" "),e.replace(ft,`{
/* [wrapped with `+i+`] */
`)}function gg(e){return ge(e)||Ui(e)||!!(du&&e&&e[du])}function ei(e,i){var s=typeof e;return i=i??H,!!i&&(s=="number"||s!="symbol"&&Vo.test(e))&&e>-1&&e%1==0&&e<i}function Yt(e,i,s){if(!it(s))return!1;var u=typeof i;return(u=="number"?rr(s)&&ei(i,s.length):u=="string"&&i in s)?Nr(s[i],e):!1}function ka(e,i){if(ge(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||pr(e)?!0:Et.test(e)||!Qe.test(e)||i!=null&&e in Ue(i)}function yg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function Ka(e){var i=ro(e),s=d[i];if(typeof s!="function"||!(i in xe.prototype))return!1;if(e===s)return!0;var u=Ua(s);return!!u&&e===u[0]}function vg(e){return!!hu&&hu in e}var mg=$s?ti:cc;function Mn(e){var i=e&&e.constructor,s=typeof i=="function"&&i.prototype||on;return e===s}function hh(e){return e===e&&!it(e)}function lh(e,i){return function(s){return s==null?!1:s[e]===i&&(i!==r||e in Ue(s))}}function wg(e){var i=co(e,function(u){return s.size===p&&s.clear(),u}),s=i.cache;return i}function _g(e,i){var s=e[1],u=i[1],l=s|u,y=l<(re|oe|Y),w=u==Y&&s==ae||u==Y&&s==ve&&e[7].length<=i[8]||u==(Y|ve)&&i[7].length<=i[8]&&s==ae;if(!(y||w))return e;u&re&&(e[2]=i[2],l|=s&re?0:ce);var E=i[3];if(E){var R=e[3];e[3]=R?Gu(R,E,i[4]):E,e[4]=R?di(e[3],b):i[4]}return E=i[5],E&&(R=e[5],e[5]=R?Wu(R,E,i[6]):E,e[6]=R?di(e[5],b):i[6]),E=i[7],E&&(e[7]=E),u&Y&&(e[8]=e[8]==null?i[8]:Bt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=l,e}function bg(e){var i=[];if(e!=null)for(var s in Ue(e))i.push(s);return i}function Eg(e){return Ds.call(e)}function fh(e,i,s){return i=$t(i===r?e.length-1:i,0),function(){for(var u=arguments,l=-1,y=$t(u.length-i,0),w=$(y);++l<y;)w[l]=u[i+l];l=-1;for(var E=$(i+1);++l<i;)E[l]=u[l];return E[i]=s(w),Dt(e,this,E)}}function ph(e,i){return i.length<2?e:Li(e,Ir(i,0,-1))}function Ig(e,i){for(var s=e.length,u=Bt(i.length,s),l=tr(e);u--;){var y=i[u];e[u]=ei(y,s)?l[y]:r}return e}function Va(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var dh=yh(qu),zn=Lp||function(e,i){return Pe.setTimeout(e,i)},Ga=yh(Vd);function gh(e,i,s){var u=i+"";return Ga(e,dg(u,xg(lg(u),s)))}function yh(e){var i=0,s=0;return function(){var u=Hp(),l=Lt-(u-s);if(s=u,l>0){if(++i>=qt)return arguments[0]}else i=0;return e.apply(r,arguments)}}function no(e,i){var s=-1,u=e.length,l=u-1;for(i=i===r?u:i;++s<i;){var y=Aa(s,l),w=e[y];e[y]=e[s],e[s]=w}return e.length=i,e}var vh=wg(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(It,function(s,u,l,y){i.push(l?y.replace(zo,"$1"):u||s)}),i});function Br(e){if(typeof e=="string"||pr(e))return e;var i=e+"";return i=="0"&&1/e==-le?"-0":i}function zi(e){if(e!=null){try{return Ns.call(e)}catch{}try{return e+""}catch{}}return""}function xg(e,i){return wr(Oi,function(s){var u="_."+s[0];i&s[1]&&!Rs(e,u)&&e.push(u)}),e.sort()}function mh(e){if(e instanceof xe)return e.clone();var i=new br(e.__wrapped__,e.__chain__);return i.__actions__=tr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function Pg(e,i,s){(s?Yt(e,i,s):i===r)?i=1:i=$t(ye(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var l=0,y=0,w=$(zs(u/i));l<u;)w[y++]=Ir(e,l,l+=i);return w}function Sg(e){for(var i=-1,s=e==null?0:e.length,u=0,l=[];++i<s;){var y=e[i];y&&(l[u++]=y)}return l}function Og(){var e=arguments.length;if(!e)return[];for(var i=$(e-1),s=arguments[0],u=e;u--;)i[u-1]=arguments[u];return pi(ge(s)?tr(s):[s],Ut(i,1))}var Rg=_e(function(e,i){return vt(e)?Dn(e,Ut(i,1,vt,!0)):[]}),Ag=_e(function(e,i){var s=xr(i);return vt(s)&&(s=r),vt(e)?Dn(e,Ut(i,1,vt,!0),ie(s,2)):[]}),Cg=_e(function(e,i){var s=xr(i);return vt(s)&&(s=r),vt(e)?Dn(e,Ut(i,1,vt,!0),r,s):[]});function Tg(e,i,s){var u=e==null?0:e.length;return u?(i=s||i===r?1:ye(i),Ir(e,i<0?0:i,u)):[]}function $g(e,i,s){var u=e==null?0:e.length;return u?(i=s||i===r?1:ye(i),i=u-i,Ir(e,0,i<0?0:i)):[]}function Ng(e,i){return e&&e.length?Qs(e,ie(i,3),!0,!0):[]}function Dg(e,i){return e&&e.length?Qs(e,ie(i,3),!0):[]}function Fg(e,i,s,u){var l=e==null?0:e.length;return l?(s&&typeof s!="number"&&Yt(e,i,s)&&(s=0,u=l),Od(e,i,s,u)):[]}function wh(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var l=s==null?0:ye(s);return l<0&&(l=$t(u+l,0)),As(e,ie(i,3),l)}function _h(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var l=u-1;return s!==r&&(l=ye(s),l=s<0?$t(u+l,0):Bt(l,u-1)),As(e,ie(i,3),l,!0)}function bh(e){var i=e==null?0:e.length;return i?Ut(e,1):[]}function jg(e){var i=e==null?0:e.length;return i?Ut(e,le):[]}function qg(e,i){var s=e==null?0:e.length;return s?(i=i===r?1:ye(i),Ut(e,i)):[]}function Lg(e){for(var i=-1,s=e==null?0:e.length,u={};++i<s;){var l=e[i];u[l[0]]=l[1]}return u}function Eh(e){return e&&e.length?e[0]:r}function Mg(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var l=s==null?0:ye(s);return l<0&&(l=$t(u+l,0)),tn(e,i,l)}function zg(e){var i=e==null?0:e.length;return i?Ir(e,0,-1):[]}var Ug=_e(function(e){var i=Ye(e,Da);return i.length&&i[0]===e[0]?xa(i):[]}),Hg=_e(function(e){var i=xr(e),s=Ye(e,Da);return i===xr(s)?i=r:s.pop(),s.length&&s[0]===e[0]?xa(s,ie(i,2)):[]}),Bg=_e(function(e){var i=xr(e),s=Ye(e,Da);return i=typeof i=="function"?i:r,i&&s.pop(),s.length&&s[0]===e[0]?xa(s,r,i):[]});function kg(e,i){return e==null?"":zp.call(e,i)}function xr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function Kg(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var l=u;return s!==r&&(l=ye(s),l=l<0?$t(u+l,0):Bt(l,u-1)),i===i?xp(e,i,l):As(e,ru,l,!0)}function Vg(e,i){return e&&e.length?Nu(e,ye(i)):r}var Gg=_e(Ih);function Ih(e,i){return e&&e.length&&i&&i.length?Ra(e,i):e}function Wg(e,i,s){return e&&e.length&&i&&i.length?Ra(e,i,ie(s,2)):e}function Jg(e,i,s){return e&&e.length&&i&&i.length?Ra(e,i,r,s):e}var Qg=Xr(function(e,i){var s=e==null?0:e.length,u=_a(e,i);return ju(e,Ye(i,function(l){return ei(l,s)?+l:l}).sort(Vu)),u});function Yg(e,i){var s=[];if(!(e&&e.length))return s;var u=-1,l=[],y=e.length;for(i=ie(i,3);++u<y;){var w=e[u];i(w,u,e)&&(s.push(w),l.push(u))}return ju(e,l),s}function Wa(e){return e==null?e:kp.call(e)}function Zg(e,i,s){var u=e==null?0:e.length;return u?(s&&typeof s!="number"&&Yt(e,i,s)?(i=0,s=u):(i=i==null?0:ye(i),s=s===r?u:ye(s)),Ir(e,i,s)):[]}function Xg(e,i){return Js(e,i)}function ey(e,i,s){return Ta(e,i,ie(s,2))}function ty(e,i){var s=e==null?0:e.length;if(s){var u=Js(e,i);if(u<s&&Nr(e[u],i))return u}return-1}function ry(e,i){return Js(e,i,!0)}function iy(e,i,s){return Ta(e,i,ie(s,2),!0)}function ny(e,i){var s=e==null?0:e.length;if(s){var u=Js(e,i,!0)-1;if(Nr(e[u],i))return u}return-1}function sy(e){return e&&e.length?Lu(e):[]}function oy(e,i){return e&&e.length?Lu(e,ie(i,2)):[]}function ay(e){var i=e==null?0:e.length;return i?Ir(e,1,i):[]}function cy(e,i,s){return e&&e.length?(i=s||i===r?1:ye(i),Ir(e,0,i<0?0:i)):[]}function uy(e,i,s){var u=e==null?0:e.length;return u?(i=s||i===r?1:ye(i),i=u-i,Ir(e,i<0?0:i,u)):[]}function hy(e,i){return e&&e.length?Qs(e,ie(i,3),!1,!0):[]}function ly(e,i){return e&&e.length?Qs(e,ie(i,3)):[]}var fy=_e(function(e){return vi(Ut(e,1,vt,!0))}),py=_e(function(e){var i=xr(e);return vt(i)&&(i=r),vi(Ut(e,1,vt,!0),ie(i,2))}),dy=_e(function(e){var i=xr(e);return i=typeof i=="function"?i:r,vi(Ut(e,1,vt,!0),r,i)});function gy(e){return e&&e.length?vi(e):[]}function yy(e,i){return e&&e.length?vi(e,ie(i,2)):[]}function vy(e,i){return i=typeof i=="function"?i:r,e&&e.length?vi(e,r,i):[]}function Ja(e){if(!(e&&e.length))return[];var i=0;return e=fi(e,function(s){if(vt(s))return i=$t(s.length,i),!0}),fa(i,function(s){return Ye(e,ua(s))})}function xh(e,i){if(!(e&&e.length))return[];var s=Ja(e);return i==null?s:Ye(s,function(u){return Dt(i,r,u)})}var my=_e(function(e,i){return vt(e)?Dn(e,i):[]}),wy=_e(function(e){return Na(fi(e,vt))}),_y=_e(function(e){var i=xr(e);return vt(i)&&(i=r),Na(fi(e,vt),ie(i,2))}),by=_e(function(e){var i=xr(e);return i=typeof i=="function"?i:r,Na(fi(e,vt),r,i)}),Ey=_e(Ja);function Iy(e,i){return Hu(e||[],i||[],Nn)}function xy(e,i){return Hu(e||[],i||[],qn)}var Py=_e(function(e){var i=e.length,s=i>1?e[i-1]:r;return s=typeof s=="function"?(e.pop(),s):r,xh(e,s)});function Ph(e){var i=d(e);return i.__chain__=!0,i}function Sy(e,i){return i(e),e}function so(e,i){return i(e)}var Oy=Xr(function(e){var i=e.length,s=i?e[0]:0,u=this.__wrapped__,l=function(y){return _a(y,e)};return i>1||this.__actions__.length||!(u instanceof xe)||!ei(s)?this.thru(l):(u=u.slice(s,+s+(i?1:0)),u.__actions__.push({func:so,args:[l],thisArg:r}),new br(u,this.__chain__).thru(function(y){return i&&!y.length&&y.push(r),y}))});function Ry(){return Ph(this)}function Ay(){return new br(this.value(),this.__chain__)}function Cy(){this.__values__===r&&(this.__values__=Mh(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function Ty(){return this}function $y(e){for(var i,s=this;s instanceof ks;){var u=mh(s);u.__index__=0,u.__values__=r,i?l.__wrapped__=u:i=u;var l=u;s=s.__wrapped__}return l.__wrapped__=e,i}function Ny(){var e=this.__wrapped__;if(e instanceof xe){var i=e;return this.__actions__.length&&(i=new xe(this)),i=i.reverse(),i.__actions__.push({func:so,args:[Wa],thisArg:r}),new br(i,this.__chain__)}return this.thru(Wa)}function Dy(){return Uu(this.__wrapped__,this.__actions__)}var Fy=Ys(function(e,i,s){De.call(e,s)?++e[s]:Yr(e,s,1)});function jy(e,i,s){var u=ge(e)?eu:Sd;return s&&Yt(e,i,s)&&(i=r),u(e,ie(i,3))}function qy(e,i){var s=ge(e)?fi:xu;return s(e,ie(i,3))}var Ly=Zu(wh),My=Zu(_h);function zy(e,i){return Ut(oo(e,i),1)}function Uy(e,i){return Ut(oo(e,i),le)}function Hy(e,i,s){return s=s===r?1:ye(s),Ut(oo(e,i),s)}function Sh(e,i){var s=ge(e)?wr:yi;return s(e,ie(i,3))}function Oh(e,i){var s=ge(e)?ap:Iu;return s(e,ie(i,3))}var By=Ys(function(e,i,s){De.call(e,s)?e[s].push(i):Yr(e,s,[i])});function ky(e,i,s,u){e=rr(e)?e:dn(e),s=s&&!u?ye(s):0;var l=e.length;return s<0&&(s=$t(l+s,0)),lo(e)?s<=l&&e.indexOf(i,s)>-1:!!l&&tn(e,i,s)>-1}var Ky=_e(function(e,i,s){var u=-1,l=typeof i=="function",y=rr(e)?$(e.length):[];return yi(e,function(w){y[++u]=l?Dt(i,w,s):Fn(w,i,s)}),y}),Vy=Ys(function(e,i,s){Yr(e,s,i)});function oo(e,i){var s=ge(e)?Ye:Cu;return s(e,ie(i,3))}function Gy(e,i,s,u){return e==null?[]:(ge(i)||(i=i==null?[]:[i]),s=u?r:s,ge(s)||(s=s==null?[]:[s]),Du(e,i,s))}var Wy=Ys(function(e,i,s){e[s?0:1].push(i)},function(){return[[],[]]});function Jy(e,i,s){var u=ge(e)?aa:nu,l=arguments.length<3;return u(e,ie(i,4),s,l,yi)}function Qy(e,i,s){var u=ge(e)?cp:nu,l=arguments.length<3;return u(e,ie(i,4),s,l,Iu)}function Yy(e,i){var s=ge(e)?fi:xu;return s(e,uo(ie(i,3)))}function Zy(e){var i=ge(e)?wu:kd;return i(e)}function Xy(e,i,s){(s?Yt(e,i,s):i===r)?i=1:i=ye(i);var u=ge(e)?bd:Kd;return u(e,i)}function ev(e){var i=ge(e)?Ed:Gd;return i(e)}function tv(e){if(e==null)return 0;if(rr(e))return lo(e)?nn(e):e.length;var i=kt(e);return i==me||i==Te?e.size:Sa(e).length}function rv(e,i,s){var u=ge(e)?ca:Wd;return s&&Yt(e,i,s)&&(i=r),u(e,ie(i,3))}var iv=_e(function(e,i){if(e==null)return[];var s=i.length;return s>1&&Yt(e,i[0],i[1])?i=[]:s>2&&Yt(i[0],i[1],i[2])&&(i=[i[0]]),Du(e,Ut(i,1),[])}),ao=qp||function(){return Pe.Date.now()};function nv(e,i){if(typeof i!="function")throw new _r(f);return e=ye(e),function(){if(--e<1)return i.apply(this,arguments)}}function Rh(e,i,s){return i=s?r:i,i=e&&i==null?e.length:i,Zr(e,Y,r,r,r,r,i)}function Ah(e,i){var s;if(typeof i!="function")throw new _r(f);return e=ye(e),function(){return--e>0&&(s=i.apply(this,arguments)),e<=1&&(i=r),s}}var Qa=_e(function(e,i,s){var u=re;if(s.length){var l=di(s,fn(Qa));u|=he}return Zr(e,u,i,s,l)}),Ch=_e(function(e,i,s){var u=re|oe;if(s.length){var l=di(s,fn(Ch));u|=he}return Zr(i,u,e,s,l)});function Th(e,i,s){i=s?r:i;var u=Zr(e,ae,r,r,r,r,r,i);return u.placeholder=Th.placeholder,u}function $h(e,i,s){i=s?r:i;var u=Zr(e,ee,r,r,r,r,r,i);return u.placeholder=$h.placeholder,u}function Nh(e,i,s){var u,l,y,w,E,R,q=0,L=!1,z=!1,K=!0;if(typeof e!="function")throw new _r(f);i=Pr(i)||0,it(s)&&(L=!!s.leading,z="maxWait"in s,y=z?$t(Pr(s.maxWait)||0,i):y,K="trailing"in s?!!s.trailing:K);function X(mt){var Dr=u,ii=l;return u=l=r,q=mt,w=e.apply(ii,Dr),w}function ne(mt){return q=mt,E=zn(be,i),L?X(mt):w}function we(mt){var Dr=mt-R,ii=mt-q,Zh=i-Dr;return z?Bt(Zh,y-ii):Zh}function se(mt){var Dr=mt-R,ii=mt-q;return R===r||Dr>=i||Dr<0||z&&ii>=y}function be(){var mt=ao();if(se(mt))return Se(mt);E=zn(be,we(mt))}function Se(mt){return E=r,K&&u?X(mt):(u=l=r,w)}function dr(){E!==r&&Bu(E),q=0,u=R=l=E=r}function Zt(){return E===r?w:Se(ao())}function gr(){var mt=ao(),Dr=se(mt);if(u=arguments,l=this,R=mt,Dr){if(E===r)return ne(R);if(z)return Bu(E),E=zn(be,i),X(R)}return E===r&&(E=zn(be,i)),w}return gr.cancel=dr,gr.flush=Zt,gr}var sv=_e(function(e,i){return Eu(e,1,i)}),ov=_e(function(e,i,s){return Eu(e,Pr(i)||0,s)});function av(e){return Zr(e,wt)}function co(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new _r(f);var s=function(){var u=arguments,l=i?i.apply(this,u):u[0],y=s.cache;if(y.has(l))return y.get(l);var w=e.apply(this,u);return s.cache=y.set(l,w)||y,w};return s.cache=new(co.Cache||Qr),s}co.Cache=Qr;function uo(e){if(typeof e!="function")throw new _r(f);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function cv(e){return Ah(2,e)}var uv=Jd(function(e,i){i=i.length==1&&ge(i[0])?Ye(i[0],lr(ie())):Ye(Ut(i,1),lr(ie()));var s=i.length;return _e(function(u){for(var l=-1,y=Bt(u.length,s);++l<y;)u[l]=i[l].call(this,u[l]);return Dt(e,this,u)})}),Ya=_e(function(e,i){var s=di(i,fn(Ya));return Zr(e,he,r,i,s)}),Dh=_e(function(e,i){var s=di(i,fn(Dh));return Zr(e,pe,r,i,s)}),hv=Xr(function(e,i){return Zr(e,ve,r,r,r,i)});function lv(e,i){if(typeof e!="function")throw new _r(f);return i=i===r?i:ye(i),_e(e,i)}function fv(e,i){if(typeof e!="function")throw new _r(f);return i=i==null?0:$t(ye(i),0),_e(function(s){var u=s[i],l=wi(s,0,i);return u&&pi(l,u),Dt(e,this,l)})}function pv(e,i,s){var u=!0,l=!0;if(typeof e!="function")throw new _r(f);return it(s)&&(u="leading"in s?!!s.leading:u,l="trailing"in s?!!s.trailing:l),Nh(e,i,{leading:u,maxWait:i,trailing:l})}function dv(e){return Rh(e,1)}function gv(e,i){return Ya(Fa(i),e)}function yv(){if(!arguments.length)return[];var e=arguments[0];return ge(e)?e:[e]}function vv(e){return Er(e,D)}function mv(e,i){return i=typeof i=="function"?i:r,Er(e,D,i)}function wv(e){return Er(e,x|D)}function _v(e,i){return i=typeof i=="function"?i:r,Er(e,x|D,i)}function bv(e,i){return i==null||bu(e,i,Ft(i))}function Nr(e,i){return e===i||e!==e&&i!==i}var Ev=to(Ia),Iv=to(function(e,i){return e>=i}),Ui=Ou(function(){return arguments}())?Ou:function(e){return pt(e)&&De.call(e,"callee")&&!pu.call(e,"callee")},ge=$.isArray,xv=Jt?lr(Jt):$d;function rr(e){return e!=null&&ho(e.length)&&!ti(e)}function vt(e){return pt(e)&&rr(e)}function Pv(e){return e===!0||e===!1||pt(e)&&Qt(e)==N}var _i=Mp||cc,Sv=Cr?lr(Cr):Nd;function Ov(e){return pt(e)&&e.nodeType===1&&!Un(e)}function Rv(e){if(e==null)return!0;if(rr(e)&&(ge(e)||typeof e=="string"||typeof e.splice=="function"||_i(e)||pn(e)||Ui(e)))return!e.length;var i=kt(e);if(i==me||i==Te)return!e.size;if(Mn(e))return!Sa(e).length;for(var s in e)if(De.call(e,s))return!1;return!0}function Av(e,i){return jn(e,i)}function Cv(e,i,s){s=typeof s=="function"?s:r;var u=s?s(e,i):r;return u===r?jn(e,i,r,s):!!u}function Za(e){if(!pt(e))return!1;var i=Qt(e);return i==I||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Un(e)}function Tv(e){return typeof e=="number"&&gu(e)}function ti(e){if(!it(e))return!1;var i=Qt(e);return i==Z||i==ue||i==F||i==dt}function Fh(e){return typeof e=="number"&&e==ye(e)}function ho(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=H}function it(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function pt(e){return e!=null&&typeof e=="object"}var jh=mr?lr(mr):Fd;function $v(e,i){return e===i||Pa(e,i,Ha(i))}function Nv(e,i,s){return s=typeof s=="function"?s:r,Pa(e,i,Ha(i),s)}function Dv(e){return qh(e)&&e!=+e}function Fv(e){if(mg(e))throw new fe(c);return Ru(e)}function jv(e){return e===null}function qv(e){return e==null}function qh(e){return typeof e=="number"||pt(e)&&Qt(e)==Oe}function Un(e){if(!pt(e)||Qt(e)!=Ie)return!1;var i=qs(e);if(i===null)return!0;var s=De.call(i,"constructor")&&i.constructor;return typeof s=="function"&&s instanceof s&&Ns.call(s)==Np}var Xa=zr?lr(zr):jd;function Lv(e){return Fh(e)&&e>=-H&&e<=H}var Lh=Sn?lr(Sn):qd;function lo(e){return typeof e=="string"||!ge(e)&&pt(e)&&Qt(e)==ke}function pr(e){return typeof e=="symbol"||pt(e)&&Qt(e)==Ke}var pn=Ni?lr(Ni):Ld;function Mv(e){return e===r}function zv(e){return pt(e)&&kt(e)==Fe}function Uv(e){return pt(e)&&Qt(e)==Ve}var Hv=to(Oa),Bv=to(function(e,i){return e<=i});function Mh(e){if(!e)return[];if(rr(e))return lo(e)?Tr(e):tr(e);if(Rn&&e[Rn])return bp(e[Rn]());var i=kt(e),s=i==me?da:i==Te?Cs:dn;return s(e)}function ri(e){if(!e)return e===0?e:0;if(e=Pr(e),e===le||e===-le){var i=e<0?-1:1;return i*U}return e===e?e:0}function ye(e){var i=ri(e),s=i%1;return i===i?s?i-s:i:0}function zh(e){return e?qi(ye(e),0,k):0}function Pr(e){if(typeof e=="number")return e;if(pr(e))return B;if(it(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=it(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=su(e);var s=Bo.test(e);return s||Ko.test(e)?de(e.slice(2),s?2:8):Ho.test(e)?B:+e}function Uh(e){return Hr(e,ir(e))}function kv(e){return e?qi(ye(e),-H,H):e===0?e:0}function $e(e){return e==null?"":fr(e)}var Kv=hn(function(e,i){if(Mn(i)||rr(i)){Hr(i,Ft(i),e);return}for(var s in i)De.call(i,s)&&Nn(e,s,i[s])}),Hh=hn(function(e,i){Hr(i,ir(i),e)}),fo=hn(function(e,i,s,u){Hr(i,ir(i),e,u)}),Vv=hn(function(e,i,s,u){Hr(i,Ft(i),e,u)}),Gv=Xr(_a);function Wv(e,i){var s=un(e);return i==null?s:_u(s,i)}var Jv=_e(function(e,i){e=Ue(e);var s=-1,u=i.length,l=u>2?i[2]:r;for(l&&Yt(i[0],i[1],l)&&(u=1);++s<u;)for(var y=i[s],w=ir(y),E=-1,R=w.length;++E<R;){var q=w[E],L=e[q];(L===r||Nr(L,on[q])&&!De.call(e,q))&&(e[q]=y[q])}return e}),Qv=_e(function(e){return e.push(r,sh),Dt(Bh,r,e)});function Yv(e,i){return tu(e,ie(i,3),Ur)}function Zv(e,i){return tu(e,ie(i,3),Ea)}function Xv(e,i){return e==null?e:ba(e,ie(i,3),ir)}function e0(e,i){return e==null?e:Pu(e,ie(i,3),ir)}function t0(e,i){return e&&Ur(e,ie(i,3))}function r0(e,i){return e&&Ea(e,ie(i,3))}function i0(e){return e==null?[]:Gs(e,Ft(e))}function n0(e){return e==null?[]:Gs(e,ir(e))}function ec(e,i,s){var u=e==null?r:Li(e,i);return u===r?s:u}function s0(e,i){return e!=null&&ch(e,i,Rd)}function tc(e,i){return e!=null&&ch(e,i,Ad)}var o0=eh(function(e,i,s){i!=null&&typeof i.toString!="function"&&(i=Ds.call(i)),e[i]=s},ic(nr)),a0=eh(function(e,i,s){i!=null&&typeof i.toString!="function"&&(i=Ds.call(i)),De.call(e,i)?e[i].push(s):e[i]=[s]},ie),c0=_e(Fn);function Ft(e){return rr(e)?mu(e):Sa(e)}function ir(e){return rr(e)?mu(e,!0):Md(e)}function u0(e,i){var s={};return i=ie(i,3),Ur(e,function(u,l,y){Yr(s,i(u,l,y),u)}),s}function h0(e,i){var s={};return i=ie(i,3),Ur(e,function(u,l,y){Yr(s,l,i(u,l,y))}),s}var l0=hn(function(e,i,s){Ws(e,i,s)}),Bh=hn(function(e,i,s,u){Ws(e,i,s,u)}),f0=Xr(function(e,i){var s={};if(e==null)return s;var u=!1;i=Ye(i,function(y){return y=mi(y,e),u||(u=y.length>1),y}),Hr(e,za(e),s),u&&(s=Er(s,x|A|D,og));for(var l=i.length;l--;)$a(s,i[l]);return s});function p0(e,i){return kh(e,uo(ie(i)))}var d0=Xr(function(e,i){return e==null?{}:Ud(e,i)});function kh(e,i){if(e==null)return{};var s=Ye(za(e),function(u){return[u]});return i=ie(i),Fu(e,s,function(u,l){return i(u,l[0])})}function g0(e,i,s){i=mi(i,e);var u=-1,l=i.length;for(l||(l=1,e=r);++u<l;){var y=e==null?r:e[Br(i[u])];y===r&&(u=l,y=s),e=ti(y)?y.call(e):y}return e}function y0(e,i,s){return e==null?e:qn(e,i,s)}function v0(e,i,s,u){return u=typeof u=="function"?u:r,e==null?e:qn(e,i,s,u)}var Kh=ih(Ft),Vh=ih(ir);function m0(e,i,s){var u=ge(e),l=u||_i(e)||pn(e);if(i=ie(i,4),s==null){var y=e&&e.constructor;l?s=u?new y:[]:it(e)?s=ti(y)?un(qs(e)):{}:s={}}return(l?wr:Ur)(e,function(w,E,R){return i(s,w,E,R)}),s}function w0(e,i){return e==null?!0:$a(e,i)}function _0(e,i,s){return e==null?e:zu(e,i,Fa(s))}function b0(e,i,s,u){return u=typeof u=="function"?u:r,e==null?e:zu(e,i,Fa(s),u)}function dn(e){return e==null?[]:pa(e,Ft(e))}function E0(e){return e==null?[]:pa(e,ir(e))}function I0(e,i,s){return s===r&&(s=i,i=r),s!==r&&(s=Pr(s),s=s===s?s:0),i!==r&&(i=Pr(i),i=i===i?i:0),qi(Pr(e),i,s)}function x0(e,i,s){return i=ri(i),s===r?(s=i,i=0):s=ri(s),e=Pr(e),Cd(e,i,s)}function P0(e,i,s){if(s&&typeof s!="boolean"&&Yt(e,i,s)&&(i=s=r),s===r&&(typeof i=="boolean"?(s=i,i=r):typeof e=="boolean"&&(s=e,e=r)),e===r&&i===r?(e=0,i=1):(e=ri(e),i===r?(i=e,e=0):i=ri(i)),e>i){var u=e;e=i,i=u}if(s||e%1||i%1){var l=yu();return Bt(e+l*(i-e+Me("1e-"+((l+"").length-1))),i)}return Aa(e,i)}var S0=ln(function(e,i,s){return i=i.toLowerCase(),e+(s?Gh(i):i)});function Gh(e){return rc($e(e).toLowerCase())}function Wh(e){return e=$e(e),e&&e.replace(Gr,yp).replace(na,"")}function O0(e,i,s){e=$e(e),i=fr(i);var u=e.length;s=s===r?u:qi(ye(s),0,u);var l=s;return s-=i.length,s>=0&&e.slice(s,l)==i}function R0(e){return e=$e(e),e&&Je.test(e)?e.replace(Ri,vp):e}function A0(e){return e=$e(e),e&&xt.test(e)?e.replace(ht,"\\$&"):e}var C0=ln(function(e,i,s){return e+(s?"-":"")+i.toLowerCase()}),T0=ln(function(e,i,s){return e+(s?" ":"")+i.toLowerCase()}),$0=Yu("toLowerCase");function N0(e,i,s){e=$e(e),i=ye(i);var u=i?nn(e):0;if(!i||u>=i)return e;var l=(i-u)/2;return eo(Us(l),s)+e+eo(zs(l),s)}function D0(e,i,s){e=$e(e),i=ye(i);var u=i?nn(e):0;return i&&u<i?e+eo(i-u,s):e}function F0(e,i,s){e=$e(e),i=ye(i);var u=i?nn(e):0;return i&&u<i?eo(i-u,s)+e:e}function j0(e,i,s){return s||i==null?i=0:i&&(i=+i),Bp($e(e).replace(lt,""),i||0)}function q0(e,i,s){return(s?Yt(e,i,s):i===r)?i=1:i=ye(i),Ca($e(e),i)}function L0(){var e=arguments,i=$e(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var M0=ln(function(e,i,s){return e+(s?"_":"")+i.toLowerCase()});function z0(e,i,s){return s&&typeof s!="number"&&Yt(e,i,s)&&(i=s=r),s=s===r?k:s>>>0,s?(e=$e(e),e&&(typeof i=="string"||i!=null&&!Xa(i))&&(i=fr(i),!i&&rn(e))?wi(Tr(e),0,s):e.split(i,s)):[]}var U0=ln(function(e,i,s){return e+(s?" ":"")+rc(i)});function H0(e,i,s){return e=$e(e),s=s==null?0:qi(ye(s),0,e.length),i=fr(i),e.slice(s,s+i.length)==i}function B0(e,i,s){var u=d.templateSettings;s&&Yt(e,i,s)&&(i=r),e=$e(e),i=fo({},i,u,nh);var l=fo({},i.imports,u.imports,nh),y=Ft(l),w=pa(l,y),E,R,q=0,L=i.interpolate||Wi,z="__p += '",K=ga((i.escape||Wi).source+"|"+L.source+"|"+(L===rt?Uo:Wi).source+"|"+(i.evaluate||Wi).source+"|$","g"),X="//# sourceURL="+(De.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++sa+"]")+`
`;e.replace(K,function(se,be,Se,dr,Zt,gr){return Se||(Se=dr),z+=e.slice(q,gr).replace(Go,mp),be&&(E=!0,z+=`' +
__e(`+be+`) +
'`),Zt&&(R=!0,z+=`';
`+Zt+`;
__p += '`),Se&&(z+=`' +
((__t = (`+Se+`)) == null ? '' : __t) +
'`),q=gr+se.length,se}),z+=`';
`;var ne=De.call(i,"variable")&&i.variable;if(!ne)z=`with (obj) {
`+z+`
}
`;else if(Mo.test(ne))throw new fe(g);z=(R?z.replace(Lr,""):z).replace(Wt,"$1").replace(Vr,"$1;"),z="function("+(ne||"obj")+`) {
`+(ne?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(E?", __e = _.escape":"")+(R?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+z+`return __p
}`;var we=Qh(function(){return Ce(y,X+"return "+z).apply(r,w)});if(we.source=z,Za(we))throw we;return we}function k0(e){return $e(e).toLowerCase()}function K0(e){return $e(e).toUpperCase()}function V0(e,i,s){if(e=$e(e),e&&(s||i===r))return su(e);if(!e||!(i=fr(i)))return e;var u=Tr(e),l=Tr(i),y=ou(u,l),w=au(u,l)+1;return wi(u,y,w).join("")}function G0(e,i,s){if(e=$e(e),e&&(s||i===r))return e.slice(0,uu(e)+1);if(!e||!(i=fr(i)))return e;var u=Tr(e),l=au(u,Tr(i))+1;return wi(u,0,l).join("")}function W0(e,i,s){if(e=$e(e),e&&(s||i===r))return e.replace(lt,"");if(!e||!(i=fr(i)))return e;var u=Tr(e),l=ou(u,Tr(i));return wi(u,l).join("")}function J0(e,i){var s=nt,u=Be;if(it(i)){var l="separator"in i?i.separator:l;s="length"in i?ye(i.length):s,u="omission"in i?fr(i.omission):u}e=$e(e);var y=e.length;if(rn(e)){var w=Tr(e);y=w.length}if(s>=y)return e;var E=s-nn(u);if(E<1)return u;var R=w?wi(w,0,E).join(""):e.slice(0,E);if(l===r)return R+u;if(w&&(E+=R.length-E),Xa(l)){if(e.slice(E).search(l)){var q,L=R;for(l.global||(l=ga(l.source,$e(vr.exec(l))+"g")),l.lastIndex=0;q=l.exec(L);)var z=q.index;R=R.slice(0,z===r?E:z)}}else if(e.indexOf(fr(l),E)!=E){var K=R.lastIndexOf(l);K>-1&&(R=R.slice(0,K))}return R+u}function Q0(e){return e=$e(e),e&&at.test(e)?e.replace(hi,Pp):e}var Y0=ln(function(e,i,s){return e+(s?" ":"")+i.toUpperCase()}),rc=Yu("toUpperCase");function Jh(e,i,s){return e=$e(e),i=s?r:i,i===r?_p(e)?Rp(e):lp(e):e.match(i)||[]}var Qh=_e(function(e,i){try{return Dt(e,r,i)}catch(s){return Za(s)?s:new fe(s)}}),Z0=Xr(function(e,i){return wr(i,function(s){s=Br(s),Yr(e,s,Qa(e[s],e))}),e});function X0(e){var i=e==null?0:e.length,s=ie();return e=i?Ye(e,function(u){if(typeof u[1]!="function")throw new _r(f);return[s(u[0]),u[1]]}):[],_e(function(u){for(var l=-1;++l<i;){var y=e[l];if(Dt(y[0],this,u))return Dt(y[1],this,u)}})}function em(e){return Pd(Er(e,x))}function ic(e){return function(){return e}}function tm(e,i){return e==null||e!==e?i:e}var rm=Xu(),im=Xu(!0);function nr(e){return e}function nc(e){return Au(typeof e=="function"?e:Er(e,x))}function nm(e){return Tu(Er(e,x))}function sm(e,i){return $u(e,Er(i,x))}var om=_e(function(e,i){return function(s){return Fn(s,e,i)}}),am=_e(function(e,i){return function(s){return Fn(e,s,i)}});function sc(e,i,s){var u=Ft(i),l=Gs(i,u);s==null&&!(it(i)&&(l.length||!u.length))&&(s=i,i=e,e=this,l=Gs(i,Ft(i)));var y=!(it(s)&&"chain"in s)||!!s.chain,w=ti(e);return wr(l,function(E){var R=i[E];e[E]=R,w&&(e.prototype[E]=function(){var q=this.__chain__;if(y||q){var L=e(this.__wrapped__),z=L.__actions__=tr(this.__actions__);return z.push({func:R,args:arguments,thisArg:e}),L.__chain__=q,L}return R.apply(e,pi([this.value()],arguments))})}),e}function cm(){return Pe._===this&&(Pe._=Dp),this}function oc(){}function um(e){return e=ye(e),_e(function(i){return Nu(i,e)})}var hm=qa(Ye),lm=qa(eu),fm=qa(ca);function Yh(e){return ka(e)?ua(Br(e)):Hd(e)}function pm(e){return function(i){return e==null?r:Li(e,i)}}var dm=th(),gm=th(!0);function ac(){return[]}function cc(){return!1}function ym(){return{}}function vm(){return""}function mm(){return!0}function wm(e,i){if(e=ye(e),e<1||e>H)return[];var s=k,u=Bt(e,k);i=ie(i),e-=k;for(var l=fa(u,i);++s<e;)i(s);return l}function _m(e){return ge(e)?Ye(e,Br):pr(e)?[e]:tr(vh($e(e)))}function bm(e){var i=++$p;return $e(e)+i}var Em=Xs(function(e,i){return e+i},0),Im=La("ceil"),xm=Xs(function(e,i){return e/i},1),Pm=La("floor");function Sm(e){return e&&e.length?Vs(e,nr,Ia):r}function Om(e,i){return e&&e.length?Vs(e,ie(i,2),Ia):r}function Rm(e){return iu(e,nr)}function Am(e,i){return iu(e,ie(i,2))}function Cm(e){return e&&e.length?Vs(e,nr,Oa):r}function Tm(e,i){return e&&e.length?Vs(e,ie(i,2),Oa):r}var $m=Xs(function(e,i){return e*i},1),Nm=La("round"),Dm=Xs(function(e,i){return e-i},0);function Fm(e){return e&&e.length?la(e,nr):0}function jm(e,i){return e&&e.length?la(e,ie(i,2)):0}return d.after=nv,d.ary=Rh,d.assign=Kv,d.assignIn=Hh,d.assignInWith=fo,d.assignWith=Vv,d.at=Gv,d.before=Ah,d.bind=Qa,d.bindAll=Z0,d.bindKey=Ch,d.castArray=yv,d.chain=Ph,d.chunk=Pg,d.compact=Sg,d.concat=Og,d.cond=X0,d.conforms=em,d.constant=ic,d.countBy=Fy,d.create=Wv,d.curry=Th,d.curryRight=$h,d.debounce=Nh,d.defaults=Jv,d.defaultsDeep=Qv,d.defer=sv,d.delay=ov,d.difference=Rg,d.differenceBy=Ag,d.differenceWith=Cg,d.drop=Tg,d.dropRight=$g,d.dropRightWhile=Ng,d.dropWhile=Dg,d.fill=Fg,d.filter=qy,d.flatMap=zy,d.flatMapDeep=Uy,d.flatMapDepth=Hy,d.flatten=bh,d.flattenDeep=jg,d.flattenDepth=qg,d.flip=av,d.flow=rm,d.flowRight=im,d.fromPairs=Lg,d.functions=i0,d.functionsIn=n0,d.groupBy=By,d.initial=zg,d.intersection=Ug,d.intersectionBy=Hg,d.intersectionWith=Bg,d.invert=o0,d.invertBy=a0,d.invokeMap=Ky,d.iteratee=nc,d.keyBy=Vy,d.keys=Ft,d.keysIn=ir,d.map=oo,d.mapKeys=u0,d.mapValues=h0,d.matches=nm,d.matchesProperty=sm,d.memoize=co,d.merge=l0,d.mergeWith=Bh,d.method=om,d.methodOf=am,d.mixin=sc,d.negate=uo,d.nthArg=um,d.omit=f0,d.omitBy=p0,d.once=cv,d.orderBy=Gy,d.over=hm,d.overArgs=uv,d.overEvery=lm,d.overSome=fm,d.partial=Ya,d.partialRight=Dh,d.partition=Wy,d.pick=d0,d.pickBy=kh,d.property=Yh,d.propertyOf=pm,d.pull=Gg,d.pullAll=Ih,d.pullAllBy=Wg,d.pullAllWith=Jg,d.pullAt=Qg,d.range=dm,d.rangeRight=gm,d.rearg=hv,d.reject=Yy,d.remove=Yg,d.rest=lv,d.reverse=Wa,d.sampleSize=Xy,d.set=y0,d.setWith=v0,d.shuffle=ev,d.slice=Zg,d.sortBy=iv,d.sortedUniq=sy,d.sortedUniqBy=oy,d.split=z0,d.spread=fv,d.tail=ay,d.take=cy,d.takeRight=uy,d.takeRightWhile=hy,d.takeWhile=ly,d.tap=Sy,d.throttle=pv,d.thru=so,d.toArray=Mh,d.toPairs=Kh,d.toPairsIn=Vh,d.toPath=_m,d.toPlainObject=Uh,d.transform=m0,d.unary=dv,d.union=fy,d.unionBy=py,d.unionWith=dy,d.uniq=gy,d.uniqBy=yy,d.uniqWith=vy,d.unset=w0,d.unzip=Ja,d.unzipWith=xh,d.update=_0,d.updateWith=b0,d.values=dn,d.valuesIn=E0,d.without=my,d.words=Jh,d.wrap=gv,d.xor=wy,d.xorBy=_y,d.xorWith=by,d.zip=Ey,d.zipObject=Iy,d.zipObjectDeep=xy,d.zipWith=Py,d.entries=Kh,d.entriesIn=Vh,d.extend=Hh,d.extendWith=fo,sc(d,d),d.add=Em,d.attempt=Qh,d.camelCase=S0,d.capitalize=Gh,d.ceil=Im,d.clamp=I0,d.clone=vv,d.cloneDeep=wv,d.cloneDeepWith=_v,d.cloneWith=mv,d.conformsTo=bv,d.deburr=Wh,d.defaultTo=tm,d.divide=xm,d.endsWith=O0,d.eq=Nr,d.escape=R0,d.escapeRegExp=A0,d.every=jy,d.find=Ly,d.findIndex=wh,d.findKey=Yv,d.findLast=My,d.findLastIndex=_h,d.findLastKey=Zv,d.floor=Pm,d.forEach=Sh,d.forEachRight=Oh,d.forIn=Xv,d.forInRight=e0,d.forOwn=t0,d.forOwnRight=r0,d.get=ec,d.gt=Ev,d.gte=Iv,d.has=s0,d.hasIn=tc,d.head=Eh,d.identity=nr,d.includes=ky,d.indexOf=Mg,d.inRange=x0,d.invoke=c0,d.isArguments=Ui,d.isArray=ge,d.isArrayBuffer=xv,d.isArrayLike=rr,d.isArrayLikeObject=vt,d.isBoolean=Pv,d.isBuffer=_i,d.isDate=Sv,d.isElement=Ov,d.isEmpty=Rv,d.isEqual=Av,d.isEqualWith=Cv,d.isError=Za,d.isFinite=Tv,d.isFunction=ti,d.isInteger=Fh,d.isLength=ho,d.isMap=jh,d.isMatch=$v,d.isMatchWith=Nv,d.isNaN=Dv,d.isNative=Fv,d.isNil=qv,d.isNull=jv,d.isNumber=qh,d.isObject=it,d.isObjectLike=pt,d.isPlainObject=Un,d.isRegExp=Xa,d.isSafeInteger=Lv,d.isSet=Lh,d.isString=lo,d.isSymbol=pr,d.isTypedArray=pn,d.isUndefined=Mv,d.isWeakMap=zv,d.isWeakSet=Uv,d.join=kg,d.kebabCase=C0,d.last=xr,d.lastIndexOf=Kg,d.lowerCase=T0,d.lowerFirst=$0,d.lt=Hv,d.lte=Bv,d.max=Sm,d.maxBy=Om,d.mean=Rm,d.meanBy=Am,d.min=Cm,d.minBy=Tm,d.stubArray=ac,d.stubFalse=cc,d.stubObject=ym,d.stubString=vm,d.stubTrue=mm,d.multiply=$m,d.nth=Vg,d.noConflict=cm,d.noop=oc,d.now=ao,d.pad=N0,d.padEnd=D0,d.padStart=F0,d.parseInt=j0,d.random=P0,d.reduce=Jy,d.reduceRight=Qy,d.repeat=q0,d.replace=L0,d.result=g0,d.round=Nm,d.runInContext=S,d.sample=Zy,d.size=tv,d.snakeCase=M0,d.some=rv,d.sortedIndex=Xg,d.sortedIndexBy=ey,d.sortedIndexOf=ty,d.sortedLastIndex=ry,d.sortedLastIndexBy=iy,d.sortedLastIndexOf=ny,d.startCase=U0,d.startsWith=H0,d.subtract=Dm,d.sum=Fm,d.sumBy=jm,d.template=B0,d.times=wm,d.toFinite=ri,d.toInteger=ye,d.toLength=zh,d.toLower=k0,d.toNumber=Pr,d.toSafeInteger=kv,d.toString=$e,d.toUpper=K0,d.trim=V0,d.trimEnd=G0,d.trimStart=W0,d.truncate=J0,d.unescape=Q0,d.uniqueId=bm,d.upperCase=Y0,d.upperFirst=rc,d.each=Sh,d.eachRight=Oh,d.first=Eh,sc(d,function(){var e={};return Ur(d,function(i,s){De.call(d.prototype,s)||(e[s]=i)}),e}(),{chain:!1}),d.VERSION=n,wr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),wr(["drop","take"],function(e,i){xe.prototype[e]=function(s){s=s===r?1:$t(ye(s),0);var u=this.__filtered__&&!i?new xe(this):this.clone();return u.__filtered__?u.__takeCount__=Bt(s,u.__takeCount__):u.__views__.push({size:Bt(s,k),type:e+(u.__dir__<0?"Right":"")}),u},xe.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),wr(["filter","map","takeWhile"],function(e,i){var s=i+1,u=s==_||s==Q;xe.prototype[e]=function(l){var y=this.clone();return y.__iteratees__.push({iteratee:ie(l,3),type:s}),y.__filtered__=y.__filtered__||u,y}}),wr(["head","last"],function(e,i){var s="take"+(i?"Right":"");xe.prototype[e]=function(){return this[s](1).value()[0]}}),wr(["initial","tail"],function(e,i){var s="drop"+(i?"":"Right");xe.prototype[e]=function(){return this.__filtered__?new xe(this):this[s](1)}}),xe.prototype.compact=function(){return this.filter(nr)},xe.prototype.find=function(e){return this.filter(e).head()},xe.prototype.findLast=function(e){return this.reverse().find(e)},xe.prototype.invokeMap=_e(function(e,i){return typeof e=="function"?new xe(this):this.map(function(s){return Fn(s,e,i)})}),xe.prototype.reject=function(e){return this.filter(uo(ie(e)))},xe.prototype.slice=function(e,i){e=ye(e);var s=this;return s.__filtered__&&(e>0||i<0)?new xe(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),i!==r&&(i=ye(i),s=i<0?s.dropRight(-i):s.take(i-e)),s)},xe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},xe.prototype.toArray=function(){return this.take(k)},Ur(xe.prototype,function(e,i){var s=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),l=d[u?"take"+(i=="last"?"Right":""):i],y=u||/^find/.test(i);l&&(d.prototype[i]=function(){var w=this.__wrapped__,E=u?[1]:arguments,R=w instanceof xe,q=E[0],L=R||ge(w),z=function(be){var Se=l.apply(d,pi([be],E));return u&&K?Se[0]:Se};L&&s&&typeof q=="function"&&q.length!=1&&(R=L=!1);var K=this.__chain__,X=!!this.__actions__.length,ne=y&&!K,we=R&&!X;if(!y&&L){w=we?w:new xe(this);var se=e.apply(w,E);return se.__actions__.push({func:so,args:[z],thisArg:r}),new br(se,K)}return ne&&we?e.apply(this,E):(se=this.thru(z),ne?u?se.value()[0]:se.value():se)})}),wr(["pop","push","shift","sort","splice","unshift"],function(e){var i=Ts[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var l=arguments;if(u&&!this.__chain__){var y=this.value();return i.apply(ge(y)?y:[],l)}return this[s](function(w){return i.apply(ge(w)?w:[],l)})}}),Ur(xe.prototype,function(e,i){var s=d[i];if(s){var u=s.name+"";De.call(cn,u)||(cn[u]=[]),cn[u].push({name:i,func:s})}}),cn[Zs(r,oe).name]=[{name:"wrapper",func:r}],xe.prototype.clone=Qp,xe.prototype.reverse=Yp,xe.prototype.value=Zp,d.prototype.at=Oy,d.prototype.chain=Ry,d.prototype.commit=Ay,d.prototype.next=Cy,d.prototype.plant=$y,d.prototype.reverse=Ny,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=Dy,d.prototype.first=d.prototype.head,Rn&&(d.prototype[Rn]=Ty),d},sn=Ap();yt?((yt.exports=sn)._=sn,ze._=sn):Pe._=sn}).call(Wn)})(Mc,Mc.exports);var bx=Object.defineProperty,Ex=Object.defineProperties,Ix=Object.getOwnPropertyDescriptors,nf=Object.getOwnPropertySymbols,xx=Object.prototype.hasOwnProperty,Px=Object.prototype.propertyIsEnumerable,sf=(a,t,r)=>t in a?bx(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,wo=(a,t)=>{for(var r in t||(t={}))xx.call(t,r)&&sf(a,r,t[r]);if(nf)for(var r of nf(t))Px.call(t,r)&&sf(a,r,t[r]);return a},Sx=(a,t)=>Ex(a,Ix(t));function xi(a,t,r){var n;const o=E1(a);return((n=t.rpcMap)==null?void 0:n[o.reference])||`${_x}?chainId=${o.namespace}:${o.reference}&projectId=${r}`}function Gi(a){return a.includes(":")?a.split(":")[1]:a}function np(a){return a.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function Ox(a,t){const r=Object.keys(t.namespaces).filter(o=>o.includes(a));if(!r.length)return[];const n=[];return r.forEach(o=>{const c=t.namespaces[o].accounts;n.push(...c)}),n}function Rx(a={},t={}){const r=of(a),n=of(t);return Mc.exports.merge(r,n)}function of(a){var t,r,n,o;const c={};if(!Eo(a))return c;for(const[f,g]of Object.entries(a)){const m=wf(f)?[f]:g.chains,p=g.methods||[],b=g.events||[],x=g.rpcMap||{},A=Jn(f);c[A]=Sx(wo(wo({},c[A]),g),{chains:hc(m,(t=c[A])==null?void 0:t.chains),methods:hc(p,(r=c[A])==null?void 0:r.methods),events:hc(b,(n=c[A])==null?void 0:n.events),rpcMap:wo(wo({},x),(o=c[A])==null?void 0:o.rpcMap)})}return c}function Ax(a){return a.includes(":")?a.split(":")[2]:a}function Cx(a){const t={};for(const[r,n]of Object.entries(a)){const o=n.methods||[],c=n.events||[],f=n.accounts||[],g=wf(r)?[r]:n.chains?n.chains:np(n.accounts);t[r]={chains:g,methods:o,events:c,accounts:f}}return t}function bc(a){return typeof a=="number"?a:a.includes("0x")?parseInt(a,16):a.includes(":")?Number(a.split(":")[1]):Number(a)}const sp={},Ze=a=>sp[a],Ec=(a,t)=>{sp[a]=t};class Tx{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Si(new Pi(n,Ze("disableProviderPing")))}}class $x{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const n=r||xi(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Si(new Pi(n,Ze("disableProviderPing")))}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=parseInt(Gi(r));t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,n;let o=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class Nx{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Si(new Pi(n,Ze("disableProviderPing")))}}class Dx{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Si(new Pi(n,Ze("disableProviderPing")))}}class Fx{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),o=Gi(r);t[o]=this.createHttpProvider(o,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Si(new Pi(n,Ze("disableProviderPing")))}}class jx{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Si(new Pi(n,Ze("disableProviderPing")))}}class qx{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Gi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Si(new Pi(n,Ze("disableProviderPing")))}}class Lx{constructor(t){this.name="near",this.namespace=t.namespace,this.events=Ze("events"),this.client=Ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const n=r||xi(`${this.name}:${t}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(ui.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;t[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||xi(t,this.namespace);return typeof n>"u"?void 0:new Si(new Pi(n,Ze("disableProviderPing")))}}var Mx=Object.defineProperty,zx=Object.defineProperties,Ux=Object.getOwnPropertyDescriptors,af=Object.getOwnPropertySymbols,Hx=Object.prototype.hasOwnProperty,Bx=Object.prototype.propertyIsEnumerable,cf=(a,t,r)=>t in a?Mx(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,_o=(a,t)=>{for(var r in t||(t={}))Hx.call(t,r)&&cf(a,r,t[r]);if(af)for(var r of af(t))Bx.call(t,r)&&cf(a,r,t[r]);return a},Ic=(a,t)=>zx(a,Ux(t));class Zc{constructor(t){this.events=new Bc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:No(Do({level:(t==null?void 0:t.logger)||tf})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Zc(t);return await r.initialize(),r}async request(t,r){const[n,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:_o({},t),chainId:`${n}:${o}`,topic:this.session.topic})}sendAsync(t,r,n){const o=new Date().getTime();this.request(t,n).then(c=>r(null,Fo(o,c))).catch(c=>r(c,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Kt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(c=>{this.session=c,this.namespaces||(this.namespaces=Cx(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==rp)throw c;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[n,o]=this.validateChain(t);this.getProvider(n).setDefaultChain(o,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(bn(r)){for(const n of r)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await cx.init({logger:this.providerOpts.logger||tf,relayUrl:this.providerOpts.relayUrl||vx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>Jn(r)))];Ec("client",this.client),Ec("events",this.events),Ec("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const n=Ox(r,this.session),o=np(n),c=Rx(this.namespaces,this.optionalNamespaces),f=Ic(_o({},c[r]),{accounts:n,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new $x({namespace:f});break;case"solana":this.rpcProviders[r]=new Nx({namespace:f});break;case"cosmos":this.rpcProviders[r]=new Dx({namespace:f});break;case"polkadot":this.rpcProviders[r]=new Tx({namespace:f});break;case"cip34":this.rpcProviders[r]=new Fx({namespace:f});break;case"elrond":this.rpcProviders[r]=new jx({namespace:f});break;case"multiversx":this.rpcProviders[r]=new qx({namespace:f});break;case"near":this.rpcProviders[r]=new Lx({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:n}=r;if(n.name==="accountsChanged"){const o=n.data;o&&bn(o)&&this.events.emit("accountsChanged",o.map(Ax))}else if(n.name==="chainChanged"){const o=r.chainId,c=r.event.data,f=Jn(o),g=bc(o)!==bc(c)?`${f}:${bc(c)}`:o;this.onChainChanged(g)}else this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var n;const{namespaces:o}=r,c=(n=this.client)==null?void 0:n.session.get(t);this.session=Ic(_o({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Ic(_o({},Kt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(ui.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:n,sessionProperties:o}=t;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(t){const[r,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(f=>Jn(f)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const o=Jn(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var n;if(!this.namespaces)return;const[o,c]=this.validateChain(t);r||this.getProvider(o).setDefaultChain(c),((n=this.namespaces[o])!=null?n:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${rf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${rf}/${t}`)}}const kx=Zc,Kx="wc",Vx="ethereum_provider",Gx=`${Kx}@2:${Vx}:`,Wx="https://rpc.walletconnect.com/v1/",zc=["eth_sendTransaction","personal_sign"],Jx=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Uc=["chainChanged","accountsChanged"],Qx=["chainChanged","accountsChanged","message","disconnect","connect"];var Yx=Object.defineProperty,Zx=Object.defineProperties,Xx=Object.getOwnPropertyDescriptors,uf=Object.getOwnPropertySymbols,eP=Object.prototype.hasOwnProperty,tP=Object.prototype.propertyIsEnumerable,hf=(a,t,r)=>t in a?Yx(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,Yn=(a,t)=>{for(var r in t||(t={}))eP.call(t,r)&&hf(a,r,t[r]);if(uf)for(var r of uf(t))tP.call(t,r)&&hf(a,r,t[r]);return a},lf=(a,t)=>Zx(a,Xx(t));function Oo(a){return Number(a[0].split(":")[1])}function xc(a){return`0x${a.toString(16)}`}function rP(a){const{chains:t,optionalChains:r,methods:n,optionalMethods:o,events:c,optionalEvents:f,rpcMap:g}=a;if(!bn(t))throw new Error("Invalid chains");const m={chains:t,methods:n||zc,events:c||Uc,rpcMap:Yn({},t.length?{[Oo(t)]:g[Oo(t)]}:{})},p=c==null?void 0:c.filter(D=>!Uc.includes(D)),b=n==null?void 0:n.filter(D=>!zc.includes(D));if(!r&&!f&&!o&&!(p!=null&&p.length)&&!(b!=null&&b.length))return{required:t.length?m:void 0};const x=(p==null?void 0:p.length)&&(b==null?void 0:b.length)||!r,A={chains:[...new Set(x?m.chains.concat(r||[]):r)],methods:[...new Set(m.methods.concat(o!=null&&o.length?o:Jx))],events:[...new Set(m.events.concat(f!=null&&f.length?f:Qx))],rpcMap:g};return{required:t.length?m:void 0,optional:r.length?A:void 0}}class Xc{constructor(){this.events=new yr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=Gx,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new Xc;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:n}=rP(this.rpc);try{const o=await new Promise(async(f,g)=>{var m;this.rpc.showQrModal&&((m=this.modal)==null||m.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(lf(Yn({namespaces:Yn({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(p=>{f(p)}).catch(p=>{g(new Error(p.message))})});if(!o)return;const c=I1(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:xc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",xc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",lf(Yn({},Kt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",xc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,n,o]=t.split(":");return{chainId:`${r}:${n}`,address:o}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,n;const o=(r=t==null?void 0:t.chains)!=null?r:[],c=(n=t==null?void 0:t.optionalChains)!=null?n:[],f=o.concat(c);if(!f.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=o.length?(t==null?void 0:t.methods)||zc:[],m=o.length?(t==null?void 0:t.events)||Uc:[],p=(t==null?void 0:t.optionalMethods)||[],b=(t==null?void 0:t.optionalEvents)||[],x=(t==null?void 0:t.rpcMap)||this.buildRpcMap(f,t.projectId),A=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(D=>this.formatChainId(D)),optionalChains:c.map(D=>this.formatChainId(D)),methods:g,events:m,optionalMethods:p,optionalEvents:b,rpcMap:x,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:A,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const n={};return t.forEach(o=>{n[o]=this.getRpcUrl(o,r)}),n}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Oo(this.rpc.chains):Oo(this.rpc.optionalChains),this.signer=await kx.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await x1(()=>import("./index-77377dc0.js").then(o=>o.i),["assets/index-77377dc0.js","assets/index-3fabf754.js","assets/index-0043f41b.css"]);r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Yn({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:n,rpcMap:o}=t;r&&bn(r)&&(this.rpc.chains=r.map(c=>this.formatChainId(c)),r.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),n&&bn(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(c=>this.formatChainId(c)),n.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(t,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[t])||`${Wx}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const EP=Xc;export{EP as EthereumProvider,Qx as OPTIONAL_EVENTS,Jx as OPTIONAL_METHODS,Uc as REQUIRED_EVENTS,zc as REQUIRED_METHODS,Xc as default};
